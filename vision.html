<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Sulandra Vision · Image & Video Generator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
        rel="stylesheet"
    />
<style>
    :root {
        --bg-root: #020617;
        --bg-surface: #050816;
        --bg-surface-soft: #050814;
        --bg-deep: #00010a;

        --accent-green: #3bff64;
        --accent-green-soft: rgba(59, 255, 100, 0.12);

        --border-subtle: #050b18;
        --text-primary: #f9fafb;
        --text-secondary: #9ca3af;
        --text-muted: #6b7280;

        --nav-width: 76px;
        --topbar-height: 64px;
        --radius-card: 20px;
        --radius-md: 14px;
        --radius-pill: 999px;
        --shadow-soft: 0 18px 40px rgba(0, 0, 0, 0.85);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-font-smoothing: antialiased;
    }

    body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Inter",
            "Segoe UI", sans-serif;
        background: #000;
        color: var(--text-primary);
        min-height: 100vh;
        display: flex;
    }

    /* ===================== LEFT NAV – CLEANER ===================== */

    .nav-rail {
        width: var(--nav-width);
        background: radial-gradient(circle at 0 0, #020617, #020817 40%, #000 100%);
        border-right: 1px solid #020617;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 14px 10px 16px;
        gap: 10px;
        position: fixed;
        inset-block: 0;
        z-index: 40;
    }

    .nav-logo {
        width: 44px;
        height: 44px;
        border-radius: 18px;
        background: radial-gradient(circle at 0 0, #22c55e, #020617 70%);
        border: 1px solid rgba(148, 163, 184, 0.9);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        letter-spacing: 0.14em;
        font-size: 20px;
        color: #ecfdf5;
        box-shadow: 0 0 26px rgba(34, 197, 94, 0.9);
    }

    .nav-section {
        margin-top: 10px;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .nav-btn {
        width: 46px;
        height: 46px;
        border-radius: 18px;
        border: 1px solid transparent;
        background: radial-gradient(circle at 0 0, #020617, #000814 70%);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: 0.16s ease-out;
    }

    .nav-btn svg {
        width: 20px;
        height: 20px;
        stroke: #9ca3af;
        stroke-width: 1.5;
        fill: none;
    }

    .nav-btn:hover {
        border-color: #1f2937;
        transform: translateY(-1px);
    }

    .nav-btn.active {
        border-color: rgba(59, 255, 100, 0.9);
        background: radial-gradient(circle at 0 0, #020617, #020617 65%);
        box-shadow: 0 0 22px rgba(34, 197, 94, 0.7);
    }

    .nav-bottom {
        margin-top: auto;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
        font-size: 10px;
        color: var(--text-secondary);
    }

    .nav-sale-pill {
        font-size: 10px;
        color: #022c22;
        background: #22c55e;
        border-radius: 7px;
        padding: 3px 7px;
        font-weight: 700;
    }

    /* ===================== APP SHELL ===================== */

    .app-shell {
        margin-left: var(--nav-width);
        flex: 1;
        min-height: 100vh;
        background: radial-gradient(circle at top, #020617, #000 80%);
        display: flex;
        flex-direction: column;
    }

    .topbar {
        height: var(--topbar-height);
        padding: 0 24px 0 26px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: linear-gradient(to right, #020617, #000814);
        border-bottom: 1px solid #020617;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
        position: sticky;
        top: 0;
        z-index: 20;
    }

    .topbar-left {
        display: flex;
        align-items: center;
        gap: 16px;
    }

    .topbar-title {
        display: flex;
        flex-direction: column;
        gap: 3px;
    }

    .topbar-title-main {
        font-size: 15px;
        font-weight: 600;
    }

    .topbar-title-sub {
        font-size: 11px;
        color: var(--text-muted);
    }

    .model-selector {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        border-radius: var(--radius-pill);
        border: 1px solid #0b1120;
        background: #020617;
        padding: 5px 10px;
        font-size: 11px;
        color: var(--text-secondary);
    }

    .model-selector select {
        border: none;
        outline: none;
        background: transparent;
        color: var(--text-primary);
        font-size: 11px;
    }

    .topbar-right {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .credits-pill {
        border-radius: var(--radius-pill);
        border: 1px solid #0b1120;
        background: #020617;
        padding: 6px 12px;
        font-size: 11px;
        display: inline-flex;
        align-items: center;
        gap: 6px;
    }

    .credits-pill .value {
        color: #a7f3d0;
        font-weight: 600;
    }

    .user-chip {
        border-radius: var(--radius-pill);
        border: 1px solid #0b1120;
        background: #020617;
        padding: 5px 12px;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-size: 11px;
        color: var(--text-secondary);
    }

    .user-avatar {
        width: 22px;
        height: 22px;
        border-radius: 999px;
        background: radial-gradient(circle at 0 0, #22c55e, #020617 70%);
    }

    /* ===================== MAIN GRID ===================== */

    .main-layout {
        height: calc(100vh - var(--topbar-height));
        display: grid;
        grid-template-columns: minmax(0, 430px) minmax(0, 1fr);
        gap: 0;
        padding: 14px 18px 18px;
    }

    .panel {
        display: flex;
        flex-direction: column;
        min-width: 0;
    }

    .panel-right {
        display: grid;
        grid-template-columns: minmax(0, 1fr) 94px;
        gap: 10px;
        min-width: 0;
    }

    /* ===================== GENERATOR CARD ===================== */

    .gen-header {
        padding: 16px 18px 10px;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .gen-title-block {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }

    .gen-title-label {
        font-size: 11px;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.14em;
    }

    .gen-title-main {
        font-size: 13px;
        font-weight: 500;
    }

    .mode-toggle {
        display: inline-flex;
        border-radius: var(--radius-pill);
        border: 1px solid #0b1120;
        background: #020617;
        padding: 2px;
    }

    .mode-toggle button {
        border: none;
        background: transparent;
        font-size: 11px;
        color: var(--text-secondary);
        padding: 4px 10px;
        border-radius: var(--radius-pill);
        cursor: pointer;
    }

    .mode-toggle button.active {
        background: #0b1120;
        color: #f9fafb;
    }

    .gen-body {
        flex: 1;
        background: radial-gradient(circle at top left, #050816, #020617 60%);
        border-radius: var(--radius-card);
        border: 1px solid #050b18;
        padding: 16px 18px 14px;
        margin: 0 14px;
        box-shadow: var(--shadow-soft);
        overflow-y: auto;
    }

    .group-label {
        font-size: 11px;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.16em;
        margin-bottom: 10px;
    }

    .input-block {
        margin-bottom: 14px;
    }

    .input-row-label {
        display: flex;
        align-items: baseline;
        justify-content: space-between;
        margin-bottom: 4px;
    }

    .input-label {
        font-size: 12px;
        color: var(--text-secondary);
    }

    .input-hint {
        font-size: 10px;
        color: var(--text-muted);
    }

    textarea,
    input[type="text"],
    input[type="number"],
    select {
        width: 100%;
        border-radius: 12px;
        border: 1px solid #050b18;
        background: #030712;
        color: var(--text-primary);
        font-size: 12px;
        padding: 9px 10px;
        outline: none;
    }

    textarea {
        resize: vertical;
        min-height: 130px;
    }

    .prompt-area {
        border-radius: 16px;
        border: 1px solid #050b18;
        background: #020617;
        padding: 10px 10px 8px;
    }

    .prompt-area textarea {
        border: none;
        background: transparent;
        min-height: 150px;
    }

    .prompt-footer {
        margin-top: 4px;
        font-size: 11px;
        color: var(--text-muted);
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .prompt-helper-link {
        color: #a7f3d0;
        cursor: pointer;
    }

    .prompt-helper-link:hover {
        text-decoration: underline;
    }

    .dual-row {
        display: flex;
        gap: 10px;
    }

    .dual-row > * {
        flex: 1;
    }

    .upload-card {
        position: relative;
        border-radius: 16px;
        border: 1px dashed #1f2937;
        background: #020617;
        padding: 18px 12px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 6px;
        cursor: pointer;
    }

    .upload-icon {
        width: 28px;
        height: 28px;
        border-radius: 999px;
        border: 1px solid #111827;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        color: var(--text-secondary);
    }

    .upload-card input[type="file"] {
        position: absolute;
        inset: 0;
        opacity: 0;
        cursor: pointer;
    }

    .upload-sub {
        font-size: 11px;
        color: var(--text-muted);
    }

    .link-small {
        font-size: 11px;
        color: #a7f3d0;
        cursor: pointer;
    }

    .chip-row,
    .hints-row {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        margin-top: 6px;
    }

    .chip {
        border-radius: var(--radius-pill);
        border: 1px solid #111827;
        background: #020617;
        font-size: 10px;
        color: var(--text-secondary);
        padding: 4px 9px;
        cursor: pointer;
    }

    .chip.active {
        background: var(--accent-green-soft);
        border-color: var(--accent-green);
        color: #ecfdf5;
    }

    /* bottom strip */

    .gen-footer-controls {
        padding: 10px 22px 4px;
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 11px;
    }

    .gen-footer-controls select {
        width: auto;
        min-width: 80px;
        border-radius: 999px;
        border: 1px solid #111827;
        background: #020617;
        padding: 5px 10px;
        font-size: 11px;
        color: var(--text-secondary);
    }

    .btn-generate {
        margin-left: auto;
        border-radius: 999px;
        border: none;
        padding: 8px 22px;
        font-size: 12px;
        font-weight: 600;
        cursor: pointer;
        background: linear-gradient(to right, #22c55e, #4ade80);
        color: #022c22;
        box-shadow: 0 0 26px rgba(34, 197, 94, 0.8);
    }

    .btn-generate:disabled {
        opacity: 0.55;
        box-shadow: none;
        cursor: default;
    }

    /* ===================== RIGHT SIDE ===================== */

    .preview-wrapper {
        border-radius: var(--radius-card);
        border: 1px solid #050b18;
        background: radial-gradient(circle at top, #050816, #020617 60%);
        padding: 12px 14px 10px;
        box-shadow: var(--shadow-soft);
        display: flex;
        flex-direction: column;
        min-width: 0;
    }

    .preview-topbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 11px;
        margin-bottom: 8px;
    }

    .preview-filters {
        display: inline-flex;
        border-radius: 999px;
        border: 1px solid #0b1120;
        background: #020617;
        padding: 2px;
    }

    .preview-filters button {
        border: none;
        background: transparent;
        font-size: 11px;
        color: var(--text-secondary);
        padding: 4px 10px;
        border-radius: 999px;
        cursor: pointer;
    }

    .preview-filters button.active {
        background: #0b1120;
        color: #f9fafb;
    }

    .btn-assets {
        border-radius: var(--radius-pill);
        border: 1px solid #0b1120;
        background: #020617;
        padding: 6px 12px;
        font-size: 11px;
        color: var(--text-secondary);
        display: inline-flex;
        align-items: center;
        gap: 6px;
        cursor: pointer;
    }

    .search-input {
        border-radius: 999px;
        border: 1px solid #0b1120;
        background: #020617;
        color: var(--text-secondary);
        font-size: 11px;
        padding: 6px 10px;
        min-width: 140px;
        outline: none;
    }

    .preview-main {
        flex: 1;
        display: grid;
        grid-template-rows: minmax(0, 1.35fr) minmax(0, 1fr);
        gap: 10px;
        min-height: 0;
    }

    .preview-stage {
        border-radius: 18px;
        border: 1px solid #050b18;
        background: radial-gradient(circle at top, #020617, #000814 80%);
        padding: 14px 16px;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 0;
    }

    .preview-stage-inner {
        width: 100%;
        max-width: 820px;
        height: 100%;
        border-radius: 18px;
        background: #000;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .preview-placeholder {
        font-size: 12px;
        color: var(--text-muted);
        padding: 18px;
        text-align: center;
    }

    .preview-media {
        width: 100%;
        height: 100%;
        display: none;
        object-fit: contain;
        background: #000;
    }

    .preview-controls-row {
        position: absolute;
        left: 22px;
        bottom: 14px;
        font-size: 11px;
        color: var(--text-secondary);
        display: flex;
        gap: 10px;
    }

    .preview-feed {
        border-radius: 16px;
        border: 1px solid #050b18;
        background: #020617;
        padding: 10px 10px 8px;
        overflow-y: auto;
    }

    .feed-row-title {
        font-size: 11px;
        color: var(--text-secondary);
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 6px;
    }

    .feed-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 9px;
    }

    .feed-card {
        border-radius: 14px;
        border: 1px solid #050b18;
        background: #020617;
        overflow: hidden;
        cursor: pointer;
        display: flex;
        flex-direction: column;
    }

    .feed-thumb {
        aspect-ratio: 4 / 3;
        background: #000;
    }

    .feed-thumb img,
    .feed-thumb video {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .feed-meta {
        padding: 5px 7px 6px;
        font-size: 10px;
        color: var(--text-secondary);
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .feed-name {
        max-width: 110px;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
    }

    .feed-heart {
        display: inline-flex;
        align-items: center;
        gap: 2px;
    }

    /* right-most thumbnail rail */

    .thumb-rail {
        border-radius: 18px;
        border: 1px solid #050b18;
        background: #000;
        padding: 10px 6px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        overflow-y: auto;
    }

    .thumb-item {
        border-radius: 12px;
        border: 1px solid #050b18;
        overflow: hidden;
        height: 68px;
        cursor: pointer;
    }

    .thumb-item img,
    .thumb-item video {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .thumb-item.active {
        border-color: var(--accent-green);
        box-shadow: 0 0 14px rgba(34, 197, 94, 0.9);
    }

    /* ===================== LIGHTBOX ===================== */

    .lightbox-backdrop {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.86);
        display: none;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(18px);
        z-index: 60;
    }

    .lightbox-backdrop.active {
        display: flex;
    }

    .lightbox {
        width: min(960px, 94vw);
        max-height: 90vh;
        border-radius: 26px;
        border: 1px solid #111827;
        background: #020617;
        box-shadow: 0 40px 80px rgba(0, 0, 0, 0.96);
        display: grid;
        grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr);
        overflow: hidden;
    }

    .lightbox-media {
        background: #000;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 18px;
    }

    .lightbox-media img,
    .lightbox-media video {
        width: 100%;
        max-height: 86vh;
        object-fit: contain;
    }

    .lightbox-info {
        padding: 14px 14px 12px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        font-size: 11px;
    }

    .lightbox-header-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
    }

    .lightbox-title {
        font-size: 13px;
        font-weight: 500;
    }

    .lightbox-sub {
        font-size: 11px;
        color: var(--text-muted);
    }

    .btn-close {
        width: 26px;
        height: 26px;
        border-radius: 999px;
        border: 1px solid #111827;
        background: #020617;
        color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
    }

    .lightbox-meta {
        display: grid;
        gap: 2px;
        font-size: 11px;
        color: var(--text-secondary);
    }

    .lightbox-meta span.label {
        color: var(--text-muted);
    }

    .lightbox-actions {
        margin-top: 6px;
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
    }

    .lightbox-actions button {
        border-radius: 999px;
        border: 1px solid #111827;
        background: #020617;
        padding: 4px 10px;
        font-size: 11px;
        color: var(--text-secondary);
        cursor: pointer;
    }

    .lightbox-actions button.danger {
        border-color: #ef4444;
        color: #fecaca;
    }

    .lightbox-prompt {
        margin-top: 6px;
        border-radius: 12px;
        border: 1px solid #050b18;
        background: #020617;
        padding: 8px 9px;
        max-height: 120px;
        overflow-y: auto;
        font-size: 11px;
        color: var(--text-secondary);
    }

    /* ===================== RESPONSIVE ===================== */

    @media (max-width: 1180px) {
        .main-layout {
            grid-template-columns: minmax(0, 410px) minmax(0, 1fr);
        }
    }

    @media (max-width: 1040px) {
        .main-layout {
            grid-template-columns: minmax(0, 1fr);
        }

        .panel-right {
            grid-template-columns: minmax(0, 1fr);
        }

        .thumb-rail {
            display: none;
        }
    }

    @media (max-width: 820px) {
        .nav-rail {
            display: none;
        }

        .app-shell {
            margin-left: 0;
        }
    }

    @media (max-width: 760px) {
        .topbar {
            padding: 0 14px;
        }

        .gen-body {
            margin: 0 6px;
        }

        .lightbox {
            grid-template-columns: minmax(0, 1fr);
        }
    }
<style>
:root {
    /* Core surface / background */
    --bg-body:          #020617;  /* page */
    --bg-shell:         #020617;  /* app shell */
    --bg-elevated:      #020617;  /* big panels */
    --bg-card:          #020617;  /* cards blend into canvas */
    --bg-card-soft:     #030712;
    --bg-subtle:        #020617;

    /* Lines & outlines (very subtle) */
    --border-subtle:    rgba(148, 163, 184, 0.16);
    --border-strong:    rgba(148, 163, 184, 0.32);

    /* Text */
    --text-primary:     #e5e7eb;
    --text-secondary:   #9ca3af;
    --text-muted:       #6b7280;
    --text-on-accent:   #0b1120;
    --text-placeholder: #6b7280;

    /* Accents (Kling-like, neon green CTA) */
    --accent:           #22c55e;
    --accent-soft:      rgba(34, 197, 94, 0.14);
    --accent-strong:    #16a34a;

    /* Pills & chips */
    --pill-bg:          rgba(15, 23, 42, 0.95);
    --pill-active-bg:   #020617;

    /* Radius */
    --radius-xs:        4px;
    --radius-sm:        6px;
    --radius-md:        10px;
    --radius-lg:        16px;
    --radius-xl:        20px;

    /* Shadows */
    --shadow-soft:      0 18px 45px rgba(15, 23, 42, 0.7);
    --shadow-pill:      0 0 0 1px rgba(148, 163, 184, 0.18);
    --shadow-cta:       0 0 0 1px rgba(34,197,94,0.25), 0 18px 45px rgba(22,163,74,0.45);
}

/* Global body + base font */
html, body {
    background: radial-gradient(circle at top, #020617 0, #020617 36%, #020617 100%);
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Inter", sans-serif;
    color: var(--text-primary);
}

/* Main app shell wrapper (body children) */
body {
    margin: 0;
    padding: 0;
    display: flex;
    min-height: 100vh;
    background-color: var(--bg-body);
}

/* ========================================================================== */
/* LEFT NAV RAIL – minimalist Kling-style                                    */
/* ========================================================================== */

.nav-rail {
    width: 68px;
    background: radial-gradient(circle at top left, #020617 0, #020617 45%, #020617 100%);
    border-right: 1px solid rgba(15, 23, 42, 0.8);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 14px 0 18px;
    gap: 8px;
    box-shadow: inset -1px 0 0 rgba(15, 23, 42, 0.85);
}

.brand-logo {
    width: 40px;
    height: 40px;
    border-radius: 999px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: radial-gradient(circle at 30% 0%, #22c55e 0, #16a34a 38%, #22c55e 100%);
    color: #020617;
    font-weight: 700;
    font-size: 20px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    margin-bottom: 20px;
    box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.75), 0 10px 30px rgba(34, 197, 94, 0.55);
}

.nav-section {
    display: flex;
    flex-direction: column;
    gap: 6px;
    width: 100%;
}

.nav-btn {
    width: 44px;
    height: 44px;
    border-radius: 999px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-inline: auto;
    cursor: pointer;
    background: transparent;
    border: none;
    position: relative;
    transition:
        background 140ms ease,
        transform 120ms ease,
        box-shadow 140ms ease,
        color 140ms ease;
}

.nav-btn svg {
    width: 20px;
    height: 20px;
    stroke: #9ca3af;
    fill: none;
}

/* Hover: soft halo */
.nav-btn:hover {
    background: rgba(15, 23, 42, 0.8);
    box-shadow: 0 0 0 1px rgba(55, 65, 81, 0.6);
}

/* Active tab: solid pill + neon edge */
.nav-btn.active {
    background: radial-gradient(circle at 30% 0%, #22c55e 0, #16a34a 45%, #16a34a 100%);
    box-shadow: var(--shadow-cta);
    transform: translateY(-1px);
}

.nav-btn.active svg {
    stroke: #020617;
}

/* Bottom nav buttons (settings, etc.) */
.nav-rail .nav-btn:last-child {
    margin-top: auto;
}

/* ========================================================================== */
/* MAIN LAYOUT GRID – sidebar (controls) + preview                           */
/* ========================================================================== */

.sidebar {
    flex: 0 0 440px;
    max-width: 480px;
    display: flex;
    flex-direction: column;
    padding: 18px 18px 18px 20px;
    background: radial-gradient(circle at top, #020617 0, #020617 32%, #020617 100%);
    border-right: 1px solid rgba(15, 23, 42, 0.85);
}

.sidebar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
}

.sidebar-title {
    font-size: 11px;
    letter-spacing: 0.26em;
    text-transform: uppercase;
    color: #9ca3af;
}

.sidebar-status {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 11px;
    color: var(--text-secondary);
}

.sidebar-status span:first-child {
    width: 8px;
    height: 8px;
    border-radius: 999px;
    background: #22c55e;
    box-shadow: 0 0 0 6px rgba(34, 197, 94, 0.16);
}

.sidebar-scroll {
    flex: 1;
    border-radius: 22px;
    background: radial-gradient(circle at top left, #020617 0, #020617 36%, #020617 100%);
    border: 1px solid rgba(15, 23, 42, 0.9);
    padding: 16px 16px 18px;
    overflow-y: auto;
    box-shadow: var(--shadow-soft);
}

/* Slim scrollbars */
.sidebar-scroll::-webkit-scrollbar {
    width: 8px;
}
.sidebar-scroll::-webkit-scrollbar-track {
    background: transparent;
}
.sidebar-scroll::-webkit-scrollbar-thumb {
    background: rgba(30, 64, 175, 0.55);
    border-radius: 999px;
}

/* ========================================================================== */
/* LAB MODE SWITCH (Create / My Files, Image / Video / Film)                 */
/* ========================================================================== */

.lab-mode-switch {
    display: flex;
    padding: 4px;
    border-radius: 999px;
    background: rgba(15, 23, 42, 0.95);
    border: 1px solid rgba(31, 41, 55, 0.9);
    margin-bottom: 14px;
    gap: 3px;
    box-shadow: var(--shadow-pill);
}

.lab-mode {
    flex: 1;
    border-radius: 999px;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    padding: 6px 0;
    text-align: center;
    color: var(--text-secondary);
    cursor: pointer;
    transition:
        background 120ms ease,
        color 120ms ease,
        transform 120ms ease,
        box-shadow 120ms ease;
}

.lab-mode:hover {
    color: #e5e7eb;
}

.lab-mode.active {
    background: radial-gradient(circle at 30% 0%, #22c55e 0, #16a34a 50%, #16a34a 100%);
    color: #020617;
    box-shadow: var(--shadow-cta);
    transform: translateY(-1px);
}

/* ========================================================================== */
/* FORM BLOCKS – input groups, labels, textareas, selects, pills             */
/* ========================================================================== */

.input-group {
    margin-bottom: 14px;
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.label {
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 11px;
    letter-spacing: 0.16em;
    text-transform: uppercase;
    color: var(--text-secondary);
}

.label span:nth-child(2) {
    font-size: 10px;
    letter-spacing: 0.12em;
    opacity: 0.65;
}

/* Textarea / prompt field */
.text-area {
    width: 100%;
    min-height: 110px;
    border-radius: 16px;
    border: 1px solid rgba(31, 41, 55, 0.9);
    background: radial-gradient(circle at top left, #020617 0, #020617 40%, #020617 100%);
    color: var(--text-primary);
    font-size: 13px;
    padding: 12px 14px;
    resize: vertical;
    outline: none;
    box-shadow: var(--shadow-soft);
}

.text-area::placeholder {
    color: var(--text-placeholder);
}

/* Upload dropzones */
.upload-dropzone {
    border-radius: 16px;
    border: 1px dashed rgba(75, 85, 99, 0.85);
    background: radial-gradient(circle at top left, #020617 0, #020617 35%, #020617 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 18px 14px;
    gap: 8px;
    color: var(--text-secondary);
    cursor: pointer;
    transition:
        border-color 120ms ease,
        background 120ms ease,
        transform 120ms ease,
        box-shadow 120ms ease;
}

.upload-dropzone svg {
    width: 22px;
    height: 22px;
    stroke: #9ca3af;
}

.upload-dropzone:hover {
    border-color: #22c55e;
    box-shadow: 0 0 0 1px rgba(34,197,94,0.6), 0 16px 40px rgba(22,163,74,0.35);
    transform: translateY(-1px);
}

/* Generic selects */
select {
    border-radius: 999px;
    border: 1px solid rgba(31, 41, 55, 0.9);
    background: #020617;
    color: var(--text-primary);
    padding: 6px 12px;
    font-size: 12px;
}

/* Aspect ratio pill grid */
.ratio-grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 6px;
}

.ratio-option {
    border-radius: 999px;
    border: 1px solid rgba(31, 41, 55, 0.85);
    padding: 7px 10px;
    font-size: 11px;
    display: flex;
    flex-direction: column;
    gap: 2px;
    color: var(--text-secondary);
    cursor: pointer;
    background: rgba(15, 23, 42, 0.9);
}

.ratio-option span {
    font-size: 10px;
    color: var(--text-muted);
}

.ratio-option.active {
    border-color: #22c55e;
    background: radial-gradient(circle at 30% 0%, #22c55e 0, #16a34a 55%, #16a34a 100%);
    color: #020617;
}

.ratio-option.active span {
    color: #022c22;
}

/* Horizontal rows for small controls */
.inline-row {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

/* ========================================================================== */
/* BUTTON SYSTEM – ghost, subtle, accent (Kling-like)                         */
/* ========================================================================== */

.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    border-radius: 999px;
    border: 1px solid rgba(31, 41, 55, 0.9);
    padding: 8px 14px;
    font-size: 11px;
    letter-spacing: 0.16em;
    text-transform: uppercase;
    background: rgba(15, 23, 42, 0.95);
    color: var(--text-secondary);
    cursor: pointer;
    transition:
        background 120ms ease,
        border-color 120ms ease,
        box-shadow 120ms ease,
        transform 120ms ease,
        color 120ms ease;
}

.btn svg {
    width: 14px;
    height: 14px;
    stroke: currentColor;
    fill: none;
}

/* Primary action – bright green “Generate” */
.btn-accent {
    background: radial-gradient(circle at 30% 0%, #22c55e 0, #16a34a 55%, #16a34a 100%);
    border-color: #22c55e;
    color: #020617;
    box-shadow: var(--shadow-cta);
}

.btn-accent:hover {
    background: radial-gradient(circle at 30% 0%, #4ade80 0, #22c55e 45%, #16a34a 100%);
    transform: translateY(-1px);
}

/* Ghost / secondary buttons */
.btn-ghost {
    background: transparent;
    border-color: rgba(31, 41, 55, 0.95);
    color: var(--text-secondary);
}

.btn-ghost:hover {
    background: rgba(15, 23, 42, 0.95);
    color: #e5e7eb;
}

/* Ask SIA pill */
.btn-ask-sia {
    border-radius: 999px;
    border-color: rgba(55, 65, 81, 0.95);
    background: radial-gradient(circle at 0% 0%, #0b1120 0, #020617 45%, #020617 100%);
    color: #d1fae5;
    padding-inline: 10px;
}

.btn-ask-sia:hover {
    box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.6);
}

/* ========================================================================== */
/* MAIN PREVIEW SIDE – gallery and canvas                                    */
/* ========================================================================== */

.lab-main-grid {
    flex: 1;
    display: grid;
    grid-template-columns: minmax(0, 1.35fr) minmax(0, 1.25fr);
    gap: 18px;
    padding: 18px 22px 18px 16px;
    background: radial-gradient(circle at top right, #020617 0, #020617 40%, #020617 100%);
}

/* Right preview panel wrapper */
.preview-panel {
    border-radius: 24px;
    background: radial-gradient(circle at top, #020617 0, #020617 40%, #020617 100%);
    border: 1px solid rgba(15, 23, 42, 0.9);
    display: flex;
    flex-direction: column;
    box-shadow: var(--shadow-soft);
}

/* Tabs above gallery (All / Images / Videos / Favorites) */
.preview-tabs {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 14px 8px;
    border-bottom: 1px solid rgba(15, 23, 42, 0.9);
}

.preview-tab-group {
    display: inline-flex;
    gap: 6px;
    padding: 3px;
    border-radius: 999px;
    background: rgba(15, 23, 42, 0.95);
    border: 1px solid rgba(31, 41, 55, 0.9);
}

.preview-tab {
    border-radius: 999px;
    padding: 5px 10px;
    font-size: 11px;
    letter-spacing: 0.13em;
    text-transform: uppercase;
    color: var(--text-secondary);
    cursor: pointer;
}

.preview-tab.active {
    background: #020617;
    color: #e5e7eb;
}

/* Assets button on top right */
.preview-assets-btn {
    border-radius: 999px;
    padding: 6px 10px;
    border: 1px solid rgba(31, 41, 55, 0.9);
    background: rgba(15, 23, 42, 0.96);
    font-size: 11px;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    color: var(--text-secondary);
}

/* Canvas area */
.preview-stage {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 16px;
}

/* When a single image/video is shown */
.preview-frame {
    border-radius: 20px;
    background: #000;
    display: flex;
    align-items: center;
    justify-content: center;
    max-height: 480px;
    overflow: hidden;
}

/* Thumbnails / history list on the right side of the canvas */
.preview-strip {
    width: 96px;
    display: flex;
    flex-direction: column;
    gap: 6px;
    padding: 10px 10px 10px 0;
}

.preview-thumb {
    position: relative;
    border-radius: 12px;
    overflow: hidden;
    cursor: pointer;
    border: 1px solid rgba(31, 41, 55, 0.9);
    background: #020617;
}

.preview-thumb img,
.preview-thumb video {
    width: 100%;
    display: block;
}

/* ========================================================================== */
/* “My Files” grid thumbnails                                                 */
/* ========================================================================== */

.assets-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(160px,1fr));
    gap: 12px;
}

.asset-card {
    position: relative;
    border-radius: 18px;
    overflow: hidden;
    background: #020617;
    border: 1px solid rgba(31, 41, 55, 0.9);
    cursor: pointer;
    display: flex;
    flex-direction: column;
    min-height: 150px;
}

.asset-card-thumb {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #000;
}

.asset-card-thumb img,
.asset-card-thumb video {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.asset-card-meta {
    padding: 8px 10px 9px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 11px;
    color: var(--text-secondary);
}

/* Favorite heart on cards */
.card-fav-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    border-radius: 999px;
    width: 26px;
    height: 26px;
    border: none;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    background: rgba(15, 23, 42, 0.85);
}

.card-fav-btn svg {
    width: 15px;
    height: 15px;
}

.card-fav-btn.is-active {
    background: radial-gradient(circle at 30% 0%, #fb7185 0, #f97373 40%, #fb7185 100%);
}

/* ========================================================================== */
/* Ask SIA drawer – cleaner chat bubble look                                 */
/* ========================================================================== */

.sia-panel {
    border-radius: 22px;
    border: 1px solid rgba(15, 23, 42, 0.9);
    background: radial-gradient(circle at top left, #020617 0, #020617 40%, #020617 100%);
    box-shadow: var(--shadow-soft);
}

.sia-messages {
    padding: 10px 12px;
    max-height: 220px;
    overflow-y: auto;
}

.sia-bubble {
    max-width: 82%;
    padding: 7px 10px;
    border-radius: 14px;
    font-size: 12px;
    line-height: 1.55;
}

.sia-bubble.sia {
    background: rgba(15, 23, 42, 0.98);
    border: 1px solid rgba(31, 41, 55, 0.95);
    color: var(--text-secondary);
}

.sia-bubble.user {
    background: radial-gradient(circle at 30% 0%, #22c55e 0, #16a34a 52%, #16a34a 100%);
    color: #020617;
}

/* ========================================================================== */
/* RESPONSIVE TWEAKS                                                         */
/* ========================================================================== */

@media (max-width: 1200px) {
    .lab-main-grid {
        grid-template-columns: minmax(0, 1.1fr) minmax(0, 1fr);
    }
    .sidebar {
        flex-basis: 400px;
    }
}

@media (max-width: 1024px) {
    body {
        flex-direction: column;
    }
    .nav-rail {
        flex-direction: row;
        width: 100%;
        height: 64px;
        padding-inline: 14px;
        justify-content: space-between;
        border-right: none;
        border-bottom: 1px solid rgba(15, 23, 42, 0.9);
    }
    .sidebar {
        flex-basis: auto;
        max-width: none;
        border-right: none;
        border-bottom: 1px solid rgba(15, 23, 42, 0.9);
    }
    .lab-main-grid {
        grid-template-columns: minmax(0,1fr);
        padding: 16px;
    }
}
</style>
</head>
<body>
    <!-- LEFT NAV -->
    <aside class="nav-rail">
        <div class="nav-logo">S</div>

        <div class="nav-section">
            <button class="nav-btn active" title="Explore">
                <svg viewBox="0 0 24 24">
                    <path d="M4 11.5 12 4l8 7.5-3 8H7l-3-8Z" />
                    <circle cx="12" cy="12" r="2.2" />
                </svg>
            </button>
            <button class="nav-btn" title="Assets">
                <svg viewBox="0 0 24 24">
                    <rect x="4" y="4" width="16" height="16" rx="3" />
                    <path d="M4 10h16M10 4v16" />
                </svg>
            </button>
            <button class="nav-btn" title="Image Lab">
                <svg viewBox="0 0 24 24">
                    <rect x="4" y="4" width="16" height="16" rx="3" />
                    <path d="m7 16 3-4 3 3 2-3 3 4" />
                </svg>
            </button>
            <button class="nav-btn" title="Video Lab">
                <svg viewBox="0 0 24 24">
                    <rect x="4" y="4" width="16" height="16" rx="2" />
                    <path d="M10 8v8l6-4-6-4Z" />
                </svg>
            </button>
            <button class="nav-btn" title="All Tools">
                <svg viewBox="0 0 24 24">
                    <path
                        d="M4 8h6V4H4v4Zm10 0h6V4h-6v4ZM4 20h6v-6H4v6Zm10 0h6v-6h-6v6Z"
                    />
                </svg>
            </button>
        </div>

        <div class="nav-bottom">
            <div class="nav-plan">Standard</div>
            <div class="nav-sale-pill">SALE · 50% off</div>
        </div>
    </aside>

    <!-- APP SHELL -->
    <div class="app-shell">
        <!-- TOP BAR -->
        <header class="topbar">
            <div class="topbar-left">
                <div class="topbar-title">
                    <div class="topbar-title-main" id="lab-title">
                        AI Image Generator
                    </div>
                    <div class="topbar-title-sub">
                        Text to Image · Image Reference · Restyle
                    </div>
                </div>
                <div class="model-selector">
                    <span>Model</span>
                    <select id="model-select">
                        <option>IMAGE 2.1</option>
                        <option>IMAGE 2.0</option>
                        <option>IMAGE 1.5</option>
                    </select>
                </div>
            </div>

            <div class="topbar-right">
                <div class="credits-pill">
                    Credits
                    <span class="value" id="credits-value">691</span>
                    <span>/ day</span>
                </div>
                <div class="user-chip">
                    <div class="user-avatar"></div>
                    <div class="user-name">Signed in</div>
                </div>
            </div>
        </header>

        <!-- MAIN LAYOUT -->
        <main class="main-layout">
            <!-- LEFT SETTINGS PANEL -->
            <section class="panel">
                <div class="gen-header">
                    <div class="gen-title-block">
                        <div class="gen-title-label">Mode</div>
                        <div class="gen-title-main" id="mode-title">
                            Text to Image
                        </div>
                    </div>

                    <div class="mode-toggle" id="mode-tabs-image">
                        <button
                            type="button"
                            class="active"
                            data-imagemode="text"
                            onclick="setImageMode('text')"
                        >
                            Text to Image
                        </button>
                        <button
                            type="button"
                            data-imagemode="ref"
                            onclick="setImageMode('ref')"
                        >
                            Image Reference
                        </button>
                        <button
                            type="button"
                            data-imagemode="restyle"
                            onclick="setImageMode('restyle')"
                        >
                            Restyle
                        </button>
                    </div>

                    <div
                        class="mode-toggle"
                        id="mode-tabs-video"
                        style="display: none"
                    >
                        <button
                            type="button"
                            class="active"
                            data-videomode="text"
                            onclick="setVideoMode('text')"
                        >
                            Text to Video
                        </button>
                        <button
                            type="button"
                            data-videomode="img2vid"
                            onclick="setVideoMode('img2vid')"
                        >
                            Image to Video
                        </button>
                        <button
                            type="button"
                            data-videomode="elements"
                            onclick="setVideoMode('elements')"
                        >
                            Elements
                        </button>
                        <button
                            type="button"
                            data-videomode="multi"
                            onclick="setVideoMode('multi')"
                        >
                            Multi-Elements
                        </button>
                    </div>
                </div>

                <div class="gen-body" id="gen-body">
                    <!-- Image: Text to Image (default) -->
                    <div id="block-image-text">
                        <div class="group-label">Prompt</div>
                        <div class="input-block">
                            <div class="prompt-area">
                                <textarea
                                    id="prompt"
                                    placeholder="Please describe your creative idea for the image..."
                                ></textarea>
                                <div class="prompt-footer">
                                    <span>
                                        Tip: describe subject, lighting, camera,
                                        environment.
                                    </span>
                                    <span
                                        class="prompt-helper-link"
                                        onclick="askSiaForPrompt()"
                                        >Let SIA write the prompt</span
                                    >
                                </div>
                            </div>
                        </div>

                        <div class="input-block">
                            <div class="input-row-label">
                                <span class="input-label">Negative prompt</span>
                                <span class="input-hint"
                                    >Optional · things to avoid</span
                                >
                            </div>
                            <textarea
                                id="negative"
                                placeholder="blurry, low quality, watermark, distorted hands…"
                            ></textarea>
                            <div class="hints-row">
                                <button
                                    type="button"
                                    class="chip"
                                    onclick="appendNegative('blurry')"
                                >
                                    blurry
                                </button>
                                <button
                                    type="button"
                                    class="chip"
                                    onclick="appendNegative('extra limbs')"
                                >
                                    extra limbs
                                </button>
                                <button
                                    type="button"
                                    class="chip"
                                    onclick="appendNegative('low resolution')"
                                >
                                    low resolution
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Image: Image Reference -->
                    <div id="block-image-ref" style="display: none">
                        <div class="group-label">Image reference</div>
                        <div class="input-block">
                            <div class="dual-row">
                                <div class="upload-card" id="upload-ref-main">
                                    <div class="upload-icon">+</div>
                                    <div>Upload “Subject” reference image</div>
                                    <div class="upload-sub">
                                        JPG / PNG · Select from History
                                    </div>
                                    <input
                                        type="file"
                                        accept="image/*"
                                        onchange="onRefUpload(event, 'subject')"
                                    />
                                </div>
                                <div class="upload-card" id="upload-ref-face">
                                    <div class="upload-icon">+</div>
                                    <div>Upload “Face” reference (optional)</div>
                                    <div class="upload-sub">Close-up face</div>
                                    <input
                                        type="file"
                                        accept="image/*"
                                        onchange="onRefUpload(event, 'face')"
                                    />
                                </div>
                            </div>
                            <div
                                class="link-small"
                                style="margin-top: 6px"
                                onclick="openHistoryFromRef()"
                            >
                                Open History · reuse files from previous runs
                            </div>
                        </div>

                        <div class="input-block">
                            <div class="input-row-label">
                                <span class="input-label">Prompt</span>
                                <span class="input-hint">Required</span>
                            </div>
                            <div class="prompt-area">
                                <textarea
                                    id="prompt-ref"
                                    placeholder="Please describe how to use the reference image (pose, style, environment)…"
                                ></textarea>
                                <div class="prompt-footer">
                                    <span>Explain what should stay the same.</span>
                                    <span
                                        class="prompt-helper-link"
                                        onclick="askSiaForPrompt('ref')"
                                        >Let SIA write the prompt</span
                                    >
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Image: Restyle -->
                    <div id="block-image-restyle" style="display: none">
                        <div class="group-label">Restyle</div>
                        <div class="input-block">
                            <div class="upload-card" id="upload-restyle">
                                <div class="upload-icon">+</div>
                                <div>Add image to restyle</div>
                                <div class="upload-sub">
                                    History · choose any previous image
                                </div>
                                <input
                                    type="file"
                                    accept="image/*"
                                    onchange="onRestyleUpload(event)"
                                />
                            </div>
                        </div>

                        <div class="input-block">
                            <div class="input-row-label">
                                <span class="input-label">Restyle prompt</span>
                                <span class="input-hint">Required</span>
                            </div>
                            <textarea
                                id="prompt-restyle"
                                placeholder="For example: restyle to Japanese anime, cinematic film still, oil painting…"
                            ></textarea>
                        </div>
                    </div>

                    <!-- Video modes share same prompt IDs but different helper text -->
                    <div id="block-video-text" style="display: none">
                        <div class="group-label">Text to Video</div>
                        <div class="input-block">
                            <div class="prompt-area">
                                <textarea
                                    id="prompt-video"
                                    placeholder="Describe the actions, camera motion, and environment for the video…"
                                ></textarea>
                                <div class="prompt-footer">
                                    <span>
                                        Use quotes for dialogue: “character says
                                        hello”.
                                    </span>
                                    <span
                                        class="prompt-helper-link"
                                        onclick="askSiaForPrompt('video')"
                                        >Let SIA write the script</span
                                    >
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="block-video-img2vid" style="display: none">
                        <div class="group-label">Image to Video</div>
                        <div class="input-block">
                            <div class="upload-card" id="upload-start-frame">
                                <div class="upload-icon">+</div>
                                <div>Add a start frame</div>
                                <div class="upload-sub">
                                    MP4 / MOV not needed · image only
                                </div>
                                <input
                                    type="file"
                                    accept="image/*"
                                    onchange="onVideoImgUpload(event)"
                                />
                            </div>
                        </div>
                        <div class="input-block">
                            <div class="input-row-label">
                                <span class="input-label">Prompt</span>
                                <span class="input-hint">Required</span>
                            </div>
                            <textarea
                                id="prompt-video-img"
                                placeholder="Describe how the scene should move from this starting frame…"
                            ></textarea>
                        </div>
                    </div>

                    <div id="block-video-elements" style="display: none">
                        <div class="group-label">Elements</div>
                        <div class="input-block">
                            <div class="upload-card">
                                <div class="upload-icon">+</div>
                                <div>Add 1-4 images as elements</div>
                                <div class="upload-sub">
                                    Supports JPG / PNG · or select from History
                                </div>
                                <input
                                    type="file"
                                    accept="image/*"
                                    multiple
                                    onchange="onVideoElementsUpload(event)"
                                />
                            </div>
                        </div>
                        <div class="input-block">
                            <div class="input-row-label">
                                <span class="input-label">Actions prompt</span>
                            </div>
                            <textarea
                                id="prompt-video-elements"
                                placeholder="Describe actions / interactions between the elements…"
                            ></textarea>
                        </div>
                    </div>

                    <div id="block-video-multi" style="display: none">
                        <div class="group-label">Multi-Elements (edit)</div>
                        <div class="input-block">
                            <div class="dual-row">
                                <div class="upload-card">
                                    <div class="upload-icon">+</div>
                                    <div>Add a video to edit</div>
                                    <div class="upload-sub">
                                        MP4/MOV · 10s max · 720/1080p
                                    </div>
                                    <input
                                        type="file"
                                        accept="video/*"
                                        onchange="onVideoEditUpload(event)"
                                    />
                                </div>
                                <div class="upload-card">
                                    <div class="upload-icon">+</div>
                                    <div>Add an image for elements swap</div>
                                    <div class="upload-sub">
                                        Swap [x] from image into video
                                    </div>
                                    <input
                                        type="file"
                                        accept="image/*"
                                        onchange="onVideoSwapUpload(event)"
                                    />
                                </div>
                            </div>
                        </div>

                        <div class="input-block">
                            <div class="input-row-label">
                                <span class="input-label">Edit prompt</span>
                            </div>
                            <textarea
                                id="prompt-video-multi"
                                placeholder="Explain how to swap or edit elements in the video…"
                            ></textarea>
                        </div>
                    </div>
                </div>

                <!-- bottom controls (aspect, duration, outputs, quality, generate) -->
                <div class="gen-footer-controls">
                    <select id="aspect-select">
                        <option value="9:16">9:16</option>
                        <option value="16:9">16:9</option>
                        <option value="1:1">1:1</option>
                        <option value="4:5">4:5</option>
                    </select>
                    <select id="duration-select">
                        <option value="image">Image</option>
                        <option value="5s">5s</option>
                        <option value="10s" selected>10s</option>
                    </select>
                    <select id="outputs-select">
                        <option value="1">1 Output</option>
                        <option value="2">2 Outputs</option>
                        <option value="3">3 Outputs</option>
                        <option value="4">4 Outputs</option>
                    </select>
                    <select id="quality-select">
                        <option value="standard">Standard</option>
                        <option value="high">High-Res</option>
                        <option value="pro">Professional</option>
                    </select>

                    <button
                        type="button"
                        class="btn-generate"
                        id="generate-btn"
                        onclick="handleGenerate()"
                    >
                        Generate
                    </button>
                </div>
            </section>

            <!-- RIGHT PREVIEW + FEED + THUMB RAIL -->
            <section class="panel-right">
                <div class="preview-wrapper">
                    <div class="preview-topbar">
                        <div class="preview-filters" id="preview-filters">
                            <button
                                type="button"
                                data-filter="all"
                                class="active"
                                onclick="setPreviewFilter('all')"
                            >
                                All
                            </button>
                            <button
                                type="button"
                                data-filter="image"
                                onclick="setPreviewFilter('image')"
                            >
                                Images
                            </button>
                            <button
                                type="button"
                                data-filter="video"
                                onclick="setPreviewFilter('video')"
                            >
                                Videos
                            </button>
                            <button
                                type="button"
                                data-filter="audio"
                                onclick="setPreviewFilter('audio')"
                            >
                                Audio
                            </button>
                            <button
                                type="button"
                                data-filter="fav"
                                onclick="setPreviewFilter('fav')"
                            >
                                Favorites
                            </button>
                        </div>

                        <div style="display: flex; align-items: center; gap: 8px">
                            <input
                                type="text"
                                class="search-input"
                                placeholder="Search history"
                                oninput="setSearchTerm(this.value)"
                            />
                            <button
                                type="button"
                                class="btn-assets"
                                onclick="openAssetsFromTop()"
                            >
                                Assets
                            </button>
                        </div>
                    </div>

                    <div class="preview-main">
                        <div class="preview-stage">
                            <div class="preview-stage-inner">
                                <div
                                    class="preview-placeholder"
                                    id="preview-placeholder"
                                >
                                    Generate or upload an image / video.
                                    <br /><br />
                                    Every output will appear here with full
                                    playback controls and also be saved in
                                    <strong>Assets / History</strong>.
                                </div>
                                <img
                                    id="preview-image"
                                    class="preview-media"
                                    alt="Preview"
                                />
                                <video
                                    id="preview-video"
                                    class="preview-media"
                                    controls
                                ></video>
                            </div>

                            <div class="preview-controls-row" id="preview-info">
                                <span id="preview-kind">Idle</span>
                                <span>·</span>
                                <span id="preview-meta">Ready</span>
                            </div>
                        </div>

                        <div class="preview-feed">
                            <div class="feed-row-title">
                                <span>Recent results</span>
                                <span id="feed-count">0 items</span>
                            </div>
                            <div class="feed-grid" id="feed-grid"></div>
                        </div>
                    </div>
                </div>

                <aside class="thumb-rail" id="thumb-rail"></aside>
            </section>
        </main>
    </div>

    <!-- LIGHTBOX -->
    <div
        class="lightbox-backdrop"
        id="lightbox-backdrop"
        onclick="if(event.target.id==='lightbox-backdrop') closeLightbox();"
    >
        <div class="lightbox" id="lightbox">
            <div class="lightbox-media">
                <img id="lb-image" style="display: none" />
                <video id="lb-video" controls style="display: none"></video>
            </div>
            <div class="lightbox-info">
                <div class="lightbox-header-row">
                    <div>
                        <div class="lightbox-title" id="lb-title"></div>
                        <div class="lightbox-sub" id="lb-sub"></div>
                    </div>
                    <button type="button" class="btn-close" onclick="closeLightbox()">
                        ×
                    </button>
                </div>

                <div class="lightbox-meta">
                    <div>
                        <span class="label">Resolution:</span>
                        <span id="lb-res"></span>
                    </div>
                    <div>
                        <span class="label">Seed:</span>
                        <span id="lb-seed"></span>
                    </div>
                    <div>
                        <span class="label">Created:</span>
                        <span id="lb-created"></span>
                    </div>
                    <div>
                        <span class="label">Source:</span>
                        <span id="lb-source"></span>
                    </div>
                </div>

                <div class="lightbox-actions">
                    <button type="button" onclick="downloadCurrent()">Download</button>
                    <button type="button" onclick="recreateCurrent()">Recreate</button>
                    <button type="button" onclick="sendCurrentToCinema()">
                        Send to Cinema
                    </button>
                    <button type="button" onclick="renameCurrent()">Rename</button>
                    <button
                        type="button"
                        class="danger"
                        onclick="deleteCurrentAsset()"
                    >
                        Delete
                    </button>
                </div>

                <div class="lightbox-prompt" id="lb-prompt"></div>
            </div>
        </div>
    </div>

    <script>
        // ================================================================
        // STATE
        // ================================================================
        const state = {
            lab: "image", // 'image' | 'video'
            imageMode: "text", // 'text' | 'ref' | 'restyle'
            videoMode: "text", // 'text' | 'img2vid' | 'elements' | 'multi'
            assets: [], // all outputs + uploads
            nextId: 1,
            previewFilter: "all",
            searchTerm: "",
            previewId: null,
            lightboxId: null
        };

        // ================================================================
        // MODE SWITCHING
        // ================================================================
        function setLab(lab) {
            state.lab = lab;
        }

        function setImageMode(mode) {
            state.imageMode = mode;
            document.getElementById("mode-title").innerText =
                mode === "text"
                    ? "Text to Image"
                    : mode === "ref"
                    ? "Image Reference"
                    : "Restyle";

            // show blocks
            document.getElementById("block-image-text").style.display =
                mode === "text" ? "block" : "none";
            document.getElementById("block-image-ref").style.display =
                mode === "ref" ? "block" : "none";
            document.getElementById("block-image-restyle").style.display =
                mode === "restyle" ? "block" : "none";

            document.getElementById("block-video-text").style.display = "none";
            document.getElementById("block-video-img2vid").style.display = "none";
            document.getElementById("block-video-elements").style.display = "none";
            document.getElementById("block-video-multi").style.display = "none";

            document
                .querySelectorAll("#mode-tabs-image button")
                .forEach((b) =>
                    b.classList.toggle("active", b.dataset.imagemode === mode)
                );
        }

        function setVideoMode(mode) {
            state.videoMode = mode;
            document.getElementById("mode-title").innerText =
                mode === "text"
                    ? "Text to Video"
                    : mode === "img2vid"
                    ? "Image to Video"
                    : mode === "elements"
                    ? "Elements"
                    : "Multi-Elements";

            document.getElementById("block-image-text").style.display = "none";
            document.getElementById("block-image-ref").style.display = "none";
            document.getElementById("block-image-restyle").style.display = "none";

            document.getElementById("block-video-text").style.display =
                mode === "text" ? "block" : "none";
            document.getElementById("block-video-img2vid").style.display =
                mode === "img2vid" ? "block" : "none";
            document.getElementById("block-video-elements").style.display =
                mode === "elements" ? "block" : "none";
            document.getElementById("block-video-multi").style.display =
                mode === "multi" ? "block" : "none";

            document
                .querySelectorAll("#mode-tabs-video button")
                .forEach((b) =>
                    b.classList.toggle("active", b.dataset.videomode === mode)
                );
        }

        // For now we keep lab fixed to image.
        window.addEventListener("DOMContentLoaded", () => {
            setImageMode("text");
            renderFeed();
        });

        // ================================================================
        // HELPERS
        // ================================================================
        function appendNegative(text) {
            const field = document.getElementById("negative");
            if (!field) return;
            if (!field.value) field.value = text;
            else if (!field.value.includes(text)) field.value += ", " + text;
        }

        function askSiaForPrompt(kind = "image") {
            alert(
                "Hook this to SIA Brain. Scope: " +
                    kind +
                    " · Use current lab / mode to build a smart prompt."
            );
        }

        // ================================================================
        // UPLOAD STUB HANDLERS
        // ================================================================
        function onRefUpload(event, slot) {
            if (!event.target.files?.length) return;
            const file = event.target.files[0];
            const url = URL.createObjectURL(file);
            alert(
                "Loaded reference " +
                    slot +
                    " image: " +
                    (file.name || "file") +
                    " (stored client-side only here)."
            );
        }

        function onRestyleUpload(e) {
            if (!e.target.files?.length) return;
            alert("Restyle image selected: " + e.target.files[0].name);
        }

        function onVideoImgUpload(e) {
            if (!e.target.files?.length) return;
            alert("Start frame selected: " + e.target.files[0].name);
        }

        function onVideoElementsUpload(e) {
            if (!e.target.files?.length) return;
            alert(e.target.files.length + " element image(s) selected.");
        }

        function onVideoEditUpload(e) {
            if (!e.target.files?.length) return;
            alert("Video to edit: " + e.target.files[0].name);
        }

        function onVideoSwapUpload(e) {
            if (!e.target.files?.length) return;
            alert("Swap image: " + e.target.files[0].name);
        }

        function openHistoryFromRef() {
            alert("Open History panel – wire to Assets history view.");
        }

        // ================================================================
        // GENERATE (DEMO ONLY)
        // ================================================================
        function handleGenerate() {
            const lab = state.lab; // currently 'image'
            const isVideo = document.getElementById("duration-select").value !== "image";

            const promptId =
                lab === "image"
                    ? state.imageMode === "text"
                        ? "prompt"
                        : state.imageMode === "ref"
                        ? "prompt-ref"
                        : "prompt-restyle"
                    : "prompt-video";

            const prompt = (document.getElementById(promptId) || {}).value || "";
            if (!prompt.trim()) {
                alert("Please enter a prompt first.");
                return;
            }

            const count = parseInt(
                document.getElementById("outputs-select").value,
                10
            );
            const aspect = document.getElementById("aspect-select").value;
            const quality = document.getElementById("quality-select").value;
            const duration = document.getElementById("duration-select").value;

            const generateBtn = document.getElementById("generate-btn");
            generateBtn.disabled = true;
            document.getElementById("preview-kind").innerText = "Generating…";
            document.getElementById("preview-meta").innerText =
                (isVideo ? "Video" : "Image") +
                " · " +
                count +
                " output(s) · " +
                aspect +
                " · " +
                quality;

            setTimeout(() => {
                for (let i = 0; i < count; i++) {
                    const id = "asset-" + state.nextId++;
                    const kind = isVideo ? "video" : "image";
                    const url =
                        kind === "image"
                            ? "https://placehold.co/800x1200/020617/9ca3af?text=Sulandra+Image"
                            : "https://placehold.co/1280x720/020617/9ca3af?text=Sulandra+Video";

                    state.assets.unshift({
                        id,
                        kind,
                        createdAt: new Date().toLocaleString(),
                        prompt,
                        mode: lab === "image" ? state.imageMode : state.videoMode,
                        aspect,
                        quality,
                        duration,
                        url,
                        seed: Math.floor(Math.random() * 999999),
                        favorite: false,
                        source: "generated"
                    });
                    state.previewId = id;
                }

                generateBtn.disabled = false;
                updatePreviewFromCurrent();
                renderFeed();
            }, 700);
        }

        // ================================================================
        // PREVIEW + FEED
        // ================================================================
        function updatePreviewFromCurrent() {
            const asset = state.assets.find((a) => a.id === state.previewId);
            const placeholder = document.getElementById("preview-placeholder");
            const img = document.getElementById("preview-image");
            const video = document.getElementById("preview-video");

            if (!asset) {
                placeholder.style.display = "block";
                img.style.display = "none";
                video.style.display = "none";
                document.getElementById("preview-kind").innerText = "Idle";
                document.getElementById("preview-meta").innerText = "Ready";
                return;
            }

            placeholder.style.display = "none";

            if (asset.kind === "image") {
                img.src = asset.url;
                img.style.display = "block";
                video.style.display = "none";
            } else {
                video.src = asset.url;
                video.style.display = "block";
                img.style.display = "none";
            }

            document.getElementById("preview-kind").innerText =
                asset.kind === "image" ? "Image" : "Video";
            document.getElementById("preview-meta").innerText =
                asset.aspect +
                " · " +
                (asset.duration === "image" ? "single frame" : asset.duration) +
                " · " +
                (asset.quality || "standard");
            renderThumbRail();
        }

        function setPreviewFilter(filter) {
            state.previewFilter = filter;
            document
                .querySelectorAll("#preview-filters button")
                .forEach((b) =>
                    b.classList.toggle("active", b.dataset.filter === filter)
                );
            renderFeed();
        }

        function setSearchTerm(text) {
            state.searchTerm = text.trim().toLowerCase();
            renderFeed();
        }

        function filteredAssets() {
            return state.assets.filter((a) => {
                if (
                    state.previewFilter === "image" &&
                    a.kind !== "image"
                )
                    return false;
                if (
                    state.previewFilter === "video" &&
                    a.kind !== "video"
                )
                    return false;
                if (state.previewFilter === "fav" && !a.favorite) return false;
                if (state.searchTerm) {
                    const text =
                        (a.prompt || "") +
                        " " +
                        (a.mode || "") +
                        " " +
                        (a.id || "");
                    if (!text.toLowerCase().includes(state.searchTerm)) return false;
                }
                return true;
            });
        }

        function renderFeed() {
            const grid = document.getElementById("feed-grid");
            const assets = filteredAssets();
            grid.innerHTML = "";
            document.getElementById("feed-count").innerText =
                assets.length + " items";

            assets.forEach((asset) => {
                const card = document.createElement("div");
                card.className = "feed-card";
                card.onclick = () => {
                    state.previewId = asset.id;
                    updatePreviewFromCurrent();
                };

                const thumb = document.createElement("div");
                thumb.className = "feed-thumb";
                if (asset.kind === "image") {
                    const img = document.createElement("img");
                    img.src = asset.url;
                    thumb.appendChild(img);
                } else {
                    const video = document.createElement("video");
                    video.src = asset.url;
                    video.muted = true;
                    thumb.appendChild(video);
                }

                const meta = document.createElement("div");
                meta.className = "feed-meta";
                const name = document.createElement("div");
                name.className = "feed-name";
                name.textContent =
                    (asset.kind === "image" ? "Image" : "Video") +
                    " · " +
                    asset.mode.toUpperCase();

                const heart = document.createElement("div");
                heart.className = "feed-heart";
                heart.innerHTML = asset.favorite ? "★ 1" : "☆ 0";
                heart.onclick = (e) => {
                    e.stopPropagation();
                    asset.favorite = !asset.favorite;
                    renderFeed();
                    renderThumbRail();
                };

                meta.appendChild(name);
                meta.appendChild(heart);

                card.appendChild(thumb);
                card.appendChild(meta);

                grid.appendChild(card);
            });

            renderThumbRail();
        }

        function renderThumbRail() {
            const rail = document.getElementById("thumb-rail");
            if (!rail) return;
            rail.innerHTML = "";
            const assets = filteredAssets();

            assets.forEach((asset) => {
                const item = document.createElement("div");
                item.className =
                    "thumb-item" +
                    (asset.id === state.previewId ? " active" : "");
                item.onclick = () => {
                    state.previewId = asset.id;
                    updatePreviewFromCurrent();
                };

                if (asset.kind === "image") {
                    const img = document.createElement("img");
                    img.src = asset.url;
                    item.appendChild(img);
                } else {
                    const vid = document.createElement("video");
                    vid.src = asset.url;
                    vid.muted = true;
                    item.appendChild(vid);
                }

                rail.appendChild(item);
            });
        }

        function openAssetsFromTop() {
            alert("Wire this to open a full Assets / My Files view.");
        }

        // ================================================================
        // LIGHTBOX (DETAIL VIEW)
        // ================================================================
        function openLightbox(id) {
            const asset = state.assets.find((a) => a.id === id);
            if (!asset) return;
            state.lightboxId = id;

            const img = document.getElementById("lb-image");
            const video = document.getElementById("lb-video");

            img.style.display = "none";
            video.style.display = "none";

            if (asset.kind === "image") {
                img.src = asset.url;
                img.style.display = "block";
            } else {
                video.src = asset.url;
                video.style.display = "block";
            }

            document.getElementById("lb-title").innerText =
                (asset.kind === "image" ? "Image" : "Video") +
                " · " +
                asset.mode.toUpperCase();
            document.getElementById("lb-sub").innerText = asset.createdAt;
            document.getElementById("lb-res").innerText =
                asset.aspect + " · " + (asset.duration || "image");
            document.getElementById("lb-seed").innerText =
                asset.seed || "Random";
            document.getElementById("lb-created").innerText =
                asset.createdAt || "";
            document.getElementById("lb-source").innerText =
                asset.source === "generated" ? "Generated in Vision" : "Upload";
            document.getElementById("lb-prompt").innerText =
                asset.prompt || "";

            document
                .getElementById("lightbox-backdrop")
                .classList.add("active");
        }

        function closeLightbox() {
            document
                .getElementById("lightbox-backdrop")
                .classList.remove("active");
            state.lightboxId = null;
        }

        function getLbAsset() {
            if (!state.lightboxId) return null;
            return state.assets.find((a) => a.id === state.lightboxId);
        }

        function downloadCurrent() {
            const a = getLbAsset();
            if (!a) return;
            alert("Download stub for " + a.id + " (wire real download).");
        }

        function recreateCurrent() {
            const a = getLbAsset();
            if (!a) return;
            alert("Recreate using stored prompt. ID: " + a.id);
        }

        function sendCurrentToCinema() {
            const a = getLbAsset();
            if (!a) return;
            alert("Send to Cinema stub for " + a.id);
        }

        function renameCurrent() {
            const a = getLbAsset();
            if (!a) return;
            const name = prompt("Rename (nickname only):", a.id);
            if (!name) return;
            a.id = name;
            renderFeed();
            renderThumbRail();
        }

        function deleteCurrentAsset() {
            const a = getLbAsset();
            if (!a) return;
            if (!confirm("Delete this item from local history?")) return;
            state.assets = state.assets.filter((x) => x !== a);
            closeLightbox();
            renderFeed();
            updatePreviewFromCurrent();
        }
    </script>
</body>
</html>
