<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0"
    />
    <title>Sulandra Creative Lab ‚Äì Vision Studio</title>

    <!-- FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
        rel="preconnect"
        href="https://fonts.gstatic.com"
        crossorigin
    />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Cinzel:wght@500;600;700&display=swap"
        rel="stylesheet"
    />

    <style>
        /* ------------------------------------------------------------------
           DESIGN SYSTEM
        ------------------------------------------------------------------ */
        :root {
            --bg-root: #020617;
            --bg-elevated: #020617;
            --bg-panel: #020617;
            --bg-panel-soft: #030712;
            --bg-chip: #020617;
            --bg-chip-active: #0f172a;

            --accent: #6366f1;
            --accent-soft: rgba(99, 102, 241, 0.15);
            --accent-strong: rgba(129, 140, 248, 0.8);

            --danger: #ef4444;
            --success: #22c55e;
            --warning: #f59e0b;

            --text-primary: #e5e7eb;
            --text-secondary: #9ca3af;
            --text-muted: #6b7280;
            --text-soft: #4b5563;
            --border-subtle: #111827;

            --radius-sm: 6px;
            --radius-md: 12px;
            --radius-lg: 18px;
            --radius-xl: 24px;
            --radius-full: 9999px;

            --shadow-soft: 0 0 0 1px rgba(15, 23, 42, 0.9),
                0 20px 45px rgba(15, 23, 42, 0.9);

            --header-height: 62px;
            --nav-rail-width: 76px;
            --sidebar-width: 420px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            outline: none;
            -webkit-font-smoothing: antialiased;
        }

        body {
            font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont,
                "Segoe UI", sans-serif;
            background: radial-gradient(
                circle at top,
                #020617,
                #020617 18%,
                #030712 60%,
                #020617
            );
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
        }

        /* ------------------------------------------------------------------
           LEFT NAV RAIL
        ------------------------------------------------------------------ */
        .nav-rail {
            width: var(--nav-rail-width);
            background: linear-gradient(
                to bottom,
                #020617,
                #020617 40%,
                #020617
            );
            border-right: 1px solid rgba(15, 23, 42, 0.85);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 14px 8px 18px;
            gap: 12px;
            position: fixed;
            inset-block: 0;
            z-index: 10;
        }

        .brand-logo {
            width: 46px;
            height: 46px;
            border-radius: 16px;
            border: 1px solid rgba(148, 163, 184, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: "Cinzel", serif;
            font-weight: 700;
            font-size: 22px;
            color: #a5b4fc;
            background: radial-gradient(
                circle at 15% 0,
                rgba(129, 140, 248, 0.32),
                transparent 60%
            );
            box-shadow: 0 0 18px rgba(129, 140, 248, 0.35);
            margin-bottom: 10px;
        }

        .nav-section {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-top: 6px;
        }

        .nav-footer {
            margin-top: auto;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .nav-btn {
            width: 44px;
            height: 44px;
            border-radius: 16px;
            border: 1px solid rgba(30, 64, 175, 0.5);
            background: radial-gradient(
                circle at 0 0,
                rgba(129, 140, 248, 0.18),
                rgba(15, 23, 42, 0.96)
            );
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.15s;
            position: relative;
        }

        .nav-btn svg {
            width: 20px;
            height: 20px;
            fill: none;
            stroke: #9ca3af;
            stroke-width: 1.6;
        }

        .nav-btn.active {
            border-color: #6366f1;
            background: radial-gradient(
                circle at 30% 0,
                rgba(129, 140, 248, 0.45),
                rgba(15, 23, 42, 0.98)
            );
            box-shadow: 0 0 22px rgba(79, 70, 229, 0.55);
        }

        .nav-btn.active svg {
            stroke: #e5e7eb;
        }

        .nav-badge {
            position: absolute;
            top: 4px;
            right: 4px;
            min-width: 14px;
            height: 14px;
            padding: 0 3px;
            border-radius: 999px;
            background: radial-gradient(circle at 30% 0, #22c55e, #15803d);
            border: 1px solid #bbf7d0;
            font-size: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #022c22;
            font-weight: 600;
        }

        /* ------------------------------------------------------------------
           APP MAIN LAYOUT
        ------------------------------------------------------------------ */
        .app-shell {
            flex: 1;
            margin-left: var(--nav-rail-width);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* TOP BAR */
        .top-bar {
            height: var(--header-height);
            border-bottom: 1px solid rgba(15, 23, 42, 0.9);
            background: linear-gradient(
                to right,
                rgba(15, 23, 42, 0.96),
                rgba(15, 23, 42, 0.98)
            );
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 22px;
            position: sticky;
            top: 0;
            z-index: 5;
        }

        .top-bar-left {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .product-title {
            display: flex;
            flex-direction: column;
        }

        .product-title span:first-child {
            font-family: "Cinzel", serif;
            font-size: 16px;
            letter-spacing: 0.06em;
            text-transform: uppercase;
            color: #e5e7eb;
        }

        .product-title span:last-child {
            font-size: 11px;
            color: var(--text-muted);
        }

        .top-badge {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            border-radius: 999px;
            padding: 4px 10px;
            background: rgba(22, 163, 74, 0.12);
            border: 1px solid rgba(74, 222, 128, 0.5);
            color: #bbf7d0;
        }

        .top-bar-right {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .credits-pill {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(148, 163, 184, 0.45);
            font-size: 11px;
            color: var(--text-secondary);
        }

        .credits-pill span.value {
            color: #a5b4fc;
            font-weight: 600;
        }

        .user-chip {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 5px 10px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(31, 41, 55, 0.95);
            cursor: pointer;
        }

        .user-avatar {
            width: 22px;
            height: 22px;
            border-radius: 999px;
            background: radial-gradient(circle at 30% 0, #60a5fa, #312e81);
        }

        .user-name {
            font-size: 11px;
            color: var(--text-secondary);
        }

        /* ------------------------------------------------------------------
           LAB TOP TABS (Images / Videos / Short Films / My Files)
        ------------------------------------------------------------------ */
        .lab-tabs-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 22px 10px;
            border-bottom: 1px solid rgba(15, 23, 42, 0.9);
            background: linear-gradient(
                to right,
                rgba(15, 23, 42, 0.98),
                rgba(15, 23, 42, 1)
            );
            position: sticky;
            top: var(--header-height);
            z-index: 4;
        }

        .lab-tabs {
            display: inline-flex;
            background: rgba(15, 23, 42, 0.9);
            padding: 4px;
            border-radius: 999px;
            border: 1px solid rgba(31, 41, 55, 0.9);
            gap: 2px;
        }

        .lab-tab {
            border-radius: 999px;
            padding: 6px 14px;
            font-size: 12px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            color: var(--text-secondary);
            cursor: pointer;
        }

        .lab-tab span.icon {
            font-size: 12px;
            opacity: 0.75;
        }

        .lab-tab.active {
            background: radial-gradient(
                circle at 15% 0,
                rgba(129, 140, 248, 0.5),
                rgba(15, 23, 42, 0.98)
            );
            color: #e5e7eb;
            box-shadow: 0 0 0 1px rgba(129, 140, 248, 0.9);
        }

        .lab-tabs-right {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 10px;
            color: var(--text-muted);
        }

        .lab-mode-pill {
            border-radius: 999px;
            padding: 4px 10px;
            border: 1px solid rgba(31, 41, 55, 0.9);
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(15, 23, 42, 0.9);
        }

        .lab-mode-pill span.value {
            color: #a5b4fc;
            font-weight: 500;
        }

        /* ------------------------------------------------------------------
           MAIN LAB AREA (Create / View)
        ------------------------------------------------------------------ */
        .lab-layout {
            display: grid;
            grid-template-columns: minmax(0, var(--sidebar-width)) minmax(
                    0,
                    1fr
                );
            gap: 0;
            height: calc(100vh - var(--header-height) - 52px);
            padding: 12px 18px 18px;
        }

        .sidebar {
            background: radial-gradient(
                circle at 0 0,
                rgba(15, 23, 42, 0.98),
                #020617
            );
            border-radius: 22px;
            border: 1px solid rgba(15, 23, 42, 0.95);
            box-shadow: var(--shadow-soft);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .sidebar-header {
            padding: 14px 18px 10px;
            border-bottom: 1px solid rgba(15, 23, 42, 0.9);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
        }

        .sidebar-title {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .sidebar-title span.label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-muted);
        }

        .sidebar-title span.value {
            font-size: 13px;
            font-weight: 500;
        }

        .sidebar-actions {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn-icon {
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(31, 41, 55, 0.95);
            padding: 5px 8px;
            font-size: 11px;
            color: var(--text-secondary);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .btn-icon svg {
            width: 14px;
            height: 14px;
            stroke: var(--text-secondary);
            stroke-width: 1.6;
        }

        .btn-primary {
            border-radius: 999px;
            background: radial-gradient(
                circle at 0 0,
                rgba(129, 140, 248, 0.85),
                #312e81
            );
            border: 1px solid rgba(129, 140, 248, 0.9);
            color: #e5e7eb;
            font-size: 12px;
            font-weight: 500;
            padding: 7px 14px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: default;
        }

        /* sidebar scroll area */
        .sidebar-body {
            flex: 1;
            overflow-y: auto;
            padding: 14px 18px 18px;
        }

        .sidebar-section-title {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .input-group {
            margin-bottom: 14px;
        }

        .input-label {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 8px;
            margin-bottom: 4px;
        }

        .input-label span.main {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .input-label span.sub {
            font-size: 10px;
            color: var(--text-muted);
        }

        textarea,
        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            border-radius: 12px;
            border: 1px solid rgba(31, 41, 55, 0.9);
            background: rgba(15, 23, 42, 0.9);
            color: var(--text-primary);
            font-size: 12px;
            padding: 9px 10px;
            resize: vertical;
        }

        textarea {
            min-height: 80px;
        }

        .field-row {
            display: flex;
            gap: 8px;
            align-items: stretch;
        }

        .field-row > * {
            flex: 1;
        }

        .range-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .range-row span.value {
            font-size: 11px;
            color: var(--text-secondary);
            min-width: 26px;
            text-align: right;
        }

        input[type="range"] {
            flex: 1;
        }

        .chip-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .chip {
            border-radius: 999px;
            padding: 5px 10px;
            font-size: 11px;
            background: var(--bg-chip);
            border: 1px solid rgba(31, 41, 55, 0.9);
            color: var(--text-secondary);
            cursor: pointer;
        }

        .chip.active {
            background: rgba(129, 140, 248, 0.16);
            border-color: rgba(129, 140, 248, 0.9);
            color: #e5e7eb;
        }

        .assist-pills {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .assist-pill {
            border-radius: 999px;
            padding: 4px 9px;
            font-size: 11px;
            border: 1px dashed rgba(55, 65, 81, 0.9);
            color: #9ca3af;
            cursor: pointer;
        }

        /* Ask SIA button next to prompt */
        .btn-ask-sia {
            border-radius: 999px;
            border: 1px solid rgba(55, 65, 81, 0.95);
            background: rgba(15, 23, 42, 0.98);
            color: var(--text-secondary);
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 5px 10px;
            font-size: 11px;
            cursor: pointer;
        }

        .btn-ask-sia svg {
            width: 14px;
            height: 14px;
            stroke: #a5b4fc;
            stroke-width: 1.7;
        }

        /* ------------------------------------------------------------------
           STAGE / PREVIEW PANEL
        ------------------------------------------------------------------ */
        .stage {
            background: radial-gradient(
                circle at 50% 0,
                rgba(17, 24, 39, 0.95),
                #020617
            );
            border-radius: 22px;
            border: 1px solid rgba(15, 23, 42, 0.95);
            box-shadow: var(--shadow-soft);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .stage-header {
            padding: 14px 20px 10px;
            border-bottom: 1px solid rgba(15, 23, 42, 0.9);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .stage-title {
            display: flex;
            flex-direction: column;
        }

        .stage-title span.label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--text-muted);
        }

        .stage-title span.value {
            font-size: 13px;
            font-weight: 500;
        }

        .stage-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .view-toggle {
            display: inline-flex;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(31, 41, 55, 0.95);
            overflow: hidden;
        }

        .view-toggle button {
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 11px;
            padding: 4px 10px;
            cursor: pointer;
        }

        .view-toggle button.active {
            background: rgba(31, 41, 55, 0.95);
            color: #e5e7eb;
        }

        .stage-body {
            flex: 1;
            display: grid;
            grid-template-rows: minmax(0, 1fr) auto;
            overflow: hidden;
        }

        .stage-main {
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background: radial-gradient(
                circle at 50% 0,
                rgba(15, 23, 42, 0.98),
                #020617
            );
        }

        .preview-placeholder {
            border-radius: 18px;
            border: 1px dashed rgba(55, 65, 81, 0.85);
            padding: 26px 30px;
            text-align: center;
            max-width: 420px;
            color: var(--text-muted);
            font-size: 12px;
        }

        .preview-placeholder span {
            color: #a5b4fc;
        }

        .preview-media-wrapper {
            max-width: 100%;
            max-height: 100%;
            padding: 18px 20px 16px;
            display: none;
        }

        .preview-media-wrapper img,
        .preview-media-wrapper video {
            width: 100%;
            max-height: calc(100vh - 240px);
            object-fit: contain;
            border-radius: 18px;
            background: #020617;
            border: 1px solid rgba(31, 41, 55, 0.9);
        }

        .stage-footer {
            border-top: 1px solid rgba(15, 23, 42, 0.9);
            padding: 10px 18px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            background: rgba(15, 23, 42, 0.98);
        }

        .stage-footer-left {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            color: var(--text-muted);
        }

        .stage-footer-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ------------------------------------------------------------------
           ASSETS GALLERY (MY FILES SIDEBAR)
        ------------------------------------------------------------------ */
        .assets-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }

        .assets-list.vertical {
            display: flex;
            flex-direction: column;
        }

        .asset-card {
            position: relative;
            border-radius: 14px;
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(31, 41, 55, 0.95);
            cursor: pointer;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .asset-thumb {
            aspect-ratio: 4 / 3;
            background: radial-gradient(
                circle at 50% 0,
                rgba(15, 23, 42, 0.98),
                #020617
            );
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .asset-thumb img,
        .asset-thumb video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .asset-meta {
            padding: 8px 10px 9px;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .asset-title {
            font-size: 12px;
            color: var(--text-primary);
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }

        .asset-subtitle {
            font-size: 10px;
            color: var(--text-muted);
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }

        .asset-footer {
            padding: 6px 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 6px;
            font-size: 9px;
            color: var(--text-soft);
            border-top: 1px solid rgba(31, 41, 55, 0.9);
        }

        .asset-footer-left {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .asset-type-pill {
            border-radius: 999px;
            padding: 2px 7px;
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(31, 41, 55, 0.9);
        }

        .asset-actions {
            display: inline-flex;
            gap: 4px;
        }

        .asset-actions button {
            border: none;
            background: transparent;
            color: var(--text-muted);
            font-size: 10px;
            cursor: pointer;
        }

        .asset-fav {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 22px;
            height: 22px;
            border-radius: 999px;
            border: 1px solid rgba(24, 24, 27, 0.9);
            background: radial-gradient(
                circle at 30% 0,
                rgba(15, 23, 42, 0.98),
                #020617
            );
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .asset-fav svg {
            width: 13px;
            height: 13px;
            fill: none;
            stroke: rgba(148, 163, 184, 0.9);
            stroke-width: 1.6;
        }

        .asset-fav.is-active svg {
            fill: #f97316;
            stroke: #fed7aa;
        }

        /* ------------------------------------------------------------------
           LIGHTBOX
        ------------------------------------------------------------------ */
        .lightbox-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 30;
        }

        .lightbox-backdrop.active {
            display: flex;
        }

        .lightbox {
            width: min(960px, 94vw);
            max-height: 90vh;
            background: rgba(15, 23, 42, 0.98);
            border-radius: 24px;
            border: 1px solid rgba(31, 41, 55, 0.95);
            box-shadow: 0 32px 64px rgba(15, 23, 42, 0.9);
            display: grid;
            grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr);
            overflow: hidden;
        }

        .lightbox-media {
            background: radial-gradient(
                circle at 50% 0,
                rgba(15, 23, 42, 0.98),
                #020617
            );
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .lightbox-media img,
        .lightbox-media video {
            width: 100%;
            max-height: 80vh;
            object-fit: contain;
            border-radius: 18px;
            border: 1px solid rgba(31, 41, 55, 0.95);
            background: #020617;
        }

        .lightbox-info {
            padding: 18px 18px 16px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .lightbox-header {
            display: flex;
            justify-content: space-between;
            gap: 8px;
            margin-bottom: 4px;
        }

        .lightbox-title {
            font-size: 14px;
            font-weight: 500;
        }

        .lightbox-sub {
            font-size: 11px;
            color: var(--text-muted);
        }

        .btn-close {
            border: none;
            background: rgba(15, 23, 42, 0.95);
            border-radius: 999px;
            width: 26px;
            height: 26px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .lightbox-meta-list {
            font-size: 11px;
            display: grid;
            gap: 3px;
            margin-bottom: 8px;
        }

        .lightbox-meta-list span.label {
            color: var(--text-muted);
        }

        .lightbox-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 6px;
        }

        .lightbox-actions button {
            border-radius: 999px;
            border: 1px solid rgba(31, 41, 55, 0.95);
            background: rgba(15, 23, 42, 0.98);
            padding: 5px 10px;
            font-size: 11px;
            color: var(--text-secondary);
            cursor: pointer;
        }

        .lightbox-actions button.danger {
            border-color: rgba(248, 113, 113, 0.9);
            color: #fecaca;
        }

        .lightbox-prompt {
            margin-top: 10px;
            padding: 8px 9px;
            border-radius: 12px;
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(31, 41, 55, 0.95);
            font-size: 11px;
            color: var(--text-secondary);
            max-height: 120px;
            overflow-y: auto;
        }

        /* ------------------------------------------------------------------
           RESPONSIVE
        ------------------------------------------------------------------ */
        @media (max-width: 1100px) {
            .lab-layout {
                grid-template-columns: minmax(0, 1fr);
                grid-template-rows: auto auto;
                height: auto;
            }

            .sidebar {
                margin-bottom: 12px;
            }
        }

        @media (max-width: 900px) {
            .nav-rail {
                display: none;
            }

            .app-shell {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <!-- LEFT NAV RAIL -->
    <div class="nav-rail">
        <div class="brand-logo">S</div>

        <div class="nav-section">
            <div
                class="nav-btn"
                onclick="window.location.href='lab.html'"
                title="Home / Community"
            >
                <svg viewBox="0 0 24 24">
                    <path
                        d="M3 11.5L12 3l9 8.5v9.5h-6v-6h-6v6H3z"
                        fill="none"
                        stroke="currentColor"
                    />
                </svg>
            </div>
        </div>

        <div class="nav-section">
            <div
                class="nav-btn active"
                id="nav-vision"
                title="Vision Lab"
            >
                <svg viewBox="0 0 24 24">
                    <rect
                        x="3"
                        y="3"
                        width="18"
                        height="18"
                        rx="4"
                        ry="4"
                    ></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
            </div>
        </div>

        <div class="nav-footer">
            <div class="nav-btn" title="Studio (Pro)">
                <span class="nav-badge">PRO</span>
                <svg viewBox="0 0 24 24">
                    <path
                        d="M4 4h16v16H4z"
                        fill="none"
                        stroke="currentColor"
                    />
                    <path
                        d="M8 16l2.5-3 2 2 3.5-5 2 3"
                        fill="none"
                        stroke="currentColor"
                    />
                </svg>
            </div>
            <div class="nav-btn" title="Settings">
                <svg viewBox="0 0 24 24">
                    <path
                        d="M12 8a4 4 0 100 8 4 4 0 000-8zm8.94 2a1 1 0 00-.51-.66l-1.86-.9a6.9 6.9 0 00-.23-.55l-.27-2.03a1 1 0 00-.99-.86h-2a1 1 0 00-.96.74L13.4 6.7a7.3 7.3 0 00-.8 0L11.88 4.7a1 1 0 00-.96-.74h-2a1 1 0 00-.99.86l-.27 2.03-.23.55-1.86.9A1 1 0 004 10v4a1 1 0 00.53.89l1.86.9.23.55.27 2.03a1 1 0 00.99.86h2a1 1 0 00.96-.74l.72-2a7.3 7.3 0 00.8 0l.72 2a1 1 0 00.96.74h2a1 1 0 00.99-.86l.27-2.03.23-.55 1.86-.9A1 1 0 0021 14v-4a1 1 0 00-.06-.35z"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="1.4"
                    />
                </svg>
            </div>
        </div>
    </div>

    <!-- APP SHELL -->
    <div class="app-shell">
        <!-- TOP BAR -->
        <header class="top-bar">
            <div class="top-bar-left">
                <div class="product-title">
                    <span>Sulandra Creative Lab</span>
                    <span>Vision ¬∑ Images ¬∑ Video ¬∑ Short Films</span>
                </div>
                <div class="top-badge">Vision Studio</div>
            </div>

            <div class="top-bar-right">
                <div class="credits-pill">
                    Credits
                    <span class="value" id="credits-available">
                        120
                    </span>
                    / day
                </div>
                <div class="user-chip">
                    <div class="user-avatar"></div>
                    <div class="user-name">Creator</div>
                </div>
            </div>
        </header>

        <!-- LAB TABS -->
        <div class="lab-tabs-bar">
            <div class="lab-tabs" id="lab-tabs">
                <div
                    class="lab-tab active"
                    data-lab="image"
                    onclick="setActiveLab('image')"
                >
                    <span class="icon">üñº</span>
                    <span>Images</span>
                </div>
                <div
                    class="lab-tab"
                    data-lab="video"
                    onclick="setActiveLab('video')"
                >
                    <span class="icon">üé¨</span>
                    <span>Video Clips</span>
                </div>
                <div
                    class="lab-tab"
                    data-lab="shortfilm"
                    onclick="setActiveLab('shortfilm')"
                >
                    <span class="icon">üéû</span>
                    <span>Short Films</span>
                </div>
                <div
                    class="lab-tab"
                    data-lab="assets"
                    onclick="setActiveLab('assets')"
                >
                    <span class="icon">üìÅ</span>
                    <span>My Files</span>
                </div>
            </div>

            <div class="lab-tabs-right">
                <div class="lab-mode-pill">
                    <span>Mode:</span>
                    <span class="value" id="mode-label">Create</span>
                </div>
                <div class="lab-mode-pill">
                    <span>View:</span>
                    <span class="value" id="view-label">Grid</span>
                </div>
            </div>
        </div>

        <!-- MAIN LAB LAYOUT -->
        <main class="lab-layout">
            <!-- SIDEBAR: CREATE SETTINGS or MY FILES GALLERY -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-title">
                        <span class="label" id="sidebar-label">
                            Create
                        </span>
                        <span class="value" id="sidebar-title">
                            Image generation
                        </span>
                    </div>
                    <div class="sidebar-actions">
                        <button
                            class="btn-icon"
                            type="button"
                            onclick="resetForm()"
                            title="Reset fields"
                        >
                            Reset
                        </button>
                    </div>
                </div>

                <div
                    class="sidebar-body"
                    id="sidebar-body-create"
                >
                    <!-- PROMPTS -->
                    <div class="sidebar-section-title">
                        Prompt & Guidance
                    </div>

                    <div class="input-group">
                        <div class="input-label">
                            <span class="main">Prompt</span>
                            <span class="sub"
                                >Describe the image or scene you want</span
                            >
                        </div>
                        <div class="field-row">
                            <textarea
                                id="prompt"
                                placeholder="A cinematic portrait of a character in studio lighting, ultra-detailed..."
                            ></textarea>
                            <button
                                type="button"
                                class="btn-ask-sia"
                                onclick="openAskSia('prompt')"
                                title="Ask SIA to help write the prompt"
                            >
                                <svg viewBox="0 0 24 24">
                                    <path
                                        d="M12 3.5l1.6 3.3 3.6.5-2.6 2.6.6 3.6L12 11.7 8.8 13.5l.6-3.6L6.8 7.3l3.6-.5z"
                                        fill="none"
                                        stroke="currentColor"
                                        stroke-linejoin="round"
                                    />
                                </svg>
                                Ask SIA
                            </button>
                        </div>
                    </div>

                    <div class="input-group">
                        <div class="input-label">
                            <span class="main">Negative prompt</span>
                            <span class="sub"
                                >Things to avoid in the result</span
                            >
                        </div>
                        <textarea
                            id="negative"
                            placeholder="blurry, low quality, watermark, distorted faces..."
                        ></textarea>
                    </div>

                    <div class="assist-pills">
                        <button
                            type="button"
                            class="assist-pill"
                            onclick="appendNegative('blurry')"
                        >
                            Add ‚Äúblurry‚Äù
                        </button>
                        <button
                            type="button"
                            class="assist-pill"
                            onclick="appendNegative('extra limbs')"
                        >
                            Add ‚Äúextra limbs‚Äù
                        </button>
                    </div>

                    <!-- IMAGE OPTIONS -->
                    <div class="sidebar-section-title" style="margin-top: 16px">
                        Output & Quality
                    </div>

                    <div class="input-group">
                        <div class="input-label">
                            <span class="main">Aspect ratio</span>
                            <span class="sub"
                                >Square, portrait, or landscape</span
                            >
                        </div>
                        <div class="chip-row">
                            <button
                                type="button"
                                class="chip active"
                                data-ratio="1:1"
                                onclick="setAspectRatio('1:1',1024,1024,this)"
                            >
                                1:1 ¬∑ Square
                            </button>
                            <button
                                type="button"
                                class="chip"
                                data-ratio="16:9"
                                onclick="setAspectRatio('16:9',1280,720,this)"
                            >
                                16:9 ¬∑ Landscape
                            </button>
                            <button
                                type="button"
                                class="chip"
                                data-ratio="9:16"
                                onclick="setAspectRatio('9:16',720,1280,this)"
                            >
                                9:16 ¬∑ Portrait
                            </button>
                            <button
                                type="button"
                                class="chip"
                                data-ratio="4:5"
                                onclick="setAspectRatio('4:5',1024,1280,this)"
                            >
                                4:5 ¬∑ Portrait
                            </button>
                        </div>
                    </div>

                    <div class="input-group">
                        <div class="input-label">
                            <span class="main">Guidance scale</span>
                            <span class="sub"
                                >Lower = creative, higher = strict</span
                            >
                        </div>
                        <div class="range-row">
                            <input
                                type="range"
                                id="guidance"
                                min="1"
                                max="10"
                                step="0.5"
                                value="3.5"
                                oninput="document.getElementById('guidance-value').innerText=this.value"
                            />
                            <span
                                class="value"
                                id="guidance-value"
                            >
                                3.5
                            </span>
                        </div>
                    </div>

                    <div class="input-group">
                        <div class="input-label">
                            <span class="main">Number of images</span>
                            <span class="sub">1 ‚Äì 4 variations</span>
                        </div>
                        <select id="image-count">
                            <option value="1">1 image</option>
                            <option value="2">2 images</option>
                            <option value="3">3 images</option>
                            <option value="4">4 images</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <div class="input-label">
                            <span class="main">Seed</span>
                            <span class="sub"
                                >Use same seed to reproduce a look</span
                            >
                        </div>
                        <div class="field-row">
                            <input
                                type="number"
                                id="seed"
                                placeholder="Random"
                            />
                            <button
                                type="button"
                                class="btn-icon"
                                onclick="randomSeed()"
                            >
                                Random
                            </button>
                        </div>
                    </div>
                </div>

                <!-- MY FILES SIDEBAR (GALLERY) -->
                <div
                    class="sidebar-body"
                    id="sidebar-body-assets"
                    style="display: none"
                >
                    <div class="sidebar-section-title">
                        My Files
                    </div>

                    <div class="input-group">
                        <div class="chip-row">
                            <button
                                type="button"
                                class="chip active"
                                data-assets-filter="image"
                                onclick="setAssetsFilter('image', this)"
                            >
                                My images
                            </button>
                            <button
                                type="button"
                                class="chip"
                                data-assets-filter="video"
                                onclick="setAssetsFilter('video', this)"
                            >
                                My videos
                            </button>
                            <button
                                type="button"
                                class="chip"
                                data-assets-filter="shortfilm"
                                onclick="setAssetsFilter('shortfilm', this)"
                            >
                                My films
                            </button>
                            <button
                                type="button"
                                class="chip"
                                data-assets-filter="all"
                                onclick="setAssetsFilter('all', this)"
                            >
                                All files
                            </button>
                        </div>
                    </div>

                    <div class="input-group">
                        <div
                            class="assets-list"
                            id="assets-list"
                        ></div>
                        <div
                            id="assets-empty"
                            class="preview-placeholder"
                            style="margin-top: 10px; display: none"
                        >
                            Your generated
                            <span>images, videos, and short films</span>
                            will appear here. Use the tabs above to
                            filter by type.
                        </div>
                    </div>
                </div>
            </aside>

            <!-- STAGE / PREVIEW -->
            <section class="stage">
                <div class="stage-header">
                    <div class="stage-title">
                        <span class="label" id="stage-label">
                            Preview
                        </span>
                        <span class="value" id="stage-title">
                            Waiting for your first creation
                        </span>
                    </div>
                    <div class="stage-controls">
                        <div class="view-toggle">
                            <button
                                type="button"
                                id="view-grid-btn"
                                class="active"
                                onclick="setViewMode('grid')"
                            >
                                Grid
                            </button>
                            <button
                                type="button"
                                id="view-vertical-btn"
                                onclick="setViewMode('vertical')"
                            >
                                Vertical
                            </button>
                        </div>
                        <button
                            type="button"
                            class="btn-icon"
                            onclick="openAskSia('global')"
                        >
                            Global Ask SIA
                        </button>
                    </div>
                </div>

                <div class="stage-body">
                    <div class="stage-main">
                        <div
                            class="preview-placeholder"
                            id="preview-placeholder"
                        >
                            Use the fields on the left to create your
                            first
                            <span>image, video, or short film.</span>
                            The result will appear here, and every
                            generation will be stored under
                            <strong>My Files</strong>.
                        </div>

                        <div
                            class="preview-media-wrapper"
                            id="preview-media-wrapper"
                        >
                            <img
                                id="preview-image"
                                alt="Preview"
                                style="display: none"
                            />
                            <video
                                id="preview-video"
                                controls
                                style="display: none"
                            ></video>
                        </div>
                    </div>

                    <div class="stage-footer">
                        <div class="stage-footer-left">
                            <span id="footer-status">
                                Idle ¬∑ Ready to generate
                            </span>
                        </div>
                        <div class="stage-footer-right">
                            <button
                                type="button"
                                class="btn-icon"
                                onclick="openMyFilesFromFooter()"
                            >
                                My Files
                            </button>
                            <button
                                type="button"
                                class="btn-primary"
                                id="generate-btn"
                                onclick="handleGenerate()"
                            >
                                Generate
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- LIGHTBOX -->
    <div
        class="lightbox-backdrop"
        id="lightbox-backdrop"
        onclick="backdropClick(event)"
    >
        <div class="lightbox" id="lightbox">
            <div class="lightbox-media">
                <img
                    id="lightbox-image"
                    alt="Asset preview"
                    style="display: none"
                />
                <video
                    id="lightbox-video"
                    controls
                    style="display: none"
                ></video>
            </div>
            <div class="lightbox-info">
                <div class="lightbox-header">
                    <div>
                        <div
                            class="lightbox-title"
                            id="lightbox-title"
                        >
                            Asset
                        </div>
                        <div
                            class="lightbox-sub"
                            id="lightbox-sub"
                        >
                            Type ¬∑ Created
                        </div>
                    </div>
                    <button
                        type="button"
                        class="btn-close"
                        onclick="closeLightbox()"
                    >
                        √ó
                    </button>
                </div>

                <div class="lightbox-meta-list">
                    <div>
                        <span class="label">Resolution:</span>
                        <span id="lightbox-res"></span>
                    </div>
                    <div>
                        <span class="label">Seed:</span>
                        <span id="lightbox-seed"></span>
                    </div>
                    <div>
                        <span class="label">Created:</span>
                        <span id="lightbox-created"></span>
                    </div>
                </div>

                <div class="lightbox-actions">
                    <button
                        type="button"
                        onclick="downloadCurrentAsset()"
                    >
                        Download
                    </button>
                    <button
                        type="button"
                        onclick="recreateCurrentAsset()"
                    >
                        Recreate
                    </button>
                    <button
                        type="button"
                        onclick="sendCurrentAssetToCinema()"
                    >
                        Send to cinema
                    </button>
                    <button
                        type="button"
                        onclick="renameCurrentAsset()"
                    >
                        Rename
                    </button>
                    <button
                        type="button"
                        class="danger"
                        onclick="deleteCurrentAsset()"
                    >
                        Delete
                    </button>
                </div>

                <div
                    class="lightbox-prompt"
                    id="lightbox-prompt"
                ></div>
            </div>
        </div>
    </div>

    <script>
        // ---------------------------------------------------------------------
        // GLOBAL STATE
        // ---------------------------------------------------------------------
        const state = {
            activeLab: "image", // 'image' | 'video' | 'shortfilm' | 'assets'
            mode: "create", // 'create' | 'assets'
            viewMode: "grid", // 'grid' | 'vertical'
            assetsFilter: "image", // 'image' | 'video' | 'shortfilm' | 'all'
            assets: [],
            previewAssetId: null,
            lightboxId: null,
            nextId: 1,
        };

        // ---------------------------------------------------------------------
        // LAB SWITCHING
        // ---------------------------------------------------------------------
        function setActiveLab(lab) {
            state.activeLab = lab;
            document
                .querySelectorAll(".lab-tab")
                .forEach((tab) => {
                    tab.classList.toggle(
                        "active",
                        tab.dataset.lab === lab
                    );
                });

            if (lab === "assets") {
                state.mode = "assets";
                document.getElementById("mode-label").innerText =
                    "My Files";
                document.getElementById(
                    "sidebar-label"
                ).innerText = "Library";
                document.getElementById(
                    "sidebar-title"
                ).innerText = "Browse all generated files";
                document.getElementById("stage-label").innerText =
                    "Detail view";
                document.getElementById("stage-title").innerText =
                    "Select a file from the left";
                document.getElementById(
                    "sidebar-body-create"
                ).style.display = "none";
                document.getElementById(
                    "sidebar-body-assets"
                ).style.display = "block";
                document.getElementById("footer-status").innerText =
                    "My Files ¬∑ Browse and manage your creations";
                renderAssetsList();
            } else {
                state.mode = "create";
                document.getElementById("mode-label").innerText =
                    "Create";
                document.getElementById(
                    "sidebar-label"
                ).innerText = "Create";
                document.getElementById(
                    "sidebar-title"
                ).innerText = getCreateSidebarTitle();
                document.getElementById("stage-label").innerText =
                    "Preview";
                document.getElementById("stage-title").innerText =
                    "Waiting for your next " + lab + " generation";
                document.getElementById(
                    "sidebar-body-create"
                ).style.display = "block";
                document.getElementById(
                    "sidebar-body-assets"
                ).style.display = "none";
                document.getElementById("footer-status").innerText =
                    "Idle ¬∑ Ready to generate";
            }
        }

        function getCreateSidebarTitle() {
            switch (state.activeLab) {
                case "image":
                    return "Image generation";
                case "video":
                    return "Video generation";
                case "shortfilm":
                    return "Short film generation";
                default:
                    return "Generation settings";
            }
        }

        // ---------------------------------------------------------------------
        // VIEW MODE (GRID vs VERTICAL)
        // ---------------------------------------------------------------------
        function setViewMode(mode) {
            state.viewMode = mode;
            document.getElementById("view-label").innerText =
                mode === "grid" ? "Grid" : "Vertical";

            document
                .getElementById("view-grid-btn")
                .classList.toggle("active", mode === "grid");
            document
                .getElementById("view-vertical-btn")
                .classList.toggle("active", mode === "vertical");

            const list = document.getElementById("assets-list");
            if (!list) return;
            if (mode === "vertical") {
                list.classList.add("vertical");
            } else {
                list.classList.remove("vertical");
            }
        }

        // ---------------------------------------------------------------------
        // MY FILES FILTER
        // ---------------------------------------------------------------------
        function setAssetsFilter(filter, btn) {
            state.assetsFilter = filter;

            document
                .querySelectorAll("[data-assets-filter]")
                .forEach((el) => {
                    el.classList.toggle("active", el === btn);
                });

            renderAssetsList();
        }

        // ---------------------------------------------------------------------
        // ASPECT RATIO, NEGATIVE HELPERS, SEED
        // ---------------------------------------------------------------------
        function setAspectRatio(label, w, h, chip) {
            document
                .querySelectorAll(".chip[data-ratio]")
                .forEach((c) => c.classList.remove("active"));
            chip.classList.add("active");
            chip.dataset.w = w;
            chip.dataset.h = h;
        }

        function appendNegative(text) {
            const field = document.getElementById("negative");
            if (!field.value) {
                field.value = text;
            } else if (!field.value.includes(text)) {
                field.value += ", " + text;
            }
        }

        function randomSeed() {
            const value = Math.floor(Math.random() * 999999999);
            document.getElementById("seed").value = value;
        }

        function resetForm() {
            document.getElementById("prompt").value = "";
            document.getElementById("negative").value = "";
            document.getElementById("image-count").value = "1";
            document.getElementById("seed").value = "";
            document.getElementById("guidance").value = 3.5;
            document.getElementById(
                "guidance-value"
            ).innerText = "3.5";
            document
                .querySelectorAll(".chip[data-ratio]")
                .forEach((chip) => chip.classList.remove("active"));
            const first = document.querySelector(
                ".chip[data-ratio]"
            );
            if (first) first.classList.add("active");
        }

        // ---------------------------------------------------------------------
        // GENERATION HANDLER (stub ‚Äì wire to your backend)
        // ---------------------------------------------------------------------
        function handleGenerate() {
            if (state.mode !== "create") {
                setActiveLab(state.activeLab || "image");
            }

            const prompt = document
                .getElementById("prompt")
                .value.trim();
            if (!prompt) {
                alert("Please enter a prompt first.");
                return;
            }

            const negative = document
                .getElementById("negative")
                .value.trim();
            const guidance = parseFloat(
                document.getElementById("guidance").value
            );
            const count = parseInt(
                document.getElementById("image-count").value,
                10
            );
            const seedValue = document
                .getElementById("seed")
                .value.trim();

            document.getElementById("footer-status").innerText =
                "Generating " +
                state.activeLab +
                "‚Ä¶ (stubbed client-side only)";
            document.getElementById(
                "generate-btn"
            ).disabled = true;

            // NOTE: This is a placeholder: we simulate a generation and
            // create local asset entries. Replace with real API call.
            setTimeout(() => {
                for (let i = 0; i < count; i++) {
                    const id = "asset-" + state.nextId++;
                    const asset = {
                        id,
                        type: state.activeLab, // 'image' | 'video' | 'shortfilm'
                        createdAt: new Date().toLocaleString(),
                        prompt,
                        negative,
                        guidance,
                        seed: seedValue || null,
                        width: 1024,
                        height: 1024,
                        displayName:
                            state.activeLab.toUpperCase() +
                            " ¬∑ " +
                            state.nextId,
                        url: getPlaceholderUrl(
                            state.activeLab
                        ),
                        isFavorite: false,
                    };
                    state.assets.unshift(asset);
                    state.previewAssetId = asset.id;
                }

                document.getElementById(
                    "generate-btn"
                ).disabled = false;
                document.getElementById(
                    "footer-status"
                ).innerText =
                    "Done ¬∑ Saved to My Files";

                // If we are in create mode, show last generated in preview
                if (state.previewAssetId) {
                    const asset = state.assets.find(
                        (a) => a.id === state.previewAssetId
                    );
                    if (asset) showPreviewAsset(asset);
                }

                // Refresh My Files if user opens it next
                if (state.mode === "assets") {
                    renderAssetsList();
                }
            }, 700);
        }

        function getPlaceholderUrl(kind) {
            // You can replace this with a backend URL.
            if (kind === "video" || kind === "shortfilm") {
                // Placeholder transparent video; real system should use actual video URL
                return "";
            }
            // simple placeholder image
            return "https://placehold.co/1024x1024/020617/9ca3af?text=Sulandra+Preview";
        }

        function showPreviewAsset(asset) {
            const placeholder = document.getElementById(
                "preview-placeholder"
            );
            const wrapper = document.getElementById(
                "preview-media-wrapper"
            );
            const img = document.getElementById("preview-image");
            const vid = document.getElementById("preview-video");

            placeholder.style.display = "none";
            wrapper.style.display = "block";

            if (asset.type === "image") {
                img.style.display = "block";
                vid.style.display = "none";
                img.src = asset.url;
            } else {
                img.style.display = "none";
                vid.style.display = "block";
                vid.src = asset.url;
            }

            document.getElementById("stage-title").innerText =
                asset.displayName;
        }

        // ---------------------------------------------------------------------
        // MY FILES ‚Äì RENDERING
        // ---------------------------------------------------------------------
        function renderAssetsList() {
            const list = document.getElementById("assets-list");
            const empty = document.getElementById("assets-empty");
            if (!list || !empty) return;

            list.innerHTML = "";

            let filtered = state.assets;
            if (state.assetsFilter !== "all") {
                filtered = state.assets.filter(
                    (a) => a.type === state.assetsFilter
                );
            }

            if (!filtered.length) {
                empty.style.display = "block";
                return;
            }
            empty.style.display = "none";

            filtered.forEach((asset) => {
                const card = document.createElement("div");
                card.className = "asset-card";
                card.dataset.assetId = asset.id;

                card.onclick = () => openAssetInPreview(asset.id);

                const thumb = document.createElement("div");
                thumb.className = "asset-thumb";
                const img = document.createElement("img");
                const video = document.createElement("video");
                video.muted = true;

                if (asset.type === "image") {
                    img.src = asset.url;
                    thumb.appendChild(img);
                } else {
                    video.src = asset.url || "";
                    video.poster =
                        asset.url ||
                        "https://placehold.co/640x360/020617/9ca3af?text=Video";
                    thumb.appendChild(video);
                }

                card.appendChild(thumb);

                const meta = document.createElement("div");
                meta.className = "asset-meta";
                const title = document.createElement("div");
                title.className = "asset-title";
                title.innerText = asset.displayName || "Asset";
                const sub = document.createElement("div");
                sub.className = "asset-subtitle";
                sub.innerText = asset.createdAt;

                meta.appendChild(title);
                meta.appendChild(sub);
                card.appendChild(meta);

                const footer = document.createElement("div");
                footer.className = "asset-footer";
                const left = document.createElement("div");
                left.className = "asset-footer-left";

                const typePill = document.createElement("div");
                typePill.className = "asset-type-pill";
                typePill.innerText =
                    asset.type === "image"
                        ? "Image"
                        : asset.type === "video"
                        ? "Video"
                        : "Film";

                left.appendChild(typePill);
                footer.appendChild(left);

                const actions = document.createElement("div");
                actions.className = "asset-actions";

                const btnOpen = document.createElement("button");
                btnOpen.innerText = "Open";
                btnOpen.onclick = (e) => {
                    e.stopPropagation();
                    openLightbox(asset.id);
                };

                const btnMenu = document.createElement("button");
                btnMenu.innerText = "‚ãØ";
                btnMenu.onclick = (e) => {
                    e.stopPropagation();
                    openLightbox(asset.id);
                };

                actions.appendChild(btnOpen);
                actions.appendChild(btnMenu);
                footer.appendChild(actions);

                card.appendChild(footer);

                const fav = document.createElement("button");
                fav.className =
                    "asset-fav" +
                    (asset.isFavorite ? " is-active" : "");
                fav.innerHTML =
                    '<svg viewBox="0 0 24 24"><path d="M12.1 8.64l-.1.1-.11-.11C10.14 6.6 7.1 6.6 5.13 8.58c-1.98 1.98-1.98 5.18 0 7.16L12 22.5l6.87-6.76c1.98-1.98 1.98-5.18 0-7.16-1.97-1.98-5.01-1.98-6.97 0z" /></svg>';
                fav.onclick = (e) => {
                    e.stopPropagation();
                    toggleFavorite(asset.id, fav);
                };

                card.appendChild(fav);

                list.appendChild(card);
            });

            // Apply view mode styling
            setViewMode(state.viewMode);
        }

        function openAssetInPreview(id) {
            const asset = state.assets.find((a) => a.id === id);
            if (!asset) return;
            state.previewAssetId = id;
            showPreviewAsset(asset);
            document.getElementById("stage-title").innerText =
                asset.displayName;
            document.getElementById("stage-label").innerText =
                "Detail preview";
        }

        function toggleFavorite(id, favBtn) {
            const asset = state.assets.find((a) => a.id === id);
            if (!asset) return;
            asset.isFavorite = !asset.isFavorite;
            favBtn.classList.toggle("is-active", asset.isFavorite);
        }

        // ---------------------------------------------------------------------
        // LIGHTBOX
        // ---------------------------------------------------------------------
        function openLightbox(id) {
            const asset = state.assets.find((a) => a.id === id);
            if (!asset) return;
            state.lightboxId = id;

            const backdrop = document.getElementById(
                "lightbox-backdrop"
            );
            const img = document.getElementById("lightbox-image");
            const vid = document.getElementById("lightbox-video");

            img.style.display = "none";
            vid.style.display = "none";

            if (asset.type === "image") {
                img.src = asset.url;
                img.style.display = "block";
            } else {
                vid.src = asset.url || "";
                vid.style.display = "block";
            }

            document.getElementById("lightbox-title").innerText =
                asset.displayName;
            document.getElementById("lightbox-sub").innerText =
                (asset.type === "image"
                    ? "Image"
                    : asset.type === "video"
                    ? "Video"
                    : "Short film") +
                " ¬∑ " +
                asset.createdAt;
            document.getElementById("lightbox-res").innerText =
                (asset.width || "‚Äì") +
                " √ó " +
                (asset.height || "‚Äì");
            document.getElementById("lightbox-seed").innerText =
                asset.seed || "Random";
            document.getElementById("lightbox-created").innerText =
                asset.createdAt || "‚Äì";
            document.getElementById("lightbox-prompt").innerText =
                asset.prompt || "";

            backdrop.classList.add("active");
        }

        function closeLightbox() {
            const backdrop = document.getElementById(
                "lightbox-backdrop"
            );
            backdrop.classList.remove("active");
            const vid = document.getElementById("lightbox-video");
            if (vid) vid.pause();
            state.lightboxId = null;
        }

        function backdropClick(event) {
            if (event.target.id === "lightbox-backdrop") {
                closeLightbox();
            }
        }

        // ---------------------------------------------------------------------
        // LIGHTBOX ACTIONS
        // ---------------------------------------------------------------------
        function getCurrentLightboxAsset() {
            if (!state.lightboxId) return null;
            return state.assets.find(
                (a) => a.id === state.lightboxId
            );
        }

        function downloadCurrentAsset() {
            const asset = getCurrentLightboxAsset();
            if (!asset) return;
            // TODO: swap this placeholder with a real download flow
            alert(
                "Download triggered for: " +
                    asset.displayName +
                    " (client-side demo only)"
            );
        }

        function recreateCurrentAsset() {
            const asset = getCurrentLightboxAsset();
            if (!asset) return;
            document.getElementById("prompt").value =
                asset.prompt || "";
            document.getElementById("negative").value =
                asset.negative || "";
            if (asset.seed) {
                document.getElementById("seed").value = asset.seed;
            }
            setActiveLab(asset.type || "image");
            closeLightbox();
        }

        function sendCurrentAssetToCinema() {
            const asset = getCurrentLightboxAsset();
            if (!asset) return;
            // TODO: connect to your "Cinema" / short film workspace routing
            alert(
                "Send to cinema: " +
                    asset.displayName +
                    " (stubbed action)"
            );
        }

        function renameCurrentAsset() {
            const asset = getCurrentLightboxAsset();
            if (!asset) return;
            const newName = prompt(
                "Rename asset:",
                asset.displayName
            );
            if (!newName) return;
            asset.displayName = newName;
            renderAssetsList();
            openLightbox(asset.id);
        }

        function deleteCurrentAsset() {
            const asset = getCurrentLightboxAsset();
            if (!asset) return;
            if (
                !confirm(
                    "Delete this asset permanently from My Files?"
                )
            )
                return;
            state.assets = state.assets.filter(
                (a) => a.id !== asset.id
            );
            closeLightbox();
            renderAssetsList();
        }

        // ---------------------------------------------------------------------
        // ASK SIA (stub hooks)
        // ---------------------------------------------------------------------
        function openAskSia(scope) {
            // scope: 'prompt' | 'global' etc.
            alert(
                "Ask SIA will open here for scope: " +
                    scope +
                    ".\nConnect this to your SIA Brain endpoint."
            );
        }

        // ---------------------------------------------------------------------
        // HELPERS
        // ---------------------------------------------------------------------
        function openMyFilesFromFooter() {
            setActiveLab("assets");
        }

        // Initialize
        window.addEventListener("DOMContentLoaded", () => {
            setActiveLab("image");
            setViewMode("grid");
        });
    </script>
</body>
</html>
