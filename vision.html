<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sulandra Creative Lab Â· Enterprise Suite</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Cinzel:wght@400;600;700;800&display=swap" rel="stylesheet">

<script src="https://unpkg.com/@phosphor-icons/web"></script>

<style>
/* -------------------------------------------------------------------------- */
/* 1.0 DESIGN SYSTEM: "DEEP VOID" (KLING AI AESTHETIC)                        */
/* -------------------------------------------------------------------------- */
:root {
    /* Color Palette - Absolute Dark Mode */
    --bg-root: #000000;
    --bg-chrome: #09090b;
    --bg-surface: #121214;
    --bg-surface-hover: #1c1c1f;
    --bg-input: #000000;

    /* Borders */
    --border-dim: rgba(255, 255, 255, 0.06);
    --border-light: rgba(255, 255, 255, 0.12);
    --border-highlight: rgba(255, 255, 255, 0.2);

    /* Text */
    --txt-primary: #ffffff;
    --txt-secondary: #a1a1aa;
    --txt-tertiary: #52525b;
    --txt-accent: #6366f1;

    /* Accents (Indigo/Violet) */
    --accent-primary: #6366f1;
    --accent-glow: rgba(99, 102, 241, 0.35);
    --accent-gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);

    /* Metrics */
    --nav-width: 68px;
    --sidebar-width: 380px;
    --header-height: 60px;
    --radius-sm: 6px;
    --radius-md: 10px;
    --radius-lg: 14px;
}

/* Base Reset */
* { box-sizing: border-box; outline: none; user-select: none; -webkit-font-smoothing: antialiased; }
body {
    margin: 0; padding: 0;
    background: var(--bg-root);
    color: var(--txt-primary);
    font-family: 'Inter', sans-serif;
    height: 100vh; overflow: hidden;
    display: flex;
}
input, textarea, select { user-select: text; font-family: 'Inter', sans-serif; }
a { text-decoration: none; color: inherit; }

/* Typography Classes */
.font-brand { font-family: 'Cinzel', serif; }
.font-mono { font-family: 'JetBrains Mono', monospace; }
.text-xs { font-size: 11px; }
.text-sm { font-size: 13px; }
.text-md { font-size: 15px; }
.text-lg { font-size: 18px; }
.font-bold { font-weight: 700; }
.text-muted { color: var(--txt-secondary); }

/* Custom Scrollbar */
::-webkit-scrollbar { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: #555; }

/* -------------------------------------------------------------------------- */
/* 2.0 COMPONENTS                                                             */
/* -------------------------------------------------------------------------- */

/* Buttons */
.btn {
    display: inline-flex; align-items: center; justify-content: center; gap: 8px;
    height: 40px; padding: 0 16px; border-radius: var(--radius-md);
    font-size: 13px; font-weight: 600; cursor: pointer;
    transition: all 0.2s ease; border: 1px solid transparent;
}
.btn-primary {
    background: var(--txt-primary); color: var(--bg-root);
}
.btn-primary:hover { background: #e4e4e7; transform: translateY(-1px); }
.btn-accent {
    background: var(--accent-gradient); color: white;
    box-shadow: 0 0 15px var(--accent-glow);
}
.btn-accent:hover { filter: brightness(1.1); }
.btn-ghost {
    background: transparent; color: var(--txt-secondary);
}
.btn-ghost:hover { background: var(--bg-surface-hover); color: var(--txt-primary); }
.btn-outline {
    background: transparent; border: 1px solid var(--border-light); color: var(--txt-secondary);
}
.btn-outline:hover { border-color: var(--txt-primary); color: var(--txt-primary); }

.btn-icon {
    width: 36px; height: 36px; padding: 0; border-radius: var(--radius-md);
    color: var(--txt-secondary); background: transparent;
}
.btn-icon:hover { background: var(--bg-surface-hover); color: white; }
.btn-icon.active { background: rgba(99,102,241,0.1); color: var(--accent-primary); border: 1px solid rgba(99,102,241,0.2); }

/* Inputs */
.form-group { margin-bottom: 20px; }
.form-label {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 8px; font-size: 11px; font-weight: 700;
    text-transform: uppercase; color: var(--txt-secondary); letter-spacing: 0.05em;
}
.input-text, .input-area, .input-select {
    width: 100%; background: var(--bg-input); border: 1px solid var(--border-dim);
    border-radius: var(--radius-md); padding: 10px 12px;
    color: white; font-size: 13px; transition: 0.2s;
}
.input-text:focus, .input-area:focus, .input-select:focus {
    border-color: var(--accent-primary); box-shadow: 0 0 0 1px var(--accent-primary);
}
.input-area { min-height: 100px; resize: vertical; line-height: 1.5; }

/* Sliders */
input[type=range] {
    -webkit-appearance: none; width: 100%; background: transparent; margin: 8px 0;
}
input[type=range]::-webkit-slider-runnable-track {
    width: 100%; height: 4px; background: var(--bg-surface-hover); border-radius: 2px;
}
input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%;
    background: white; margin-top: -6px; cursor: pointer;
    box-shadow: 0 2px 5px rgba(0,0,0,0.5);
}

/* Aspect Ratio Grid */
.ratio-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
.ratio-card {
    background: var(--bg-surface); border: 1px solid var(--border-dim);
    border-radius: var(--radius-md); padding: 12px 0; text-align: center;
    cursor: pointer; transition: 0.2s;
}
.ratio-card:hover { border-color: var(--txt-secondary); }
.ratio-card.active { background: rgba(99,102,241,0.1); border-color: var(--accent-primary); color: white; }
.ratio-viz { display: block; margin: 0 auto 6px; border: 1.5px solid currentColor; border-radius: 2px; opacity: 0.7; }

/* -------------------------------------------------------------------------- */
/* 3.0 LAYOUT ENGINE                                                          */
/* -------------------------------------------------------------------------- */
.layout-container { display: flex; width: 100vw; height: 100vh; }

/* Left Nav Rail */
.nav-rail {
    width: var(--nav-width); background: var(--bg-root);
    border-right: 1px solid var(--border-dim);
    display: flex; flex-direction: column; align-items: center; padding: 20px 0; z-index: 50;
}
.nav-brand {
    width: 44px; height: 44px; background: var(--accent-gradient);
    border-radius: 12px; display: flex; align-items: center; justify-content: center;
    font-family: 'Cinzel', serif; font-weight: 800; font-size: 20px; color: white;
    margin-bottom: 30px; box-shadow: 0 0 20px var(--accent-glow);
}
.nav-item {
    width: 44px; height: 44px; display: flex; align-items: center; justify-content: center;
    border-radius: 12px; color: var(--txt-secondary); margin-bottom: 12px;
    cursor: pointer; transition: 0.2s; position: relative; font-size: 22px;
}
.nav-item:hover { color: white; background: var(--bg-surface); }
.nav-item.active { color: white; background: var(--bg-surface); }
.nav-item.active::before {
    content: ''; position: absolute; left: -12px; width: 4px; height: 24px;
    background: var(--accent-primary); border-radius: 0 4px 4px 0;
}

/* Control Sidebar */
.sidebar {
    width: var(--sidebar-width); background: var(--bg-chrome);
    border-right: 1px solid var(--border-dim);
    display: flex; flex-direction: column; z-index: 40;
}
.sidebar-header {
    height: var(--header-height); padding: 0 20px;
    display: flex; align-items: center; justify-content: space-between;
    border-bottom: 1px solid var(--border-dim);
}
.sidebar-content { flex: 1; overflow-y: auto; padding: 20px; }

/* Main Stage */
.stage {
    flex: 1; background: #000; position: relative;
    display: flex; flex-direction: column;
}
.stage-header {
    height: var(--header-height); padding: 0 24px;
    display: flex; align-items: center; justify-content: space-between;
    background: rgba(9,9,11,0.8); backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border-dim); z-index: 10;
}
.stage-content {
    flex: 1; overflow-y: auto; padding: 24px;
    background: radial-gradient(circle at 50% 0%, #15151a 0%, #000000 70%);
}

/* -------------------------------------------------------------------------- */
/* 4.0 ASSETS / MY FILES SIDEBAR (THE MISSING PIECE)                          */
/* -------------------------------------------------------------------------- */
.assets-toolbar {
    display: flex; gap: 8px; margin-bottom: 16px; overflow-x: auto; padding-bottom: 4px;
}
.chip {
    padding: 6px 12px; border-radius: 100px; border: 1px solid var(--border-dim);
    background: var(--bg-surface); color: var(--txt-secondary); font-size: 11px; font-weight: 600;
    cursor: pointer; white-space: nowrap;
}
.chip.active { background: var(--bg-surface-hover); color: white; border-color: var(--accent-primary); }

.assets-grid {
    display: grid; grid-template-columns: 1fr 1fr; gap: 8px;
}
.assets-grid.list-mode { grid-template-columns: 1fr; }

.asset-item {
    background: var(--bg-surface); border: 1px solid var(--border-dim);
    border-radius: var(--radius-md); overflow: hidden; cursor: pointer;
    transition: 0.15s; position: relative;
}
.asset-item:hover { border-color: var(--txt-secondary); }
.asset-item.active { border-color: var(--accent-primary); box-shadow: 0 0 0 1px var(--accent-primary); }

/* Thumb styles */
.asset-thumb { width: 100%; height: 80px; object-fit: cover; background: #000; display: block; }
.list-mode .asset-thumb { width: 48px; height: 48px; border-radius: 4px; display: inline-block; vertical-align: middle; margin: 4px; }
.asset-info { padding: 8px; font-size: 11px; color: var(--txt-secondary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.list-mode .asset-info { display: inline-block; vertical-align: middle; width: calc(100% - 60px); border: none; }

/* -------------------------------------------------------------------------- */
/* 5.0 GALLERY CARDS                                                          */
/* -------------------------------------------------------------------------- */
.gallery-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 16px;
}
.card {
    background: var(--bg-surface); border: 1px solid var(--border-dim);
    border-radius: var(--radius-lg); overflow: hidden; position: relative;
    aspect-ratio: 1/1; transition: transform 0.2s;
}
.card.video { aspect-ratio: 16/9; }
.card:hover { transform: translateY(-4px); border-color: var(--txt-secondary); }
.card-img { width: 100%; height: 100%; object-fit: cover; }
.card-overlay {
    position: absolute; inset: 0; background: linear-gradient(to top, black, transparent 60%);
    opacity: 0; transition: 0.2s; padding: 16px; display: flex; flex-direction: column; justify-content: flex-end;
}
.card:hover .card-overlay { opacity: 1; }
.card-prompt { font-size: 12px; color: #e4e4e7; line-height: 1.4; margin-bottom: 12px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.card-actions { display: flex; gap: 8px; }

/* -------------------------------------------------------------------------- */
/* 6.0 STORYBOARD (SHORT FILM)                                                */
/* -------------------------------------------------------------------------- */
.storyboard-track {
    display: flex; gap: 8px; overflow-x: auto; padding: 10px;
    background: var(--bg-input); border: 1px dashed var(--border-dim);
    border-radius: var(--radius-md); min-height: 140px; align-items: center;
}
.shot-card {
    min-width: 140px; height: 80px; background: var(--bg-surface);
    border: 1px solid var(--border-dim); border-radius: 6px;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    color: var(--txt-secondary); font-size: 10px; position: relative;
}
.shot-card:hover { border-color: var(--accent-primary); }
.shot-num { position: absolute; top: 4px; left: 4px; background: rgba(0,0,0,0.7); padding: 2px 4px; border-radius: 4px; }

/* -------------------------------------------------------------------------- */
/* 7.0 UTILS & ANIMATIONS                                                     */
/* -------------------------------------------------------------------------- */
.hidden { display: none !important; }
.pro-badge { 
    background: linear-gradient(90deg, #f59e0b, #d97706); 
    color: black; font-weight: 800; font-size: 10px; padding: 2px 6px; border-radius: 4px; 
}
.loader {
    width: 20px; height: 20px; border: 2px solid rgba(255,255,255,0.2);
    border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

</style>
</head>
<body>

<div class="layout-container">

    <nav class="nav-rail">
        <div class="nav-brand">S</div>
        
        <div class="nav-item active" id="nav-image" onclick="App.switchLab('image')" title="Image Lab">
            <i class="ph ph-image"></i>
        </div>
        <div class="nav-item" id="nav-video" onclick="App.switchLab('video')" title="Video Lab">
            <i class="ph ph-film-strip"></i>
        </div>
        <div class="nav-item" id="nav-shortfilm" onclick="App.switchLab('shortfilm')" title="Director Mode">
            <i class="ph ph-projector-screen"></i>
        </div>
        <div class="nav-item" id="nav-assets" onclick="App.switchLab('assets')" title="My Files">
            <i class="ph ph-folder-open"></i>
        </div>

        <div style="margin-top: auto;"></div>
        <div class="nav-item" title="Community"><i class="ph ph-users"></i></div>
        <div class="nav-item" title="Settings"><i class="ph ph-gear"></i></div>
        <div class="nav-item" title="Profile"><img src="https://i.pravatar.cc/100" style="width:24px; height:24px; border-radius:50%;"></div>
    </nav>

    <aside class="sidebar">
        <div class="sidebar-header">
            <span class="font-brand font-bold text-md tracking-wider">CREATIVE LAB</span>
            <div class="pro-badge">PRO</div>
        </div>

        <div class="sidebar-content">
            
            <div id="controls-image" class="lab-controls">
                <div class="form-group">
                    <div style="background: var(--bg-surface); padding: 4px; border-radius: 8px; display: flex; border: 1px solid var(--border-dim);">
                        <div class="btn-ghost active" style="flex:1; text-align:center; padding: 6px; border-radius:6px; font-size:12px; background:var(--bg-surface-hover); color:white;">Text to Image</div>
                        <div class="btn-ghost" style="flex:1; text-align:center; padding: 6px; border-radius:6px; font-size:12px;">Image to Image</div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="form-label">
                        <span>Prompt</span>
                        <button class="btn-outline" style="height: 22px; font-size: 10px; padding: 0 8px; border-radius: 100px;" onclick="SIA.open()">
                            <i class="ph ph-sparkle" style="margin-right:4px;"></i> Ask SIA
                        </button>
                    </div>
                    <textarea id="prompt-image" class="input-area" placeholder="Describe your imagination in detail... e.g. An astronaut riding a horse on Mars, cinematic lighting, 8k resolution"></textarea>
                </div>

                <div class="form-group">
                    <div class="form-label"><span>Aspect Ratio</span></div>
                    <div class="ratio-grid">
                        <div class="ratio-card active" onclick="UI.setRatio(this, '1:1')">
                            <span class="ratio-viz" style="width:16px; height:16px;"></span> 1:1
                        </div>
                        <div class="ratio-card" onclick="UI.setRatio(this, '16:9')">
                            <span class="ratio-viz" style="width:24px; height:14px;"></span> 16:9
                        </div>
                        <div class="ratio-card" onclick="UI.setRatio(this, '9:16')">
                            <span class="ratio-viz" style="width:14px; height:24px;"></span> 9:16
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="form-label"><span>Model Config</span></div>
                    <select class="input-select">
                        <option>Flux Professional (v1.0)</option>
                        <option>Midjourney V6 (Simulated)</option>
                        <option>Stable Diffusion XL</option>
                    </select>
                </div>

                <div class="form-group">
                    <div class="form-label">
                        <span>Guidance Scale</span>
                        <span id="val-guidance" class="text-muted">7.5</span>
                    </div>
                    <input type="range" min="1" max="20" step="0.5" value="7.5" oninput="document.getElementById('val-guidance').innerText=this.value">
                </div>

                <button class="btn btn-accent" style="width: 100%; height: 48px;" onclick="Engine.generate('image')">
                    <i class="ph ph-magic-wand"></i> GENERATE IMAGE
                </button>
            </div>

            <div id="controls-video" class="lab-controls hidden">
                <div class="form-group">
                    <div class="form-label"><span>Video Prompt</span></div>
                    <textarea id="prompt-video" class="input-area" placeholder="Describe motion... e.g. A drone flying over a futuristic city, slow motion, neon lights"></textarea>
                </div>

                <div class="form-group">
                    <div class="form-label"><span>Camera Motion</span></div>
                    <div class="ratio-grid" style="grid-template-columns: 1fr 1fr;">
                        <div class="ratio-card active"><i class="ph ph-video-camera"></i> Static</div>
                        <div class="ratio-card"><i class="ph ph-arrows-out-simple"></i> Zoom</div>
                        <div class="ratio-card"><i class="ph ph-arrow-right"></i> Pan</div>
                        <div class="ratio-card"><i class="ph ph-arrows-clockwise"></i> Orbit</div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="form-label"><span>Duration</span></div>
                    <input type="range" min="3" max="10" value="5">
                    <div style="display:flex; justify-content:space-between; font-size:10px; color:var(--txt-secondary);">
                        <span>3s</span><span>10s</span>
                    </div>
                </div>

                <button class="btn btn-accent" style="width: 100%; height: 48px;" onclick="Engine.generate('video')">
                    <i class="ph ph-film-strip"></i> GENERATE VIDEO
                </button>
            </div>

            <div id="controls-shortfilm" class="lab-controls hidden">
                <div class="form-group">
                    <div class="form-label">
                        <span>Storyboard</span>
                        <span>0 / 20 Shots</span>
                    </div>
                    <div class="storyboard-track" id="storyboard-track">
                        <div style="width:100%; text-align:center; font-size:11px; color:var(--txt-tertiary);">
                            Drag generated clips here
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="form-label"><span>Global Script</span></div>
                    <textarea class="input-area" placeholder="Write the narrative script here..."></textarea>
                </div>

                <button class="btn btn-primary" style="width: 100%;">
                    <i class="ph ph-play"></i> RENDER FULL FILM
                </button>
            </div>

            <div id="controls-assets" class="lab-controls hidden" style="height: 100%; display: flex; flex-direction: column;">
                <div class="assets-toolbar">
                    <div class="chip active" onclick="Assets.filter('all', this)">All</div>
                    <div class="chip" onclick="Assets.filter('image', this)">Images</div>
                    <div class="chip" onclick="Assets.filter('video', this)">Videos</div>
                    <div class="chip" onclick="Assets.filter('favorites', this)">Starred</div>
                </div>

                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 12px;">
                    <span class="text-xs font-bold text-muted uppercase">Library Content</span>
                    <div style="display:flex; gap:4px;">
                        <button class="btn-icon active" id="btn-view-grid" onclick="Assets.setView('grid')"><i class="ph ph-grid-four"></i></button>
                        <button class="btn-icon" id="btn-view-list" onclick="Assets.setView('list')"><i class="ph ph-list-dashes"></i></button>
                    </div>
                </div>

                <div id="assets-sidebar-list" class="assets-grid" style="flex: 1; overflow-y: auto;">
                    </div>
            </div>

        </div>
    </aside>

    <main class="stage">
        <header class="stage-header">
            <div style="display:flex; gap: 24px;">
                <div class="btn-ghost" style="font-weight:600; color:white; border-bottom:2px solid var(--accent-primary);">History</div>
                <div class="btn-ghost" style="font-weight:600;">Community Feed</div>
                <div class="btn-ghost" style="font-weight:600;">Favorites</div>
            </div>
            
            <div style="display:flex; align-items:center; gap: 12px;">
                <div class="text-xs font-bold text-muted">50 CREDITS LEFT</div>
                <button class="btn-primary" style="height: 32px; padding: 0 12px;">Get More</button>
            </div>
        </header>

        <div class="stage-content" id="stage-container">
            <div class="gallery-grid" id="gallery-grid">
                </div>

            <div id="empty-state" class="hidden" style="height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; opacity:0.3;">
                <i class="ph ph-image-square" style="font-size: 64px; margin-bottom: 16px;"></i>
                <div class="text-lg font-bold">Start Creating</div>
                <div class="text-sm">Your history is empty.</div>
            </div>
        </div>
    </main>

</div>

<script>
/**
 * SULANDRA CORE ENGINE
 * Handles State, DOM, Mock Data, and Simulation Logic.
 */

// 1. STATE MANAGEMENT
const STATE = {
    lab: 'image',
    history: [], // { id, type, url, prompt, timestamp, favorite }
    assetsFilter: 'all',
    assetsView: 'grid'
};

// 2. MOCK DATA GENERATOR (To fill the empty void)
function seedData() {
    const images = [
        'https://picsum.photos/seed/1/512/512', 'https://picsum.photos/seed/2/512/512',
        'https://picsum.photos/seed/3/512/512', 'https://picsum.photos/seed/4/512/512'
    ];
    const videos = [
        'https://media.istockphoto.com/id/1346563637/video/abstract-background-motion-design.jpg?s=640x640&k=20&c=6N35pL2hMvEw8qT2T2yY2y2y2y2y2y2y2y2y2y2y2y=',
        'https://media.istockphoto.com/id/1336449767/video/colorful-abstract-glowing-lines.jpg?s=640x640&k=20&c=6P4sF1aFjFv1zW2y2y2y2y2y2y2y2y2y2y2y2y2y2y='
    ];

    for(let i=0; i<12; i++) {
        const type = i % 3 === 0 ? 'video' : 'image';
        STATE.history.push({
            id: Date.now() - (i * 100000),
            type: type,
            url: type === 'image' ? images[i%images.length] : videos[i%videos.length],
            prompt: `Futuristic concept art #${i+1}, highly detailed, cinematic lighting, 8k resolution...`,
            favorite: i % 4 === 0
        });
    }
}

// 3. UI CONTROLLER
const UI = {
    setRatio: (el, ratio) => {
        document.querySelectorAll('.ratio-card').forEach(c => c.classList.remove('active'));
        el.classList.add('active');
    },
    
    toggleFav: (id) => {
        const item = STATE.history.find(x => x.id === id);
        if(item) {
            item.favorite = !item.favorite;
            Render.gallery();
            if(STATE.lab === 'assets') Render.assetsSidebar();
        }
    }
};

// 4. RENDER ENGINE
const Render = {
    gallery: () => {
        const grid = document.getElementById('gallery-grid');
        grid.innerHTML = '';
        
        STATE.history.forEach(item => {
            const card = document.createElement('div');
            card.className = `card ${item.type}`;
            card.innerHTML = `
                <img src="${item.url}" class="card-img" loading="lazy">
                <div class="card-overlay">
                    <div class="card-prompt">${item.prompt}</div>
                    <div class="card-actions">
                        <button class="btn btn-primary" style="height:28px; font-size:11px;">Download</button>
                        <button class="btn btn-ghost" style="height:28px; width:28px; padding:0; background:rgba(255,255,255,0.2); color:white;" onclick="UI.toggleFav(${item.id})">
                            <i class="ph ${item.favorite ? 'ph-star-fill' : 'ph-star'}" style="color:${item.favorite ? '#fbbf24' : 'white'}"></i>
                        </button>
                    </div>
                </div>
            `;
            grid.appendChild(card);
        });
    },

    assetsSidebar: () => {
        const list = document.getElementById('assets-sidebar-list');
        list.className = `assets-grid ${STATE.assetsView === 'list' ? 'list-mode' : ''}`;
        list.innerHTML = '';

        // Filter items
        const items = STATE.history.filter(item => {
            if(STATE.assetsFilter === 'all') return true;
            if(STATE.assetsFilter === 'favorites') return item.favorite;
            return item.type === STATE.assetsFilter;
        });

        items.forEach(item => {
            const el = document.createElement('div');
            el.className = 'asset-item';
            el.innerHTML = `
                <img src="${item.url}" class="asset-thumb">
                <div class="asset-info">
                    <div style="font-weight:600; margin-bottom:2px;">${item.type.toUpperCase()}</div>
                    ${item.prompt}
                </div>
            `;
            // Click to preview in main stage
            el.onclick = () => { 
                document.querySelectorAll('.asset-item').forEach(a => a.classList.remove('active'));
                el.classList.add('active');
            };
            list.appendChild(el);
        });
    }
};

// 5. APP CONTROLLER
const App = {
    init: () => {
        seedData();
        Render.gallery();
        // Hook up default view
        App.switchLab('image');
    },

    switchLab: (labId) => {
        STATE.lab = labId;
        
        // 1. Update Nav Icons
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        document.getElementById(`nav-${labId}`).classList.add('active');

        // 2. Show Correct Sidebar Panel
        document.querySelectorAll('.lab-controls').forEach(el => el.classList.add('hidden'));
        document.getElementById(`controls-${labId}`).classList.remove('hidden');

        // 3. Special initialization for Assets view
        if(labId === 'assets') {
            Render.assetsSidebar();
        }
    }
};

// 6. ASSETS MANAGER LOGIC
const Assets = {
    filter: (type, btn) => {
        STATE.assetsFilter = type;
        document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        Render.assetsSidebar();
    },
    setView: (view) => {
        STATE.assetsView = view;
        document.getElementById('btn-view-grid').classList.toggle('active', view === 'grid');
        document.getElementById('btn-view-list').classList.toggle('active', view === 'list');
        Render.assetsSidebar();
    }
};

// 7. GENERATION ENGINE (Mock)
const Engine = {
    generate: (type) => {
        const promptEl = type === 'image' ? document.getElementById('prompt-image') : document.getElementById('prompt-video');
        if(!promptEl.value) { alert("Please enter a prompt first."); return; }

        const btn = event.currentTarget;
        const originalText = btn.innerHTML;
        btn.innerHTML = `<div class="loader"></div> Generating...`;
        btn.disabled = true;

        // Add pending card
        const grid = document.getElementById('gallery-grid');
        const pending = document.createElement('div');
        pending.className = `card ${type === 'video' ? 'video' : ''}`;
        pending.innerHTML = `<div style="height:100%; display:flex; align-items:center; justify-content:center; background:var(--bg-surface);"><div class="loader"></div></div>`;
        grid.insertBefore(pending, grid.firstChild);

        setTimeout(() => {
            // Finish generation
            btn.innerHTML = originalText;
            btn.disabled = false;
            grid.removeChild(pending);

            const newItem = {
                id: Date.now(),
                type: type,
                url: type === 'image' ? 'https://picsum.photos/512/512' : 'https://media.istockphoto.com/id/1346563637/video/abstract-background-motion-design.jpg?s=640x640&k=20&c=6N35pL2hMvEw8qT2T2yY2y2y2y2y2y2y2y2y2y2y2y=',
                prompt: promptEl.value,
                favorite: false
            };
            STATE.history.unshift(newItem);
            Render.gallery();
            if(STATE.lab === 'assets') Render.assetsSidebar();
        }, 2000);
    }
};

// 8. ASK SIA (Mock Chat)
const SIA = {
    open: () => {
        const prompt = prompt("Ask SIA (AI Assistant) to help refine your prompt:", "Make it more cinematic");
        if(prompt) {
            const box = document.getElementById('prompt-image');
            box.value += ", cinematic lighting, 8k resolution, photorealistic, trending on artstation";
        }
    }
};

// START APP
App.init();

</script>
</body>
</html>
