<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sulandra AI Studio ‚Äì Mixer Console</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Load Tailwind CSS for flexible component styling -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --bg: #050709;
      --bg-deep: #020305;
      --panel: #101820;
      --panel-dark: #0a1219;
      --panel-soft: #141e28;
      --accent: #70ff63;
      --accent-soft: rgba(112,255,99,0.2);
      --accent-strong: #9aff8f;
      --text-main: #f2f9ff;
      --text-muted: #9eaab6;
      --border-soft: rgba(255,255,255,0.06);
      --border-strong: rgba(112,255,99,0.7);
      --radius-sm: 6px;
      --radius-md: 9px;
      --radius-lg: 12px;
      --shadow-soft: 0 0 32px rgba(0,0,0,0.85);
      --track-bg: #0d1821;
      --track-bg-alt: #0b151f;
      --grid-line: rgba(255,255,255,0.05);
      --menu-bg: #141f2c;
      /* Mixer specific */
      --fader-red: #ff3838;
      --fader-blue: #3884ff;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Inter", sans-serif;
      background: radial-gradient(circle at top left,#1b2635 0,#020305 55%,#000 100%);
      color: var(--text-main);
      display: flex;
      flex-direction: column;
      font-size: 14px; /* Default font size for better readability */
    }

    a { color: inherit; text-decoration: none; }

    /* TOP APP BAR (like FL Studio title/toolbar) - Kept from original */
    header {
      background: linear-gradient(to bottom,#141f2c,#0c141d);
      border-bottom: 1px solid var(--border-soft);
      box-shadow: 0 0 14px rgba(0,0,0,0.9);
      z-index: 20;
    }
    .app-header-inner {
      max-width: 1400px;
      margin: 0 auto;
      padding: 4px 14px 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }
    .brand-wrap {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .brand-icon {
      width: 26px;
      height: 26px;
      border-radius: 7px;
      background: radial-gradient(circle at 20% 0%,#7dff64,#28b88e);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #02110b;
      font-weight: 900;
      font-size: 15px;
      box-shadow: 0 0 15px rgba(112,255,99,0.8);
    }
    .brand-title-main {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: .12em;
    }
    .brand-title-sub {
      font-size: 10px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: .18em;
    }

    .top-nav-links {
      display: flex;
      gap: 6px;
      align-items: center;
      font-size: 11px;
      flex-wrap: wrap;
    }
    .top-nav-links a {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid transparent;
      color: var(--text-muted);
    }
    .top-nav-links a:hover {
      border-color: var(--border-soft);
      background: rgba(255,255,255,0.04);
      color: var(--text-main);
    }
    .top-nav-links a.active {
      border-color: var(--border-strong);
      color: #02110b;
      background: linear-gradient(120deg,#70ff63,#2fdcaa);
      box-shadow: 0 0 14px rgba(112,255,99,0.8);
      font-weight: 600;
    }

    .profile-pill {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 10px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: rgba(2,5,8,0.9);
    }
    .profile-pill span {
      color: var(--text-muted);
    }
    .profile-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 8px rgba(112,255,99,0.8);
    }

    /* MAIN LAYOUT */
    main {
      flex: 1;
      max-width: 1400px;
      margin: 6px auto 10px;
      padding: 0 10px 8px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    /* MENU BAR (File / Edit / etc) + TRANSPORT STRIP - Kept from original */
    .menu-transport {
      background: var(--menu-bg);
      border-radius: 7px;
      border: 1px solid var(--border-soft);
      display: flex;
      flex-direction: column;
      box-shadow: var(--shadow-soft);
      overflow: hidden;
    }

    .menu-row {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 4px 8px;
      font-size: 11px;
      border-bottom: 1px solid rgba(0,0,0,0.4);
      background: linear-gradient(to bottom,#1a2836,#121d27);
    }
    .menu-item {
      padding: 2px 6px;
      border-radius: 3px;
      cursor: default;
      color: var(--text-muted);
    }
    .menu-item:hover {
      background: rgba(255,255,255,0.06);
      color: var(--text-main);
    }

    .transport-row {
      display: grid;
      grid-template-columns: minmax(0,1.6fr) minmax(0,2.2fr) minmax(0,1.6fr);
      gap: 4px;
      padding: 4px 8px 6px;
      background: linear-gradient(to bottom,#111a23,#060b10);
      font-size: 11px;
      color: var(--text-muted);
    }
    @media (max-width: 900px) {
      .transport-row {
        grid-template-columns: minmax(0,1fr);
      }
    }

    .transport-left,
    .transport-center,
    .transport-right {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    .btn-transport {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      border: 1px solid var(--border-soft);
      background: #071016;
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: inset 0 0 5px rgba(0,0,0,0.7);
    }
    .btn-transport.green {
      background: radial-gradient(circle at 20% 0%,#70ff63,#27b87e);
      color: #02110b;
      border-color: var(--border-strong);
      box-shadow: 0 0 12px rgba(112,255,99,0.9);
    }
    .btn-transport.record {
      background: radial-gradient(circle at 20% 0%,#ff5757,#b02020);
      border-color: rgba(255,110,110,0.9);
      color: #000;
      box-shadow: 0 0 12px rgba(255,120,120,0.9);
    }

    .tempo-block,
    .snap-block,
    .pattern-block {
      padding: 2px 6px;
      border-radius: 4px;
      border: 1px solid rgba(0,0,0,0.65);
      background: #050b0f;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      color: var(--accent-strong);
      box-shadow: inset 0 0 6px rgba(0,0,0,0.9);
    }
    .tempo-value {
      font-weight: 600;
      color: var(--accent-strong);
    }
    .display-field {
      padding: 2px 6px;
      border-radius: 4px;
      border: 1px solid rgba(0,0,0,0.7);
      background: #040a10;
      min-width: 90px;
      text-align: center;
      color: #9ff792;
      box-shadow: inset 0 0 6px rgba(0,0,0,0.9);
    }

    /* NEW MIXER STYLES */
    .mixer-console {
      margin-top: 4px;
      background: radial-gradient(circle at top,#1c2734 0,#05070b 55%,#000 100%);
      border-radius: 9px;
      border: 1px solid rgba(0,0,0,0.9);
      box-shadow: var(--shadow-soft);
      min-height: 520px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    .mixer-header {
      background: linear-gradient(to bottom,#182533,#0a1017);
      border-bottom: 1px solid rgba(0,0,0,0.9);
      padding: 6px 10px;
      color: var(--accent-strong);
      font-weight: 600;
      font-size: 12px;
    }
    .mixer-strip-container {
      flex: 1;
      overflow-x: auto;
      overflow-y: hidden;
      display: flex;
      padding: 10px 8px;
    }
    .mixer-strip {
      width: 120px;
      min-width: 120px;
      background: #0d161d;
      border-radius: 6px;
      margin-right: 8px;
      border: 1px solid rgba(0,0,0,0.5);
      box-shadow: inset 0 0 5px rgba(0,0,0,0.9);
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      position: relative;
    }
    .mixer-strip-master {
      min-width: 150px;
      width: 150px;
      background: #0e0717; /* Master track distinct background */
      border-color: var(--fader-red);
      box-shadow: 0 0 10px rgba(255,56,56,0.3), inset 0 0 5px rgba(0,0,0,0.9);
    }

    /* Plugin Slots */
    .plugin-slots {
      height: 140px;
      padding: 4px;
      display: flex;
      flex-direction: column;
      gap: 3px;
      background: #090f15;
      border-radius: 5px 5px 0 0;
      border-bottom: 1px solid rgba(0,0,0,0.5);
    }
    .plugin-slot {
      height: 18px;
      border-radius: 3px;
      background: #192430;
      border: 1px solid rgba(0,0,0,0.8);
      color: var(--text-muted);
      font-size: 9px;
      display: flex;
      align-items: center;
      padding-left: 5px;
      cursor: pointer;
      transition: background 0.1s ease;
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
    }
    .plugin-slot:hover {
      background: #253342;
      color: var(--text-main);
    }
    .plugin-slot.active {
      background: var(--fader-blue);
      color: #000;
      font-weight: 600;
      box-shadow: 0 0 8px rgba(56,132,255,0.7);
    }

    /* Fader and Knob Area */
    .fader-area {
      padding: 6px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      flex: 1;
      justify-content: space-between;
    }
    .knob-wrapper {
      position: relative;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .knob {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: linear-gradient(135deg, #2c3a47, #1c2734);
      border: 2px solid #3c4a5c;
      box-shadow: inset 0 0 5px rgba(0,0,0,0.9), 0 2px 5px rgba(0,0,0,0.5);
      cursor: grab;
      position: relative;
    }
    .knob-marker {
      position: absolute;
      width: 2px;
      height: 10px;
      background: var(--accent);
      top: 5px;
      left: 50%;
      transform: translateX(-50%) rotate(45deg); /* Initial position for visual effect */
      transform-origin: bottom center;
      transition: transform 0.05s linear;
    }

    /* LED Meter */
    .meter {
      width: 18px;
      height: 120px;
      background: #000;
      border-radius: 3px;
      border: 1px solid #1a242c;
      padding: 2px;
      display: flex;
      flex-direction: column-reverse;
      box-shadow: inset 0 0 3px rgba(0,0,0,0.8);
    }
    .meter-bar {
      width: 100%;
      background: linear-gradient(to top, var(--accent), #ffcc00, var(--fader-red));
      height: 0%; /* Controlled by JS */
      border-radius: 1px;
      transition: height 0.05s ease-out;
    }

    /* Fader Rail */
    .fader-rail {
      width: 100%;
      height: 150px;
      background: #131d25;
      border-radius: 4px;
      border: 1px solid #1c2734;
      position: relative;
      padding: 0 4px;
    }
    .fader-cap {
      width: 20px;
      height: 8px;
      background: var(--fader-blue);
      border-radius: 2px;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: 75px; /* Mid-point */
      cursor: ns-resize;
      box-shadow: 0 0 8px rgba(56,132,255,0.7);
    }
    .mixer-strip-master .fader-cap {
      background: var(--fader-red);
      box-shadow: 0 0 8px rgba(255,56,56,0.7);
    }

    /* Mute/Solo/Track Name */
    .track-controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding-bottom: 6px;
      font-size: 10px;
    }
    .btn-control {
      width: 24px;
      height: 24px;
      border-radius: 3px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-weight: 700;
      color: #3b4c5c;
      border: 1px solid #1c2734;
      background: #111a22;
      box-shadow: inset 0 0 3px rgba(0,0,0,0.7);
    }
    .btn-control.mute.active {
      background: var(--fader-red);
      color: #000;
      box-shadow: 0 0 8px rgba(255,56,56,0.7);
    }
    .btn-control.solo.active {
      background: #ffcc00;
      color: #000;
      box-shadow: 0 0 8px rgba(255,204,0,0.7);
    }
    .track-label {
      text-align: center;
      padding: 0 4px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 3px;
      font-weight: 600;
      color: var(--text-main);
      background: #192430;
      border: 1px solid #1c2734;
      width: 100%;
      text-transform: uppercase;
      font-size: 10px;
    }
    .mixer-strip-master .track-label {
      background: #4a1f1f;
      color: var(--fader-red);
    }
  </style>
</head>
<body>
<header>
  <div class="app-header-inner">
    <div class="brand-wrap">
      <div class="brand-icon">S</div>
      <div>
        <div class="brand-title-main">Sulandra AI Studio</div>
        <!-- Updated sub-title to reflect Mixer view -->
        <div class="brand-title-sub">Sound ¬∑ Mixer Console</div>
      </div>
    </div>
    <nav class="top-nav-links">
      <a href="index.html">Home</a>
      <a href="image.html">Image Lab</a>
      <a href="video.html">Video Lab</a>
      <a href="music.html">Music Lab</a>
      <a href="film.html">Film Lab</a>
      <a href="explore.html">Explore</a>
      <a href="studio.html">Studio</a>
      <!-- Link back to the imaginary Playlist/DAW view -->
      <a href="sound.html">Sound DAW</a>
      <a href="#" class="active">Mixer</a>
    </nav>
    <div class="profile-pill">
      <div class="profile-dot"></div>
      <span>Project: <strong>We Need A Miracle</strong></span>
    </div>
  </div>
</header>

<main>
  <!-- MENU + TRANSPORT, KEPT FROM ORIGINAL -->
  <section class="menu-transport">
    <div class="menu-row">
      <div class="menu-item">File</div>
      <div class="menu-item">Edit</div>
      <div class="menu-item">View</div>
      <div class="menu-item">Mixer Options</div>
      <div class="menu-item">Routing</div>
      <div class="menu-item">Tools</div>
      <div class="menu-item">Help</div>
    </div>
    <div class="transport-row">
      <div class="transport-left">
        <button class="btn-transport">‚èÆ</button>
        <button class="btn-transport green">‚ñ∂</button>
        <button class="btn-transport">‚èπ</button>
        <button class="btn-transport">‚è≠</button>
        <button class="btn-transport">üîÑ</button>
        <div class="pattern-block">
          <span>PAT</span>
          <span>Pattern 1</span>
        </div>
      </div>

      <div class="transport-center">
        <div class="tempo-block">
          <span>Tempo</span>
          <span class="tempo-value">130.000</span>
          <span>BPM</span>
        </div>
        <div class="display-field">4:00:00</div>
        <div class="snap-block">
          <span>Snap:</span>
          <span>Line</span>
        </div>
        <div class="snap-block">
          <span>Song</span>
        </div>
        <div class="snap-block">
          <span>Loop</span>
        </div>
      </div>

      <div class="transport-right">
        <button class="btn-transport record">‚óè</button>
        <span>CPU 7%</span>
        <span>|</span>
        <span>408 MB</span>
      </div>
    </div>
  </section>

  <!-- MIXER CONSOLE -->
  <section class="mixer-console">
    <div class="mixer-header">
      MIXER TRACKS
    </div>
    <div class="mixer-strip-container" id="mixerContainer">
      <!-- Master Strip (Always first) -->
      <div class="mixer-strip mixer-strip-master" data-track-id="0">
        <div class="plugin-slots">
          <div class="plugin-slot active">Maximus (Limiter)</div>
          <div class="plugin-slot">Fruity Parametric EQ 2</div>
          <div class="plugin-slot">Fruity Soft Clipper</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
        </div>
        <div class="fader-area">
          <div class="knob-wrapper">
            <div class="knob">
              <div class="knob-marker" data-knob-angle="90"></div>
            </div>
          </div>
          <div class="meter">
            <div class="meter-bar" style="height: 60%;" data-meter-level="60"></div>
          </div>
          <div class="fader-rail">
            <div class="fader-cap" data-fader-pos="75"></div>
          </div>
        </div>
        <div class="track-controls">
          <div class="btn-control solo">S</div>
          <div class="track-label">MASTER</div>
          <div class="text-xs text-text-muted">Send to: None</div>
        </div>
      </div>

      <!-- Insert Strip Template (Tracks 1-10) -->
      <!-- Track 1 - Kick -->
      <div class="mixer-strip" data-track-id="1">
        <div class="plugin-slots">
          <div class="plugin-slot active">Fruity Limiter</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
        </div>
        <div class="fader-area">
          <div class="knob-wrapper">
            <div class="knob">
              <div class="knob-marker" data-knob-angle="135"></div>
            </div>
          </div>
          <div class="meter">
            <div class="meter-bar" style="height: 75%;" data-meter-level="75"></div>
          </div>
          <div class="fader-rail">
            <div class="fader-cap" data-fader-pos="60"></div>
          </div>
        </div>
        <div class="track-controls">
          <div class="btn-control mute">M</div>
          <div class="btn-control solo">S</div>
          <div class="track-label">KICK DRUM</div>
          <div class="text-xs text-text-muted">Send to: Master</div>
        </div>
      </div>

      <!-- Track 2 - Snare -->
      <div class="mixer-strip" data-track-id="2">
        <div class="plugin-slots">
          <div class="plugin-slot">Fruity Reeverb</div>
          <div class="plugin-slot active">Fruity Compressor</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
        </div>
        <div class="fader-area">
          <div class="knob-wrapper">
            <div class="knob">
              <div class="knob-marker" data-knob-angle="225"></div>
            </div>
          </div>
          <div class="meter">
            <div class="meter-bar" style="height: 68%;" data-meter-level="68"></div>
          </div>
          <div class="fader-rail">
            <div class="fader-cap" data-fader-pos="70"></div>
          </div>
        </div>
        <div class="track-controls">
          <div class="btn-control mute">M</div>
          <div class="btn-control solo">S</div>
          <div class="track-label">SNARE</div>
          <div class="text-xs text-text-muted">Send to: Master</div>
        </div>
      </div>
      
      <!-- Track 3 - Hi-Hat (Muted) -->
      <div class="mixer-strip" data-track-id="3">
        <div class="plugin-slots">
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
        </div>
        <div class="fader-area">
          <div class="knob-wrapper">
            <div class="knob">
              <div class="knob-marker" data-knob-angle="45"></div>
            </div>
          </div>
          <div class="meter">
            <div class="meter-bar" style="height: 0%;" data-meter-level="0"></div>
          </div>
          <div class="fader-rail">
            <div class="fader-cap" data-fader-pos="140"></div>
          </div>
        </div>
        <div class="track-controls">
          <div class="btn-control mute active">M</div>
          <div class="btn-control solo">S</div>
          <div class="track-label">HI-HATS</div>
          <div class="text-xs text-text-muted">Send to: Master</div>
        </div>
      </div>

      <!-- Track 4 - Bassline (Soloed) -->
      <div class="mixer-strip" data-track-id="4">
        <div class="plugin-slots">
          <div class="plugin-slot active">Harmor (Synth)</div>
          <div class="plugin-slot active">Compressor 2</div>
          <div class="plugin-slot active">Saturation</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
        </div>
        <div class="fader-area">
          <div class="knob-wrapper">
            <div class="knob">
              <div class="knob-marker" data-knob-angle="90"></div>
            </div>
          </div>
          <div class="meter">
            <div class="meter-bar" style="height: 55%;" data-meter-level="55"></div>
          </div>
          <div class="fader-rail">
            <div class="fader-cap" data-fader-pos="80"></div>
          </div>
        </div>
        <div class="track-controls">
          <div class="btn-control mute">M</div>
          <div class="btn-control solo active">S</div>
          <div class="track-label">BASSLINE</div>
          <div class="text-xs text-text-muted">Send to: Master</div>
        </div>
      </div>

      <!-- Track 5 - Lead Synth -->
      <div class="mixer-strip" data-track-id="5">
        <div class="plugin-slots">
          <div class="plugin-slot active">Sytrus (Synth)</div>
          <div class="plugin-slot active">Delay 3</div>
          <div class="plugin-slot active">Reverb 2</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
        </div>
        <div class="fader-area">
          <div class="knob-wrapper">
            <div class="knob">
              <div class="knob-marker" data-knob-angle="180"></div>
            </div>
          </div>
          <div class="meter">
            <div class="meter-bar" style="height: 85%;" data-meter-level="85"></div>
          </div>
          <div class="fader-rail">
            <div class="fader-cap" data-fader-pos="45"></div>
          </div>
        </div>
        <div class="track-controls">
          <div class="btn-control mute">M</div>
          <div class="btn-control solo">S</div>
          <div class="track-label">LEAD SYNTH</div>
          <div class="text-xs text-text-muted">Send to: Master</div>
        </div>
      </div>

      <!-- Track 6 - Pad -->
      <div class="mixer-strip" data-track-id="6">
        <div class="plugin-slots">
          <div class="plugin-slot active">FLEX (Pad)</div>
          <div class="plugin-slot active">Gross Beat</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
        </div>
        <div class="fader-area">
          <div class="knob-wrapper">
            <div class="knob">
              <div class="knob-marker" data-knob-angle="0"></div>
            </div>
          </div>
          <div class="meter">
            <div class="meter-bar" style="height: 40%;" data-meter-level="40"></div>
          </div>
          <div class="fader-rail">
            <div class="fader-cap" data-fader-pos="90"></div>
          </div>
        </div>
        <div class="track-controls">
          <div class="btn-control mute">M</div>
          <div class="btn-control solo">S</div>
          <div class="track-label">PAD</div>
          <div class="text-xs text-text-muted">Send to: Master</div>
        </div>
      </div>

      <!-- Track 7 - FX (Delay Return) -->
      <div class="mixer-strip" data-track-id="7">
        <div class="plugin-slots">
          <div class="plugin-slot active">Delay 3 (Send)</div>
          <div class="plugin-slot active">Fruity Filter</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
        </div>
        <div class="fader-area">
          <div class="knob-wrapper">
            <div class="knob">
              <div class="knob-marker" data-knob-angle="90"></div>
            </div>
          </div>
          <div class="meter">
            <div class="meter-bar" style="height: 30%;" data-meter-level="30"></div>
          </div>
          <div class="fader-rail">
            <div class="fader-cap" data-fader-pos="100"></div>
          </div>
        </div>
        <div class="track-controls">
          <div class="btn-control mute">M</div>
          <div class="btn-control solo">S</div>
          <div class="track-label">FX DELAY</div>
          <div class="text-xs text-text-muted">Send to: Master</div>
        </div>
      </div>

      <!-- Add Track Button -->
      <div class="flex flex-col items-center justify-center p-4">
        <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full text-xs shadow-lg transition duration-150 ease-in-out transform hover:scale-105" onclick="addNewTrack()">
          + ADD TRACK
        </button>
      </div>

    </div>
  </section>

  <!-- FOOTER HINTS -->
  <section class="hint-bar">
    <span>Click the <span class="key">plugin slots</span> to open or insert a new effect.</span>
    <span>Use <span class="key">M / S</span> buttons to Mute or Solo individual tracks.</span>
    <span>Knobs control <span class="key">Pan/Stereo Position</span>. Faders control <span class="key">Volume</span>.</span>
  </section>
</main>

<script>
  // --- UTILITY FUNCTIONS ---

  // Function to create a new, functional mixer strip (Insert Track)
  const createMixerStrip = (trackId, trackName, meterLevel, faderPos, panAngle) => {
    return `
      <div class="mixer-strip" data-track-id="${trackId}">
        <div class="plugin-slots">
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
          <div class="plugin-slot">+ Insert Effect Slot</div>
        </div>
        <div class="fader-area">
          <div class="knob-wrapper">
            <div class="knob">
              <div class="knob-marker" data-knob-angle="${panAngle}"></div>
            </div>
          </div>
          <div class="meter">
            <div class="meter-bar" style="height: ${meterLevel}%;" data-meter-level="${meterLevel}"></div>
          </div>
          <div class="fader-rail">
            <div class="fader-cap" data-fader-pos="${faderPos}"></div>
          </div>
        </div>
        <div class="track-controls">
          <div class="btn-control mute">M</div>
          <div class="btn-control solo">S</div>
          <div class="track-label">${trackName}</div>
          <div class="text-xs text-text-muted">Send to: Master</div>
        </div>
      </div>
    `;
  };

  // Function to calculate rotation from pan angle
  const getKnobRotationStyle = (angle) => {
    // Convert 0-360 angle to CSS rotation (0deg is top)
    // We adjust it so that the initial marker position (45deg offset) is taken into account
    return `transform: translateX(-50%) rotate(${angle - 90}deg);`;
  };

  // Function to calculate fader position (0px is bottom, 142px is top)
  const getFaderPositionStyle = (position) => {
    // Position 0 is top, 142 is bottom (inverted for visual DAW faders)
    return `bottom: ${position}px;`;
  };

  // --- CORE INTERACTIVITY ---

  const initMixerControls = () => {
    // 1. Initialize Knob Markers
    document.querySelectorAll('.knob-marker').forEach(marker => {
      const angle = parseFloat(marker.dataset.knobAngle);
      marker.style.cssText = getKnobRotationStyle(angle);
    });

    // 2. Initialize Fader Caps
    document.querySelectorAll('.fader-cap').forEach(fader => {
      const pos = parseFloat(fader.dataset.faderPos);
      fader.style.cssText = getFaderPositionStyle(pos);
    });

    // 3. Setup Mute/Solo Toggles
    document.querySelectorAll('.btn-control').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.currentTarget.classList.toggle('active');

        // Logic for Solo: If a track is soloed, mute all others (except Master, which is controlled externally)
        if (e.currentTarget.classList.contains('solo') && e.currentTarget.classList.contains('active')) {
          document.querySelectorAll('.btn-control.solo').forEach(otherSoloBtn => {
            if (otherSoloBtn !== e.currentTarget) {
              otherSoloBtn.classList.remove('active');
            }
          });
          document.querySelectorAll('.btn-control.mute').forEach(muteBtn => {
            muteBtn.classList.add('active');
          });
          // Unmute the soloed track's mute button
          e.currentTarget.closest('.track-controls').querySelector('.mute').classList.remove('active');
        } else if (e.currentTarget.classList.contains('mute')) {
          // If unmuting a track, unslo all other tracks and unmute everything.
          if (!e.currentTarget.classList.contains('active')) {
             // If we are unmuting, make sure solo is off
             e.currentTarget.closest('.track-controls').querySelector('.solo').classList.remove('active');
          }
        }
      });
    });

    // 4. Implement simple Knob Dragging (Pan control)
    document.querySelectorAll('.knob').forEach(knob => {
      const marker = knob.querySelector('.knob-marker');
      let isDragging = false;
      let startY = 0;
      let startAngle = 0;

      knob.addEventListener('mousedown', (e) => {
        isDragging = true;
        knob.style.cursor = 'grabbing';
        startY = e.clientY;
        startAngle = parseFloat(marker.dataset.knobAngle || 0);
        e.preventDefault();
      });

      document.addEventListener('mousemove', (e) => {
        if (!isDragging) return;

        const deltaY = startY - e.clientY;
        // Simple linear mapping: 1px movement = 0.5 degree change
        let newAngle = startAngle + deltaY * 0.5;

        // Clamp the angle (0 to 360 degrees)
        if (newAngle > 360) newAngle -= 360;
        if (newAngle < 0) newAngle += 360;

        marker.dataset.knobAngle = newAngle.toFixed(2);
        marker.style.cssText = getKnobRotationStyle(newAngle);
      });

      document.addEventListener('mouseup', () => {
        if (isDragging) {
          isDragging = false;
          knob.style.cursor = 'grab';
        }
      });
    });

    // 5. Implement simple Fader Dragging (Volume control)
    document.querySelectorAll('.fader-cap').forEach(fader => {
      let isDragging = false;
      let startY = 0;
      let startPos = 0;

      fader.addEventListener('mousedown', (e) => {
        isDragging = true;
        startY = e.clientY;
        startPos = parseFloat(fader.dataset.faderPos || 0);
        e.preventDefault();
      });

      document.addEventListener('mousemove', (e) => {
        if (!isDragging) return;

        const deltaY = startY - e.clientY;
        let newPos = startPos + deltaY;

        // Clamp the position (0px is bottom, approx 142px is top)
        newPos = Math.max(0, Math.min(142, newPos));

        fader.dataset.faderPos = newPos.toFixed(0);
        fader.style.cssText = getFaderPositionStyle(newPos);
      });

      document.addEventListener('mouseup', () => {
        isDragging = false;
      });
    });

    // 6. Animate Metering (Simulated)
    const meterInterval = setInterval(() => {
      document.querySelectorAll('.meter-bar').forEach(bar => {
        const currentLevel = parseInt(bar.dataset.meterLevel, 10);
        // Simulate level fluctuation: -5 to +5 difference
        const fluctuation = Math.floor(Math.random() * 11) - 5;
        let newLevel = Math.max(0, Math.min(100, currentLevel + fluctuation));

        // Tracks 3 (Hi-Hats) is muted, so keep it at 0
        const trackStrip = bar.closest('.mixer-strip');
        if (trackStrip && trackStrip.dataset.trackId === '3' || trackStrip.querySelector('.mute')?.classList.contains('active')) {
             newLevel = 0;
        }

        bar.dataset.meterLevel = newLevel;
        bar.style.height = `${newLevel}%`;

        // Highlight clipping for Master track (>90%)
        if (trackStrip.classList.contains('mixer-strip-master') && newLevel > 90) {
           bar.style.backgroundColor = 'red';
           bar.style.boxShadow = '0 0 5px red';
        } else {
           bar.style.backgroundColor = '';
           bar.style.boxShadow = '';
        }

      });
    }, 100); // Update every 100ms
  };

  // Function to add a new track dynamically
  let trackCounter = 8;
  window.addNewTrack = () => {
    const container = document.getElementById('mixerContainer');
    const newTrackId = trackCounter++;
    const randomLevel = Math.floor(Math.random() * 60) + 20; // 20% to 80%
    const randomFader = Math.floor(Math.random() * 100) + 40; // 40px to 140px
    const randomPan = Math.floor(Math.random() * 360); // 0 to 360 degrees
    const newStripHTML = createMixerStrip(newTrackId, `INSERT ${newTrackId}`, randomLevel, randomFader, randomPan);

    // Find the position of the last existing strip (before the 'Add Track' button)
    const lastStrip = container.querySelector('.mixer-strip:last-of-type');
    lastStrip.insertAdjacentHTML('afterend', newStripHTML);

    // Re-initialize controls to include the new strip
    initMixerControls();
    
    // Scroll to show the new track
    container.scrollLeft = container.scrollWidth;
  };


  // Start initialization when the DOM is ready
  window.addEventListener('load', initMixerControls);

</script>
</body>
</html>
