<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sound Lab ‚Äì SL DAW</title>
  <style>
    :root {
      /* THEME VARIABLES */
      --sl-bg-main: #1e1f23;
      --sl-bg-toolbar: #26272c;
      --sl-bg-panel: #23242a;
      --sl-bg-panel-alt: #1a1b1f;
      --sl-bg-track-alt: #262830;
      --sl-border: #3a3b42;
      --sl-border-strong: #4a4c56;
      --sl-text-main: #e4e4e8;
      --sl-text-muted: #a0a1aa;
      --sl-accent: #4fa8ff;
      --sl-accent-soft: rgba(79, 168, 255, 0.1);
      --sl-danger: #ff4b6b;
      --sl-scroll-track: #18191d;
      --sl-scroll-thumb: #3b3d46;

      --sl-timeline-bg: #181920;
      --sl-timeline-row-alt: #1f2028;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background-color: var(--sl-bg-main);
      color: var(--sl-text-main);
      user-select: none;
      overflow: hidden;
    }

    /* ===== TOOLBAR ===== */
    #toolbar {
      height: 44px;
      background-color: var(--sl-bg-toolbar);
      border-bottom: 1px solid var(--sl-border-strong);
      display: flex;
      align-items: center;
      padding: 0 10px;
      gap: 10px;
    }

    .sl-logo {
      font-weight: 700;
      letter-spacing: 0.08em;
      font-size: 13px;
      color: #ffffff;
    }

    .toolbar-section {
      display: flex;
      align-items: center;
      gap: 6px;
      border-right: 1px solid var(--sl-border);
      padding-right: 10px;
      margin-right: 10px;
    }

    .transport-btn {
      border: none;
      background: #33343c;
      color: var(--sl-text-main);
      width: 26px;
      height: 26px;
      border-radius: 4px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      cursor: pointer;
    }

    .transport-btn.play {
      background: var(--sl-accent);
      color: #fff;
      font-weight: 700;
    }

    .transport-btn:hover {
      background: #40424c;
    }

    .toolbar-label {
      font-size: 11px;
      text-transform: uppercase;
      color: var(--sl-text-muted);
    }

    .toolbar-value {
      font-size: 12px;
      background: #30323a;
      padding: 3px 6px;
      border-radius: 3px;
      min-width: 50px;
      text-align: center;
    }

    .toolbar-select {
      background: #30323a;
      border-radius: 4px;
      border: 1px solid var(--sl-border);
      font-size: 12px;
      color: var(--sl-text-main);
      padding: 3px 6px;
    }

    .toolbar-spacer {
      flex: 1;
    }

    /* ===== MAIN LAYOUT ===== */
    #main-layout {
      display: grid;
      grid-template-columns: 260px minmax(0, 1fr);
      height: calc(100vh - 44px);
      background: var(--sl-bg-main);
    }

    /* ===== TRACK PANEL ===== */
    #tracks-panel {
      background: var(--sl-bg-panel);
      border-right: 1px solid var(--sl-border-strong);
      display: flex;
      flex-direction: column;
    }

    #tracks-header {
      height: 34px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 8px;
      font-size: 11px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--sl-text-muted);
      border-bottom: 1px solid var(--sl-border);
      background: var(--sl-bg-panel-alt);
    }

    #add-track-btn {
      border: none;
      background: #33343c;
      color: var(--sl-text-main);
      font-size: 16px;
      width: 20px;
      height: 20px;
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #add-track-btn:hover {
      background: #40424c;
    }

    #track-list {
      flex: 1;
      overflow-y: auto;
    }

    #track-list::-webkit-scrollbar {
      width: 8px;
    }

    #track-list::-webkit-scrollbar-track {
      background: var(--sl-scroll-track);
    }

    #track-list::-webkit-scrollbar-thumb {
      background: var(--sl-scroll-thumb);
      border-radius: 4px;
    }

    .track-row {
      display: flex;
      align-items: center;
      padding: 4px 6px;
      gap: 6px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.2);
      background: var(--sl-bg-panel);
      cursor: pointer;
    }

    .track-row:nth-child(2n) {
      background: var(--sl-bg-track-alt);
    }

    .track-row.active {
      background: rgba(79, 168, 255, 0.08);
      outline: 1px solid var(--sl-accent-soft);
    }

    .track-color-dot {
      width: 10px;
      height: 24px;
      border-radius: 2px;
      background: #ff7b7b;
      flex-shrink: 0;
    }

    .track-icon {
      width: 22px;
      height: 22px;
      border-radius: 4px;
      background: #30323a;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      color: var(--sl-text-main);
      flex-shrink: 0;
    }

    .track-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .track-name-line {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .track-name {
      font-size: 12px;
      font-weight: 500;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .track-type-label {
      font-size: 10px;
      text-transform: uppercase;
      color: var(--sl-text-muted);
    }

    .track-controls {
      display: flex;
      align-items: center;
      gap: 3px;
      margin-top: 2px;
    }

    .track-btn {
      border: none;
      background: #343640;
      color: var(--sl-text-main);
      font-size: 10px;
      padding: 1px 4px;
      border-radius: 3px;
      cursor: pointer;
      min-width: 16px;
      height: 16px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .track-btn:hover {
      background: #40424c;
    }

    .track-btn.mute.active {
      background: #ffb34b;
      color: #1a1b1f;
    }

    .track-btn.solo.active {
      background: var(--sl-accent);
      color: #fff;
    }

    .track-btn.rec {
      color: var(--sl-danger);
      border: 1px solid var(--sl-danger);
      border-radius: 100px;
      font-size: 11px;
      padding: 0 6px;
    }

    .track-btn.rec.active {
      background: var(--sl-danger);
      color: #fff;
    }

    .track-options-btn {
      font-size: 14px;
      padding: 0 4px;
    }

    /* ===== TIMELINE PANEL ===== */
    #timeline-panel {
      display: flex;
      flex-direction: column;
      background: var(--sl-timeline-bg);
    }

    #timeline-header {
      height: 34px;
      border-bottom: 1px solid var(--sl-border-strong);
      display: flex;
      align-items: center;
      padding: 0 8px;
      font-size: 11px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--sl-text-muted);
      background: #202129;
    }

    #timeline-grid {
      flex: 1;
      overflow: auto;
      position: relative;
    }

    #timeline-grid::-webkit-scrollbar {
      height: 8px;
      width: 8px;
    }

    #timeline-grid::-webkit-scrollbar-track {
      background: var(--sl-scroll-track);
    }

    #timeline-grid::-webkit-scrollbar-thumb {
      background: var(--sl-scroll-thumb);
      border-radius: 4px;
    }

    .timeline-row {
      position: relative;
      height: 36px;
      border-bottom: 1px solid #111218;
      background: var(--sl-timeline-bg);
    }

    .timeline-row:nth-child(2n) {
      background: var(--sl-timeline-row-alt);
    }

    .timeline-beats {
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      background-image: linear-gradient(
        to right,
        rgba(255, 255, 255, 0.06) 1px,
        transparent 1px
      );
      background-size: 40px 100%;
      pointer-events: none;
      opacity: 0.6;
    }

    .timeline-clip {
      position: absolute;
      top: 4px;
      height: 28px;
      border-radius: 4px;
      background: rgba(79, 168, 255, 0.25);
      border: 1px solid rgba(79, 168, 255, 0.7);
      font-size: 10px;
      padding: 2px 5px;
      color: #eaf4ff;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    /* ===== FLOATING TRACK TYPE MENU ===== */
    .floating-menu {
      position: fixed;
      min-width: 230px;
      background: #2a2b33;
      border-radius: 6px;
      border: 1px solid var(--sl-border-strong);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
      z-index: 1000;
      padding: 6px 0;
      font-size: 12px;
    }

    .floating-menu.hidden {
      display: none;
    }

    .track-type-menu-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--sl-text-muted);
      padding: 4px 10px 3px;
      border-bottom: 1px solid var(--sl-border);
      margin-bottom: 4px;
    }

    .track-type-menu-section-label {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--sl-text-muted);
      padding: 4px 10px 2px;
      margin-top: 4px;
    }

    .track-type-menu-item {
      padding: 5px 10px;
      display: flex;
      flex-direction: column;
      gap: 1px;
      cursor: pointer;
    }

    .track-type-menu-item span:first-child {
      font-size: 12px;
      color: var(--sl-text-main);
    }

    .track-type-menu-item span:last-child {
      font-size: 10px;
      color: var(--sl-text-muted);
    }

    .track-type-menu-item:hover {
      background: rgba(79, 168, 255, 0.15);
    }

    .track-type-menu-item-accent {
      background: linear-gradient(90deg, #ff6bb8, #ffb04b);
      color: #1a1b1f;
      margin-top: 4px;
    }

    .track-type-menu-item-accent span:first-child {
      color: #1a1b1f;
      font-weight: 600;
    }

    .track-type-menu-item-accent span:last-child {
      color: #2d1a10;
      font-weight: 500;
    }

    .track-type-menu-item-accent:hover {
      filter: brightness(1.06);
    }

    /* ===== OVERLAY WINDOWS (SL ASSISTANT, TRACK SETTINGS, RECORD) ===== */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.55);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1100;
    }

    .overlay.hidden {
      display: none;
    }

    .overlay-window {
      width: 520px;
      max-width: calc(100vw - 40px);
      max-height: calc(100vh - 60px);
      background: radial-gradient(circle at top left, #3d2b5c, #13141a 65%);
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.8);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .overlay-window.basic-window {
      background: #252631;
    }

    .overlay-header {
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 14px;
      background: rgba(0, 0, 0, 0.25);
      border-bottom: 1px solid rgba(255, 255, 255, 0.06);
    }

    .overlay-title {
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .overlay-close-btn {
      border: none;
      background: transparent;
      color: #ffffffcc;
      font-size: 18px;
      cursor: pointer;
    }

    .overlay-body {
      padding: 12px 16px 14px;
      overflow: auto;
      font-size: 12px;
    }

    .overlay-body::-webkit-scrollbar {
      width: 8px;
    }

    .overlay-body::-webkit-scrollbar-thumb {
      background: var(--sl-scroll-thumb);
      border-radius: 4px;
    }

    .overlay-row {
      margin-bottom: 8px;
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .overlay-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--sl-text-muted);
    }

    .overlay-input,
    .overlay-select,
    .overlay-textarea {
      background: rgba(0, 0, 0, 0.35);
      border-radius: 5px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      color: #f5f5f7;
      font-size: 12px;
      padding: 6px 8px;
      resize: vertical;
      min-height: 0;
    }

    .overlay-textarea {
      min-height: 60px;
    }

    .overlay-footer {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      padding-top: 6px;
      border-top: 1px solid rgba(255, 255, 255, 0.08);
      margin-top: 6px;
    }

    .overlay-btn {
      border: none;
      border-radius: 6px;
      font-size: 12px;
      padding: 6px 12px;
      cursor: pointer;
    }

    .overlay-btn.primary {
      background: linear-gradient(90deg, #4fa8ff, #8f6bff);
      color: white;
      font-weight: 600;
    }

    .overlay-btn.secondary {
      background: #2f3038;
      color: var(--sl-text-main);
      border: 1px solid var(--sl-border);
    }

    .overlay-pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 4px;
    }

    .overlay-pill {
      font-size: 11px;
      padding: 3px 7px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.35);
      border: 1px solid rgba(255, 255, 255, 0.14);
      cursor: pointer;
    }

    .overlay-pill.active {
      background: rgba(255, 255, 255, 0.16);
      border-color: #ffffffaa;
    }

    /* Track settings color picker line */
    .color-row {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .color-row input[type="color"] {
      border: none;
      background: transparent;
      padding: 0;
      width: 28px;
      height: 20px;
      cursor: pointer;
    }

    .color-preview {
      flex: 1;
      height: 18px;
      border-radius: 5px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
  </style>
</head>
<body>
  <!-- ===== TOOLBAR ===== -->
  <div id="toolbar">
    <div class="sl-logo">SOUND LAB</div>

    <div class="toolbar-section">
      <button class="transport-btn">&#x23EE;</button>
      <button class="transport-btn">&#x23F8;</button>
      <button class="transport-btn play">&#x25B6;</button>
      <button class="transport-btn">&#x23ED;</button>
    </div>

    <div class="toolbar-section">
      <div class="toolbar-label">Tempo</div>
      <div class="toolbar-value" id="tempo-display">120.0</div>
    </div>

    <div class="toolbar-section">
      <div class="toolbar-label">Theme</div>
      <select id="theme-select" class="toolbar-select">
        <option value="sl-dark-gray">SL Dark Gray (Default)</option>
        <option value="sl-midnight">SL Midnight Neon</option>
        <option value="sl-sunset">SL Sunset Glow</option>
        <option value="sl-oceanic">SL Oceanic Blue</option>
        <option value="sl-emerald">SL Emerald Studio</option>
        <option value="sl-mono">SL Mono Minimal</option>
      </select>
    </div>

    <div class="toolbar-spacer"></div>
  </div>

  <!-- ===== MAIN LAYOUT ===== -->
  <div id="main-layout">
    <!-- TRACKS PANEL -->
    <div id="tracks-panel">
      <div id="tracks-header">
        <span>Tracks</span>
        <button id="add-track-btn">+</button>
      </div>
      <div id="track-list"></div>
    </div>

    <!-- TIMELINE PANEL -->
    <div id="timeline-panel">
      <div id="timeline-header">Timeline</div>
      <div id="timeline-grid"></div>
    </div>
  </div>

  <!-- TRACK TYPE MENU -->
  <div class="floating-menu hidden" id="track-type-menu">
    <div class="track-type-menu-title">Track Type & Source</div>

    <div class="track-type-menu-section-label">Instruments</div>
    <div class="track-type-menu-item" data-action="instrument" data-name="Drum Kit" data-icon="ü•Å" data-color="#ff7b7b">
      <span>Drum Kit</span><span>Punchy drums & perc</span>
    </div>
    <div class="track-type-menu-item" data-action="instrument" data-name="Bass Synth" data-icon="üåÄ" data-color="#7bffb5">
      <span>Bass Synth</span><span>Deep futuristic low end</span>
    </div>
    <div class="track-type-menu-item" data-action="instrument" data-name="Poly Keys" data-icon="üéπ" data-color="#7b9dff">
      <span>Poly Keys</span><span>Electric pianos & keys</span>
    </div>
    <div class="track-type-menu-item" data-action="instrument" data-name="Atmos Pad" data-icon="‚òÅÔ∏è" data-color="#c77bff">
      <span>Atmos Pad</span><span>Ambient pads & textures</span>
    </div>
    <div class="track-type-menu-item" data-action="instrument" data-name="Lead Synth" data-icon="‚ö°" data-color="#ffbf7b">
      <span>Lead Synth</span><span>Sharp melodic leads</span>
    </div>
    <div class="track-type-menu-item" data-action="instrument" data-name="FX Lab" data-icon="‚ú®" data-color="#ffd76b">
      <span>FX Lab</span><span>FX, risers & sound design</span>
    </div>

    <div class="track-type-menu-section-label">Vocals</div>
    <div class="track-type-menu-item"
      data-action="vocal"
      data-role="lead"
      data-name="Lead Vocal"
      data-icon="üéôÔ∏è"
      data-color="#ff6bb8">
      <span>Lead Vocal</span><span>Main lead voice</span>
    </div>
    <div class="track-type-menu-item"
      data-action="vocal"
      data-role="backing"
      data-name="Backing Vocal"
      data-icon="üéµ"
      data-color="#ff9be0">
      <span>Backing Vocal</span><span>Harmony & adlibs</span>
    </div>
    <div class="track-type-menu-item"
      data-action="vocal"
      data-role="choir"
      data-name="Choir Stack"
      data-icon="üë•"
      data-color="#ffcfe9">
      <span>Choir Stack</span><span>Choirs & group stacks</span>
    </div>

    <div class="track-type-menu-section-label">Import</div>
    <div class="track-type-menu-item" data-action="import-device">
      <span>Upload from Device</span><span>Open file browser</span>
    </div>
    <div class="track-type-menu-item" data-action="import-audio-lib">
      <span>Import from SL Audio</span><span>Use ‚ÄúMy Creations‚Äù audio</span>
    </div>

    <div class="track-type-menu-section-label">Create</div>
    <div class="track-type-menu-item track-type-menu-item-accent" data-action="sl-assistant">
      <span>Create with SL Assistant</span><span>Colorful AI loops & vocals</span>
    </div>
  </div>

  <!-- OVERLAY (SL ASSISTANT / TRACK SETTINGS / RECORD) -->
  <div class="overlay hidden" id="overlay-root">
    <div class="overlay-window" id="overlay-window">
      <div class="overlay-header">
        <div class="overlay-title" id="overlay-title"></div>
        <button class="overlay-close-btn" id="overlay-close-btn">&times;</button>
      </div>
      <div class="overlay-body" id="overlay-body"></div>
    </div>
  </div>

  <script>
    // ===== STATE =====
    const tracks = [];
    const clips = [];
    let nextTrackId = 1;
    let activeTrackId = null;

    const trackListEl = document.getElementById('track-list');
    const timelineGridEl = document.getElementById('timeline-grid');
    const trackTypeMenuEl = document.getElementById('track-type-menu');
    let trackTypeMenuTrackId = null;

    const overlayRoot = document.getElementById('overlay-root');
    const overlayWindow = document.getElementById('overlay-window');
    const overlayTitleEl = document.getElementById('overlay-title');
    const overlayBodyEl = document.getElementById('overlay-body');

    let overlayMode = null; // 'slAssistant' | 'trackSettings' | 'recordConfig'
    let overlayContextTrackId = null;

    // ===== THEMES =====
    const THEMES = {
      'sl-dark-gray': {
        '--sl-bg-main': '#1e1f23',
        '--sl-bg-toolbar': '#26272c',
        '--sl-bg-panel': '#23242a',
        '--sl-bg-panel-alt': '#1a1b1f',
        '--sl-bg-track-alt': '#262830',
        '--sl-border': '#3a3b42',
        '--sl-border-strong': '#4a4c56',
        '--sl-text-main': '#e4e4e8',
        '--sl-text-muted': '#a0a1aa',
        '--sl-accent': '#4fa8ff',
        '--sl-accent-soft': 'rgba(79, 168, 255, 0.18)',
        '--sl-scroll-track': '#18191d',
        '--sl-scroll-thumb': '#3b3d46',
        '--sl-timeline-bg': '#181920',
        '--sl-timeline-row-alt': '#1f2028'
      },
      'sl-midnight': {
        '--sl-bg-main': '#050510',
        '--sl-bg-toolbar': '#121225',
        '--sl-bg-panel': '#0c0d1a',
        '--sl-bg-panel-alt': '#090913',
        '--sl-bg-track-alt': '#101123',
        '--sl-border': '#292b4a',
        '--sl-border-strong': '#3c3f68',
        '--sl-text-main': '#e6ecff',
        '--sl-text-muted': '#8f92b5',
        '--sl-accent': '#7e5bff',
        '--sl-accent-soft': 'rgba(126, 91, 255, 0.2)',
        '--sl-scroll-track': '#050510',
        '--sl-scroll-thumb': '#333367',
        '--sl-timeline-bg': '#050619',
        '--sl-timeline-row-alt': '#101131'
      },
      'sl-sunset': {
        '--sl-bg-main': '#12080a',
        '--sl-bg-toolbar': '#251016',
        '--sl-bg-panel': '#170b0f',
        '--sl-bg-panel-alt': '#1a1014',
        '--sl-bg-track-alt': '#221016',
        '--sl-border': '#3a1f2c',
        '--sl-border-strong': '#5a2d3b',
        '--sl-text-main': '#ffe7f0',
        '--sl-text-muted': '#c691a5',
        '--sl-accent': '#ff7b5b',
        '--sl-accent-soft': 'rgba(255, 123, 91, 0.22)',
        '--sl-scroll-track': '#13080b',
        '--sl-scroll-thumb': '#5d2c35',
        '--sl-timeline-bg': '#1a0b0f',
        '--sl-timeline-row-alt': '#261018'
      },
      'sl-oceanic': {
        '--sl-bg-main': '#041019',
        '--sl-bg-toolbar': '#08202c',
        '--sl-bg-panel': '#071721',
        '--sl-bg-panel-alt': '#051019',
        '--sl-bg-track-alt': '#0a1d29',
        '--sl-border': '#153849',
        '--sl-border-strong': '#215269',
        '--sl-text-main': '#e4f7ff',
        '--sl-text-muted': '#8bb6c9',
        '--sl-accent': '#29c4ff',
        '--sl-accent-soft': 'rgba(41, 196, 255, 0.22)',
        '--sl-scroll-track': '#041019',
        '--sl-scroll-thumb': '#215269',
        '--sl-timeline-bg': '#05121c',
        '--sl-timeline-row-alt': '#0a1f2b'
      },
      'sl-emerald': {
        '--sl-bg-main': '#04110e',
        '--sl-bg-toolbar': '#08201a',
        '--sl-bg-panel': '#071712',
        '--sl-bg-panel-alt': '#040e0a',
        '--sl-bg-track-alt': '#0a1e18',
        '--sl-border': '#184236',
        '--sl-border-strong': '#256352',
        '--sl-text-main': '#e5fff9',
        '--sl-text-muted': '#8ccbb7',
        '--sl-accent': '#29ff9c',
        '--sl-accent-soft': 'rgba(41, 255, 156, 0.22)',
        '--sl-scroll-track': '#04110e',
        '--sl-scroll-thumb': '#256352',
        '--sl-timeline-bg': '#04130f',
        '--sl-timeline-row-alt': '#0a2018'
      },
      'sl-mono': {
        '--sl-bg-main': '#151515',
        '--sl-bg-toolbar': '#202020',
        '--sl-bg-panel': '#1a1a1a',
        '--sl-bg-panel-alt': '#101010',
        '--sl-bg-track-alt': '#202020',
        '--sl-border': '#2d2d2d',
        '--sl-border-strong': '#3a3a3a',
        '--sl-text-main': '#f0f0f0',
        '--sl-text-muted': '#9a9a9a',
        '--sl-accent': '#f5f5f5',
        '--sl-accent-soft': 'rgba(255, 255, 255, 0.16)',
        '--sl-scroll-track': '#151515',
        '--sl-scroll-thumb': '#3a3a3a',
        '--sl-timeline-bg': '#141414',
        '--sl-timeline-row-alt': '#1f1f1f'
      }
    };

    function applyTheme(id) {
      const theme = THEMES[id] || THEMES['sl-dark-gray'];
      Object.entries(theme).forEach(([key, value]) => {
        document.documentElement.style.setProperty(key, value);
      });
    }

    document.getElementById('theme-select').addEventListener('change', (e) => {
      applyTheme(e.target.value);
    });

    applyTheme('sl-dark-gray');

    // ===== TRACK MODEL =====
    function createTrack(name, options = {}) {
      const id = nextTrackId++;
      const track = {
        id,
        name: name || options.name || `Track ${id}`,
        type: options.type || 'instrument',        // 'instrument' | 'vocal' | 'import'
        role: options.role || null,               // 'lead' | 'backing' | 'choir'
        icon: options.icon || null,
        color: options.color || '#ff7b7b',
        mute: false,
        solo: false,
        recordArmed: false,
        recordConfig: null   // { input, output, presetName }
      };
      tracks.push(track);
      renderTracks();
      renderTimeline();
      return id;
    }

    function getTrack(id) {
      return tracks.find(t => t.id === id);
    }

    function setActiveTrack(id) {
      activeTrackId = id;
      renderTracks();
    }

    // ===== RENDER TRACKS =====
    function renderTracks() {
      trackListEl.innerHTML = '';
      tracks.forEach((t, index) => {
        const row = document.createElement('div');
        row.className = 'track-row';
        if (t.id === activeTrackId) {
          row.classList.add('active');
        }
        row.dataset.trackId = t.id;

        const colorDot = document.createElement('div');
        colorDot.className = 'track-color-dot';
        colorDot.style.background = t.color || '#ff7b7b';

        const icon = document.createElement('div');
        icon.className = 'track-icon';
        icon.textContent = t.icon || (t.type === 'vocal' ? 'VOX' : 'SL');

        const main = document.createElement('div');
        main.className = 'track-main';

        const nameLine = document.createElement('div');
        nameLine.className = 'track-name-line';

        const nameEl = document.createElement('div');
        nameEl.className = 'track-name';
        nameEl.textContent = t.name;

        const typeLabel = document.createElement('div');
        typeLabel.className = 'track-type-label';
        if (t.type === 'vocal') {
          const roleText = t.role ? t.role.charAt(0).toUpperCase() + t.role.slice(1) : 'Lead';
          typeLabel.textContent = `${roleText} vocal`;
        } else if (t.type === 'import') {
          typeLabel.textContent = 'Imported audio';
        } else {
          typeLabel.textContent = 'Instrument';
        }

        nameLine.appendChild(nameEl);
        main.appendChild(nameLine);
        main.appendChild(typeLabel);

        const controls = document.createElement('div');
        controls.className = 'track-controls';

        const mBtn = document.createElement('button');
        mBtn.className = 'track-btn mute';
        mBtn.textContent = 'M';
        if (t.mute) mBtn.classList.add('active');
        mBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          t.mute = !t.mute;
          renderTracks();
        });

        const sBtn = document.createElement('button');
        sBtn.className = 'track-btn solo';
        sBtn.textContent = 'S';
        if (t.solo) sBtn.classList.add('active');
        sBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          t.solo = !t.solo;
          renderTracks();
        });

        const recBtn = document.createElement('button');
        recBtn.className = 'track-btn rec';
        recBtn.textContent = '‚óè';
        if (t.recordArmed) recBtn.classList.add('active');
        recBtn.title = 'Record setup for this track';
        recBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          openRecordConfigForTrack(t.id);
        });

        const upBtn = document.createElement('button');
        upBtn.className = 'track-btn';
        upBtn.textContent = '‚ñ≤';
        upBtn.title = 'Move up';
        upBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          moveTrack(t.id, -1);
        });

        const downBtn = document.createElement('button');
        downBtn.className = 'track-btn';
        downBtn.textContent = '‚ñº';
        downBtn.title = 'Move down';
        downBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          moveTrack(t.id, 1);
        });

        const optionsBtn = document.createElement('button');
        optionsBtn.className = 'track-btn track-options-btn';
        optionsBtn.textContent = '‚ãÆ';
        optionsBtn.title = 'Track options';
        optionsBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          const rect = e.currentTarget.getBoundingClientRect();
          openTrackTypeMenu(t.id, rect.right + 2, rect.top + 2);
        });

        controls.appendChild(mBtn);
        controls.appendChild(sBtn);
        controls.appendChild(recBtn);
        controls.appendChild(upBtn);
        controls.appendChild(downBtn);
        controls.appendChild(optionsBtn);

        main.appendChild(controls);

        row.appendChild(colorDot);
        row.appendChild(icon);
        row.appendChild(main);

        row.addEventListener('click', () => {
          setActiveTrack(t.id);
        });

        // Double-click to open Track Settings (rename, icon, color)
        row.addEventListener('dblclick', (e) => {
          e.stopPropagation();
          openTrackSettingsForTrack(t.id);
        });

        trackListEl.appendChild(row);
      });
    }

    function moveTrack(id, direction) {
      const index = tracks.findIndex(t => t.id === id);
      if (index === -1) return;
      const newIndex = index + direction;
      if (newIndex < 0 || newIndex >= tracks.length) return;
      const [track] = tracks.splice(index, 1);
      tracks.splice(newIndex, 0, track);
      renderTracks();
      renderTimeline();
    }

    // ===== TIMELINE =====
    function renderTimeline() {
      timelineGridEl.innerHTML = '';

      tracks.forEach((t, index) => {
        const row = document.createElement('div');
        row.className = 'timeline-row';
        row.dataset.trackId = t.id;

        const beats = document.createElement('div');
        beats.className = 'timeline-beats';
        row.appendChild(beats);

        // Simple placeholder clip for demonstration
        const rowClips = clips.filter(c => c.trackId === t.id);
        rowClips.forEach((clip) => {
          const el = document.createElement('div');
          el.className = 'timeline-clip';
          el.textContent = clip.name || t.name;
          el.style.left = (clip.start || 0) * 40 + 'px';
          el.style.width = (clip.length || 4) * 40 + 'px';
          el.style.background = t.color + '44';
          el.style.borderColor = t.color + 'aa';
          row.appendChild(el);
        });

        timelineGridEl.appendChild(row);
      });
    }

    // ===== TRACK TYPE MENU HANDLING =====
    function openTrackTypeMenu(trackId, x, y) {
      trackTypeMenuTrackId = trackId;
      trackTypeMenuEl.style.left = x + 'px';
      trackTypeMenuEl.style.top = y + 'px';
      trackTypeMenuEl.classList.remove('hidden');
    }

    function hideTrackTypeMenu() {
      trackTypeMenuTrackId = null;
      trackTypeMenuEl.classList.add('hidden');
    }

    document.addEventListener('click', (e) => {
      if (!trackTypeMenuEl.classList.contains('hidden')) {
        if (!trackTypeMenuEl.contains(e.target)) {
          hideTrackTypeMenu();
        }
      }
    });

    trackTypeMenuEl.querySelectorAll('.track-type-menu-item').forEach(item => {
      item.addEventListener('click', () => {
        if (!trackTypeMenuTrackId) return;
        const track = getTrack(trackTypeMenuTrackId);
        if (!track) return;

        const action = item.dataset.action;

        if (action === 'instrument') {
          track.type = 'instrument';
          track.role = null;
          track.name = item.dataset.name || track.name;
          track.icon = item.dataset.icon || 'SL';
          track.color = item.dataset.color || track.color;
          hideTrackTypeMenu();
          renderTracks();
          renderTimeline();
          return;
        }

        if (action === 'vocal') {
          track.type = 'vocal';
          track.role = item.dataset.role || 'lead';
          track.name = item.dataset.name || track.name;
          track.icon = item.dataset.icon || 'VOX';
          track.color = item.dataset.color || track.color;
          hideTrackTypeMenu();
          renderTracks();
          renderTimeline();
          return;
        }

        if (action === 'import-device') {
          hideTrackTypeMenu();
          openImportFromDeviceDialog(track.id);
          return;
        }

        if (action === 'import-audio-lib') {
          hideTrackTypeMenu();
          openImportFromAudioLibraryDialog(track.id);
          return;
        }

        if (action === 'sl-assistant') {
          hideTrackTypeMenu();
          openSlAssistantForTrack(track.id);
          return;
        }
      });
    });

    // ===== OVERLAY HELPERS =====
    function openOverlay(title, mode, trackId, basicWindow = false) {
      overlayMode = mode;
      overlayContextTrackId = trackId || null;
      overlayTitleEl.textContent = title || '';
      overlayBodyEl.innerHTML = '';
      overlayRoot.classList.remove('hidden');
      if (basicWindow) {
        overlayWindow.classList.add('basic-window');
      } else {
        overlayWindow.classList.remove('basic-window');
      }
    }

    function closeOverlay() {
      overlayMode = null;
      overlayContextTrackId = null;
      overlayRoot.classList.add('hidden');
      overlayWindow.classList.remove('basic-window');
    }

    document.getElementById('overlay-close-btn').addEventListener('click', closeOverlay);

    overlayRoot.addEventListener('click', (e) => {
      if (e.target === overlayRoot) {
        closeOverlay();
      }
    });

    // ===== SL ASSISTANT WINDOW =====
    function openSlAssistantForTrack(trackId) {
      const track = getTrack(trackId);
      if (!track) return;

      openOverlay('SL Assistant ‚Äì Creative Lab', 'slAssistant', trackId, false);

      const isVocal = track.type === 'vocal';

      const container = document.createElement('div');

      const row1 = document.createElement('div');
      row1.className = 'overlay-row';
      row1.innerHTML = `
        <div class="overlay-label">Target Track</div>
        <div style="font-size:12px;">
          <strong>${track.name}</strong>
          <span style="color: var(--sl-text-muted);">(${track.type === 'vocal' ? 'Vocal' : 'Instrument'})</span>
        </div>
      `;
      container.appendChild(row1);

      const promptRow = document.createElement('div');
      promptRow.className = 'overlay-row';
      promptRow.innerHTML = '<div class="overlay-label">Creative Prompt</div>';
      const promptArea = document.createElement('textarea');
      promptArea.className = 'overlay-textarea';
      promptArea.placeholder = isVocal
        ? 'Describe the lead style, backing harmonies, energy, language...'
        : 'Describe the instrument, rhythm, groove, mood, sound design...';
      promptRow.appendChild(promptArea);
      container.appendChild(promptRow);

      if (isVocal) {
        const lyricsRow = document.createElement('div');
        lyricsRow.className = 'overlay-row';
        lyricsRow.innerHTML = '<div class="overlay-label">Lyrics (optional)</div>';
        const lyricsArea = document.createElement('textarea');
        lyricsArea.className = 'overlay-textarea';
        lyricsArea.placeholder = 'Paste or write the lyrics you want SL Assistant to sing or arrange...';
        lyricsRow.appendChild(lyricsArea);
        container.appendChild(lyricsRow);
      }

      const loopRow = document.createElement('div');
      loopRow.className = 'overlay-row';
      loopRow.innerHTML = '<div class="overlay-label">Loop Length</div>';
      const lengthSelect = document.createElement('select');
      lengthSelect.className = 'overlay-select';
      [2, 4, 8, 16].forEach(bars => {
        const opt = document.createElement('option');
        opt.value = String(bars);
        opt.textContent = `${bars} bars`;
        if (bars === 4) opt.selected = true;
        lengthSelect.appendChild(opt);
      });
      loopRow.appendChild(lengthSelect);
      container.appendChild(loopRow);

      const vibeRow = document.createElement('div');
      vibeRow.className = 'overlay-row';
      vibeRow.innerHTML = '<div class="overlay-label">Vibe Tags</div>';
      const pillRow = document.createElement('div');
      pillRow.className = 'overlay-pill-row';
      const vibes = ['Afrobeat', 'Seductive', 'Choir', 'Hype', 'Soft', 'Classic', 'Modern', 'Experimental'];
      const activeVibes = new Set();
      vibes.forEach(v => {
        const pill = document.createElement('div');
        pill.className = 'overlay-pill';
        pill.textContent = v;
        pill.addEventListener('click', () => {
          if (activeVibes.has(v)) {
            activeVibes.delete(v);
            pill.classList.remove('active');
          } else {
            activeVibes.add(v);
            pill.classList.add('active');
          }
        });
        pillRow.appendChild(pill);
      });
      vibeRow.appendChild(pillRow);
      container.appendChild(vibeRow);

      const footer = document.createElement('div');
      footer.className = 'overlay-footer';

      const cancelBtn = document.createElement('button');
      cancelBtn.className = 'overlay-btn secondary';
      cancelBtn.textContent = 'Close';
      cancelBtn.addEventListener('click', closeOverlay);

      const createBtn = document.createElement('button');
      createBtn.className = 'overlay-btn primary';
      createBtn.textContent = 'Generate & Drop to Timeline';
      createBtn.addEventListener('click', () => {
        // Placeholder: in real app, we would call backend to generate clip + audio.
        const clip = {
          trackId: track.id,
          name: isVocal ? 'SL Vocal Loop' : 'SL Instrument Loop',
          start: 0,
          length: Number(lengthSelect.value) || 4
        };
        clips.push(clip);
        renderTimeline();
        closeOverlay();
      });

      footer.appendChild(cancelBtn);
      footer.appendChild(createBtn);
      container.appendChild(footer);

      overlayBodyEl.appendChild(container);
    }

    // ===== TRACK SETTINGS WINDOW =====
    function openTrackSettingsForTrack(trackId) {
      const track = getTrack(trackId);
      if (!track) return;

      openOverlay('Track Settings', 'trackSettings', trackId, true);

      const container = document.createElement('div');

      const nameRow = document.createElement('div');
      nameRow.className = 'overlay-row';
      nameRow.innerHTML = '<div class="overlay-label">Track Name</div>';
      const nameInput = document.createElement('input');
      nameInput.className = 'overlay-input';
      nameInput.value = track.name;
      nameRow.appendChild(nameInput);
      container.appendChild(nameRow);

      const iconRow = document.createElement('div');
      iconRow.className = 'overlay-row';
      iconRow.innerHTML = '<div class="overlay-label">Track Icon</div>';
      const iconSelect = document.createElement('select');
      iconSelect.className = 'overlay-select';
      const iconOptions = [
        { value: '', label: 'Default' },
        { value: 'ü•Å', label: 'Drum Kit' },
        { value: 'üåÄ', label: 'Bass Synth' },
        { value: 'üéπ', label: 'Keys' },
        { value: '‚òÅÔ∏è', label: 'Pad' },
        { value: '‚ö°', label: 'Lead' },
        { value: '‚ú®', label: 'FX' },
        { value: 'üéôÔ∏è', label: 'Vocal' },
        { value: 'üéµ', label: 'Backing' },
        { value: 'üë•', label: 'Choir' }
      ];
      iconOptions.forEach(optData => {
        const opt = document.createElement('option');
        opt.value = optData.value;
        opt.textContent = optData.value ? `${optData.value}  ${optData.label}` : optData.label;
        if (optData.value === (track.icon || '')) {
          opt.selected = true;
        }
        iconSelect.appendChild(opt);
      });
      iconRow.appendChild(iconSelect);
      container.appendChild(iconRow);

      const colorRow = document.createElement('div');
      colorRow.className = 'overlay-row';
      colorRow.innerHTML = '<div class="overlay-label">Track Color</div>';
      const colorInner = document.createElement('div');
      colorInner.className = 'color-row';
      const colorInput = document.createElement('input');
      colorInput.type = 'color';
      colorInput.value = track.color || '#ff7b7b';
      const colorPreview = document.createElement('div');
      colorPreview.className = 'color-preview';
      colorPreview.style.background = track.color || '#ff7b7b';
      colorInput.addEventListener('input', () => {
        colorPreview.style.background = colorInput.value;
      });
      colorInner.appendChild(colorInput);
      colorInner.appendChild(colorPreview);
      colorRow.appendChild(colorInner);
      container.appendChild(colorRow);

      const footer = document.createElement('div');
      footer.className = 'overlay-footer';

      const cancelBtn = document.createElement('button');
      cancelBtn.className = 'overlay-btn secondary';
      cancelBtn.textContent = 'Cancel';
      cancelBtn.addEventListener('click', closeOverlay);

      const applyBtn = document.createElement('button');
      applyBtn.className = 'overlay-btn primary';
      applyBtn.textContent = 'Apply';
      applyBtn.addEventListener('click', () => {
        track.name = nameInput.value.trim() || track.name;
        track.icon = iconSelect.value || null;
        track.color = colorInput.value || track.color;
        closeOverlay();
        renderTracks();
        renderTimeline();
      });

      footer.appendChild(cancelBtn);
      footer.appendChild(applyBtn);
      container.appendChild(footer);

      overlayBodyEl.appendChild(container);
    }

    // ===== RECORD CONFIG WINDOW =====
    const recordPresets = [];

    function openRecordConfigForTrack(trackId) {
      const track = getTrack(trackId);
      if (!track) return;

      openOverlay('Record Setup', 'recordConfig', trackId, true);

      const container = document.createElement('div');

      const headerRow = document.createElement('div');
      headerRow.className = 'overlay-row';
      headerRow.innerHTML = `
        <div class="overlay-label">Track</div>
        <div style="font-size:12px;">
          <strong>${track.name}</strong>
          <span style="color: var(--sl-text-muted);">(${track.type === 'vocal' ? 'Vocal' : 'Instrument'})</span>
        </div>
      `;
      container.appendChild(headerRow);

      const inputRow = document.createElement('div');
      inputRow.className = 'overlay-row';
      inputRow.innerHTML = '<div class="overlay-label">Input Source</div>';
      const inputSelect = document.createElement('select');
      inputSelect.className = 'overlay-select';
      ['System Default Microphone', 'SL Capture Interface 1', 'USB Mic ‚Äì CrystalVoice'].forEach((label, idx) => {
        const opt = document.createElement('option');
        opt.value = label;
        opt.textContent = label;
        inputSelect.appendChild(opt);
      });
      if (track.recordConfig && track.recordConfig.input) {
        inputSelect.value = track.recordConfig.input;
      }
      inputRow.appendChild(inputSelect);
      container.appendChild(inputRow);

      const outputRow = document.createElement('div');
      outputRow.className = 'overlay-row';
      outputRow.innerHTML = '<div class="overlay-label">Output</div>';
      const outputSelect = document.createElement('select');
      outputSelect.className = 'overlay-select';
      const outputs = [
        'Project Output (Master)',
        'Headphones A',
        'Audio Interface 1‚Äì2'
      ];
      outputs.forEach(label => {
        const opt = document.createElement('option');
        opt.value = label;
        opt.textContent = label;
        outputSelect.appendChild(opt);
      });
      if (track.recordConfig && track.recordConfig.output) {
        outputSelect.value = track.recordConfig.output;
      }
      outputRow.appendChild(outputSelect);
      container.appendChild(outputRow);

      const presetRow = document.createElement('div');
      presetRow.className = 'overlay-row';
      presetRow.innerHTML = '<div class="overlay-label">Preset</div>';
      const presetSelect = document.createElement('select');
      presetSelect.className = 'overlay-select';
      const blankOpt = document.createElement('option');
      blankOpt.value = '';
      blankOpt.textContent = 'None';
      presetSelect.appendChild(blankOpt);
      recordPresets.forEach((preset, idx) => {
        const opt = document.createElement('option');
        opt.value = preset.name;
        opt.textContent = preset.name;
        presetSelect.appendChild(opt);
      });
      presetSelect.addEventListener('change', () => {
        const p = recordPresets.find(p => p.name === presetSelect.value);
        if (p) {
          inputSelect.value = p.input;
          outputSelect.value = p.output;
        }
      });
      presetRow.appendChild(presetSelect);
      container.appendChild(presetRow);

      const newPresetRow = document.createElement('div');
      newPresetRow.className = 'overlay-row';
      newPresetRow.innerHTML = '<div class="overlay-label">Save as New Preset</div>';
      const presetInput = document.createElement('input');
      presetInput.className = 'overlay-input';
      presetInput.placeholder = 'Preset name (e.g. ‚ÄúLead Vocal Chain‚Äù)';
      newPresetRow.appendChild(presetInput);
      container.appendChild(newPresetRow);

      const footer = document.createElement('div');
      footer.className = 'overlay-footer';

      const cancelBtn = document.createElement('button');
      cancelBtn.className = 'overlay-btn secondary';
      cancelBtn.textContent = 'Cancel';
      cancelBtn.addEventListener('click', closeOverlay);

      const savePresetBtn = document.createElement('button');
      savePresetBtn.className = 'overlay-btn secondary';
      savePresetBtn.textContent = 'Save Preset';
      savePresetBtn.addEventListener('click', () => {
        const name = presetInput.value.trim();
        if (!name) return;
        const existing = recordPresets.find(p => p.name === name);
        if (existing) {
          existing.input = inputSelect.value;
          existing.output = outputSelect.value;
        } else {
          recordPresets.push({
            name,
            input: inputSelect.value,
            output: outputSelect.value
          });
        }
        closeOverlay();
      });

      const armBtn = document.createElement('button');
      armBtn.className = 'overlay-btn primary';
      armBtn.textContent = track.recordArmed ? 'Update & Keep Armed' : 'Apply & Arm Track';
      armBtn.addEventListener('click', () => {
        track.recordConfig = {
          input: inputSelect.value,
          output: outputSelect.value,
          presetName: presetSelect.value || null
        };
        track.recordArmed = true;
        closeOverlay();
        renderTracks();
      });

      footer.appendChild(cancelBtn);
      footer.appendChild(savePresetBtn);
      footer.appendChild(armBtn);
      container.appendChild(footer);

      overlayBodyEl.appendChild(container);
    }

    // ===== IMPORT DIALOGS (PLACEHOLDER IMPLEMENTATION) =====
    function openImportFromDeviceDialog(trackId) {
      const track = getTrack(trackId);
      if (!track) return;

      const input = document.createElement('input');
      input.type = 'file';
      input.accept = 'audio/*';
      input.addEventListener('change', () => {
        if (!input.files || !input.files[0]) return;
        const file = input.files[0];
        track.type = 'import';
        track.role = null;
        track.name = file.name.replace(/\.[^/.]+$/, '');
        track.icon = 'üéß';
        track.color = '#7b9dff';
        // Add a simple placeholder clip at start
        clips.push({
          trackId: track.id,
          name: track.name,
          start: 0,
          length: 4
        });
        renderTracks();
        renderTimeline();
      });
      input.click();
    }

    function openImportFromAudioLibraryDialog(trackId) {
      const track = getTrack(trackId);
      if (!track) return;

      openOverlay('Import from SL Audio Library', 'importLibrary', trackId, true);

      const container = document.createElement('div');
      const row = document.createElement('div');
      row.className = 'overlay-row';
      row.innerHTML = `
        <div class="overlay-label">My Creations</div>
        <div style="font-size:12px; color: var(--sl-text-muted);">
          This will connect to your Sound Lab audio library
          (e.g. <strong>music.html</strong>) and let you drop stems,
          bounces and loops directly into this track.
        </div>
      `;
      container.appendChild(row);

      const footer = document.createElement('div');
      footer.className = 'overlay-footer';

      const closeBtn = document.createElement('button');
      closeBtn.className = 'overlay-btn secondary';
      closeBtn.textContent = 'Close';
      closeBtn.addEventListener('click', closeOverlay);

      const demoBtn = document.createElement('button');
      demoBtn.className = 'overlay-btn primary';
      demoBtn.textContent = 'Simulate Import';
      demoBtn.addEventListener('click', () => {
        track.type = 'import';
        track.role = null;
        track.icon = 'üéß';
        track.color = '#7b9dff';
        clips.push({
          trackId: track.id,
          name: 'SL Audio ‚Äì Demo Stem',
          start: 0,
          length: 8
        });
        renderTracks();
        renderTimeline();
        closeOverlay();
      });

      footer.appendChild(closeBtn);
      footer.appendChild(demoBtn);
      container.appendChild(footer);

      overlayBodyEl.appendChild(container);
    }

    // ===== ADD TRACK BUTTON =====
    document.getElementById('add-track-btn').addEventListener('click', () => {
      createTrack(`Track ${nextTrackId}`, {
        type: 'instrument',
        icon: null,
        color: '#ff7b7b'
      });
    });

    // ===== INITIAL DEMO TRACKS =====
    createTrack('Drum Kit', { type: 'instrument', icon: 'ü•Å', color: '#ff7b7b' });
    createTrack('Bass Synth', { type: 'instrument', icon: 'üåÄ', color: '#7bffb5' });
    createTrack('Lead Vocal', { type: 'vocal', role: 'lead', icon: 'üéôÔ∏è', color: '#ff6bb8' });
    setActiveTrack(1);

  </script>
</body>
</html>
