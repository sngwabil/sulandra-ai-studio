<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sulandra AI Studio – Image Lab</title>

  <style>
    :root {
      --bg: #050816;
      --card-bg: #0b1020;
      --accent: #a855f7;
      --accent-soft: rgba(168, 85, 247, 0.18);
      --accent2: #3b82f6;
      --accent3: #f97316;
      --text-main: #f9fafb;
      --text-muted: #9ca3af;
      --border-soft: rgba(148, 163, 184, 0.25);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background:
        radial-gradient(circle at top, #111827, #020617 55%),
        radial-gradient(circle at bottom, #020617, #000 80%);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    /* HEADER */

    header {
      border-bottom: 1px solid var(--border-soft);
      background: rgba(2, 6, 23, 0.95);
      backdrop-filter: blur(12px);
      position: sticky;
      top: 0;
      z-index: 30;
    }

    .header-inner {
      max-width: 1200px;
      margin: 0 auto;
      padding: 14px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 14px;
      flex-wrap: wrap;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-circle {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: conic-gradient(
        from 140deg,
        #a855f7,
        #3b82f6,
        #f97316,
        #22c55e,
        #a855f7
      );
      box-shadow: 0 0 18px rgba(168, 85, 247, 0.6);
      animation: spinGlow 8s linear infinite;
    }

    .logo-text-main {
      font-weight: 700;
      font-size: 17px;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .logo-text-sub {
      font-size: 10px;
      text-transform: uppercase;
      color: var(--text-muted);
      letter-spacing: 0.14em;
      animation: glowPulse 3.5s ease-in-out infinite;
    }

    .nav-group {
      display: flex;
      align-items: center;
      gap: 14px;
      flex-wrap: wrap;
    }

    nav {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    nav a {
      color: var(--text-muted);
      text-decoration: none;
      font-size: 14px;
      padding: 6px 9px;
      border-radius: 999px;
      border: 1px solid transparent;
      transition: all 0.18s ease;
    }

    nav a:hover {
      color: var(--text-main);
      border-color: var(--border-soft);
      background: rgba(15, 23, 42, 0.8);
    }

    nav a.active {
      color: var(--text-main);
      background: var(--accent-soft);
      border-color: rgba(168, 85, 247, 0.7);
      box-shadow: 0 0 12px rgba(168, 85, 247, 0.5);
    }

    .profile-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      border-radius: 999px;
      padding: 6px 10px;
      border: 1px solid var(--border-soft);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.9), #020617);
      font-size: 12px;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.16s ease;
    }

    .profile-avatar {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: linear-gradient(135deg, #a855f7, #3b82f6);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 700;
      color: #f9fafb;
    }

    .profile-badge:hover {
      border-color: rgba(168, 85, 247, 0.7);
      color: var(--text-main);
      box-shadow: 0 0 16px rgba(168, 85, 247, 0.5);
    }

    .profile-credits {
      font-size: 11px;
      color: var(--text-muted);
    }

    main {
      flex: 1;
    }

    /* IMAGE HERO */

    .lab-hero {
      max-width: 1200px;
      margin: 16px auto 0;
      padding: 0 16px 10px;
      border-bottom: 1px solid rgba(15, 23, 42, 0.9);
    }

    .lab-kicker {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-muted);
      margin-bottom: 6px;
    }

    .lab-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .lab-title span {
      background: linear-gradient(
        90deg,
        #a855f7,
        #3b82f6,
        #f97316,
        #22c55e,
        #a855f7
      );
      -webkit-background-clip: text;
      color: transparent;
      background-size: 220% 220%;
      animation: shimmer 6s linear infinite;
      text-shadow: 0 0 14px rgba(168, 85, 247, 0.4);
    }

    .lab-sub {
      font-size: 13px;
      color: var(--text-muted);
      max-width: 820px;
      line-height: 1.7;
    }

    .lab-status-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      margin-top: 8px;
      font-size: 11px;
    }

    .lab-pill {
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      padding: 4px 9px;
      background: rgba(15, 23, 42, 0.96);
      color: var(--text-muted);
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .lab-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.7);
    }

    /* LAYOUT */

    .lab-layout {
      max-width: 1200px;
      margin: 8px auto 0;
      padding: 0 16px 18px;
      display: grid;
      grid-template-columns: 210px minmax(0, 1fr);
      gap: 14px;
    }

    /* SIDEBAR */

    .lab-sidebar {
      border-radius: 16px;
      border: 1px solid var(--border-soft);
      background: rgba(15, 23, 42, 0.98);
      box-shadow: 0 16px 36px rgba(15, 23, 42, 0.95);
      padding: 10px 8px;
      font-size: 13px;
    }

    .sidebar-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
    }

    .menu-icon {
      width: 18px;
      height: 18px;
      border-radius: 4px;
      border: 1px solid var(--border-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      color: var(--text-muted);
    }

    .sidebar-title {
      font-size: 13px;
      font-weight: 600;
    }

    .sidebar-section-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      margin: 8px 0 4px;
    }

    .sidebar-btn {
      width: 100%;
      text-align: left;
      border-radius: 9px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--text-muted);
      padding: 6px 7px;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.15s ease;
      margin-bottom: 3px;
    }

    .sidebar-btn span {
      pointer-events: none;
    }

    .sidebar-btn:hover {
      background: rgba(15, 23, 42, 0.98);
      border-color: var(--border-soft);
      color: var(--text-main);
    }

    .sidebar-btn.active {
      background: radial-gradient(circle at top left, #111827, #020617);
      border-color: rgba(168, 85, 247, 0.7);
      color: var(--text-main);
      box-shadow: 0 0 16px rgba(168, 85, 247, 0.4);
    }

    .sidebar-badge {
      font-size: 10px;
      border-radius: 999px;
      padding: 2px 6px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      color: var(--text-muted);
    }

    .sidebar-plan-dots {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 8px;
      line-height: 1.4;
    }

    /* MAIN PANEL */

    .lab-main {
      border-radius: 18px;
      border: 1px solid var(--border-soft);
      background: radial-gradient(circle at top, #111827, #020617);
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.95);
      padding: 12px 12px 14px;
      min-height: 320px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .lab-main-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .lab-main-title {
      font-size: 15px;
      font-weight: 600;
    }

    .lab-main-sub {
      font-size: 11px;
      color: var(--text-muted);
    }

    .lab-main-plan-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      padding: 4px 9px;
      font-size: 11px;
      background: rgba(15, 23, 42, 0.97);
      color: var(--text-muted);
    }

    .lab-main-columns {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.1fr);
      gap: 10px;
      align-items: start;
    }

    /* MODEL VERSIONS */

    .version-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 6px;
    }

    .version-chip {
      font-size: 11px;
      border-radius: 999px;
      padding: 3px 8px;
      border: 1px solid var(--border-soft);
      background: rgba(15, 23, 42, 0.96);
      color: var(--text-muted);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      position: relative;
    }

    .version-chip.active {
      background: linear-gradient(135deg, #a855f7, #3b82f6);
      color: #f9fafb;
      border-color: transparent;
      box-shadow: 0 0 16px rgba(129, 140, 248, 0.7);
    }

    .version-chip.locked {
      opacity: 0.4;
    }

    .version-lock {
      font-size: 10px;
    }

    /* INPUT / UPLOAD */

    .input-card {
      border-radius: 12px;
      border: 1px solid var(--border-soft);
      background: rgba(2, 6, 23, 0.98);
      padding: 8px 9px;
      font-size: 12px;
    }

    .input-label-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 5px;
      gap: 10px;
    }

    .input-label {
      font-size: 12px;
      font-weight: 500;
    }

    .input-help {
      font-size: 11px;
      color: var(--text-muted);
    }

    .upload-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 6px;
    }

    .upload-box {
      border-radius: 11px;
      border: 1px dashed rgba(148, 163, 184, 0.7);
      background: radial-gradient(circle at top, #020617, #020617);
      padding: 12px 9px;
      font-size: 11px;
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: 6px;
      align-items: flex-start;
      position: relative;
      overflow: hidden;
    }

    .upload-box .plus-circle {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.85);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      color: #e5e7eb;
      background: rgba(15, 23, 42, 0.96);
    }

    .upload-box strong {
      font-size: 11px;
      color: #e5e7eb;
    }

    .upload-note {
      font-size: 10px;
      color: var(--text-muted);
    }

    textarea {
      width: 100%;
      border-radius: 9px;
      border: 1px solid var(--border-soft);
      background: #020617;
      color: var(--text-main);
      padding: 7px 8px;
      font-size: 12px;
      min-height: 70px;
      resize: vertical;
    }

    textarea::placeholder {
      color: #6b7280;
    }

    .input-footer-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 6px;
      font-size: 11px;
      color: var(--text-muted);
      gap: 10px;
      flex-wrap: wrap;
    }

    .btn-primary {
      border-radius: 999px;
      padding: 7px 14px;
      font-size: 12px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      background: linear-gradient(135deg, #a855f7, #3b82f6);
      color: #f9fafb;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 10px 22px rgba(129, 140, 248, 0.7);
      transition: transform 0.12s ease, box-shadow 0.12s ease;
    }

    .btn-primary span.plus {
      width: 17px;
      height: 17px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 700;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 30px rgba(129, 140, 248, 0.9);
    }

    .btn-ghost {
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 11px;
      border: 1px solid var(--border-soft);
      background: rgba(15, 23, 42, 0.95);
      color: var(--text-muted);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: all 0.14s ease;
    }

    .btn-ghost:hover {
      border-color: rgba(148, 163, 184, 0.8);
      color: var(--text-main);
      background: rgba(15, 23, 42, 1);
    }

    /* OUTPUT */

    .output-card {
      border-radius: 12px;
      border: 1px solid var(--border-soft);
      background: rgba(2, 6, 23, 0.98);
      padding: 8px 9px;
      font-size: 12px;
    }

    .output-header-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 10px;
      margin-bottom: 6px;
    }

    .output-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 7px;
    }

    .gen-card {
      border-radius: 9px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: radial-gradient(circle at top, #020617, #020617);
      padding: 6px;
      font-size: 11px;
      color: var(--text-muted);
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .gen-thumbnail {
      border-radius: 6px;
      background: radial-gradient(circle at top left, #4c1d95, #020617);
      height: 70px;
      position: relative;
      overflow: hidden;
    }

    .gen-thumbnail::after {
      content: "";
      position: absolute;
      inset: 10%;
      border-radius: 14px;
      border: 1px solid rgba(248, 250, 252, 0.08);
      box-shadow:
        0 0 24px rgba(168, 85, 247, 0.5),
        0 0 40px rgba(59, 130, 246, 0.5);
      opacity: 0.7;
    }

    .gen-label {
      font-size: 11px;
      color: #e5e7eb;
    }

    .gen-meta {
      font-size: 10px;
      color: var(--text-muted);
    }

    .gen-actions {
      margin-top: 3px;
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
    }

    .gen-btn {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.96);
      font-size: 10px;
      padding: 3px 7px;
      cursor: pointer;
      color: var(--text-muted);
    }

    .gen-btn.primary {
      border-color: rgba(168, 85, 247, 0.8);
      color: #e5e7eb;
    }

    /* OTHER VIEWS */

    .lab-secondary {
      border-radius: 12px;
      border: 1px solid var(--border-soft);
      background: rgba(2, 6, 23, 0.98);
      padding: 9px 10px;
      font-size: 12px;
      display: none;
      flex-direction: column;
      gap: 8px;
      min-height: 240px;
    }

    .lab-secondary.active {
      display: flex;
    }

    .media-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 8px;
    }

    .media-card {
      border-radius: 10px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: radial-gradient(circle at top, #020617, #020617);
      padding: 6px;
      font-size: 11px;
      color: var(--text-muted);
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .media-thumb {
      border-radius: 6px;
      background: radial-gradient(circle at top left, #a855f7, #020617);
      height: 60px;
      position: relative;
      overflow: hidden;
    }

    .media-meta-row {
      display: flex;
      justify-content: space-between;
      font-size: 10px;
      color: var(--text-muted);
    }

    .lock-overlay {
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: radial-gradient(circle at center, rgba(15, 23, 42, 0.92), rgba(15, 23, 42, 0.98));
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-size: 11px;
      color: var(--text-muted);
    }

    .lock-overlay span {
      display: block;
      margin-top: 2px;
    }

    /* PROFILE OVERLAY */

    .profile-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(10px);
      display: none;
      z-index: 40;
      align-items: stretch;
      justify-content: flex-end;
    }

    .profile-overlay.show {
      display: flex;
    }

    .profile-panel {
      width: min(380px, 100%);
      background: #020617;
      border-left: 1px solid var(--border-soft);
      box-shadow: -20px 0 40px rgba(0, 0, 0, 0.8);
      display: flex;
      flex-direction: column;
    }

    .profile-header {
      padding: 12px 14px;
      border-bottom: 1px solid var(--border-soft);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .profile-header-main {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .profile-avatar-lg {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: linear-gradient(135deg, #a855f7, #3b82f6);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 700;
      color: #f9fafb;
    }

    .profile-header-text-main {
      font-size: 14px;
      font-weight: 600;
    }

    .profile-header-text-sub {
      font-size: 11px;
      color: var(--text-muted);
    }

    .close-btn {
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: rgba(15, 23, 42, 0.96);
      color: var(--text-muted);
      cursor: pointer;
      font-size: 13px;
      padding: 6px 9px;
    }

    .profile-body {
      display: grid;
      grid-template-columns: 115px minmax(0, 1fr);
      flex: 1;
      min-height: 0;
    }

    .profile-menu {
      border-right: 1px solid var(--border-soft);
      padding: 10px 8px;
      font-size: 12px;
    }

    .profile-menu button {
      width: 100%;
      text-align: left;
      border-radius: 9px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--text-muted);
      padding: 6px 7px;
      cursor: pointer;
      margin-bottom: 4px;
      font-size: 12px;
      transition: all 0.15s ease;
    }

    .profile-menu button.active {
      background: rgba(15, 23, 42, 0.96);
      border-color: rgba(148, 163, 184, 0.7);
      color: var(--text-main);
    }

    .profile-content {
      padding: 10px 11px;
      overflow-y: auto;
      font-size: 13px;
    }

    .profile-section-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .profile-section-sub {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 8px;
    }

    .profile-line {
      font-size: 13px;
      margin-bottom: 4px;
    }

    .profile-small {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 7px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      font-size: 11px;
      color: var(--text-muted);
      background: rgba(15, 23, 42, 0.96);
      margin-right: 4px;
      margin-bottom: 4px;
      cursor: pointer;
    }

    .chip.disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .profile-footer {
      padding: 8px 12px;
      border-top: 1px solid var(--border-soft);
      font-size: 11px;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: center;
    }

    .profile-footer button {
      border-radius: 999px;
      border: 1px solid rgba(248, 113, 113, 0.7);
      background: rgba(15, 23, 42, 0.96);
      color: #fecaca;
      cursor: pointer;
      font-size: 11px;
      padding: 5px 9px;
    }

    footer {
      border-top: 1px solid var(--border-soft);
      padding: 10px 16px 14px;
      font-size: 11px;
      color: var(--text-muted);
      text-align: center;
      background: rgba(2, 6, 23, 0.97);
      margin-top: 14px;
    }

    /* PLAN DETAIL OVERLAY */

    .plan-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.92);
      backdrop-filter: blur(10px);
      display: none;
      z-index: 35;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .plan-overlay.show {
      display: flex;
    }

    .plan-dialog {
      width: min(520px, 100%);
      border-radius: 20px;
      background: #020617;
      border: 1px solid var(--border-soft);
      box-shadow: 0 24px 60px rgba(0, 0, 0, 0.9);
      padding: 16px 18px 14px;
    }

    .plan-dialog-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 10px;
      gap: 8px;
    }

    .plan-dialog-title {
      font-size: 18px;
      font-weight: 600;
    }

    .plan-dialog-sub {
      font-size: 12px;
      color: var(--text-muted);
    }

    .toggle-pill {
      display: inline-flex;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: rgba(15, 23, 42, 0.98);
      overflow: hidden;
      font-size: 12px;
    }

    .toggle-pill button {
      border: none;
      background: transparent;
      padding: 6px 10px;
      color: var(--text-muted);
      cursor: pointer;
    }

    .toggle-pill button.active {
      background: linear-gradient(135deg, #a855f7, #3b82f6);
      color: #f9fafb;
    }

    .plan-dialog-body {
      font-size: 13px;
      color: var(--text-muted);
    }

    .price-row {
      display: flex;
      align-items: baseline;
      gap: 10px;
      margin-bottom: 4px;
    }

    .price-main {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-main);
    }

    .price-note {
      font-size: 12px;
      color: var(--text-muted);
    }

    .price-strike {
      text-decoration: line-through;
      color: #6b7280;
      font-size: 12px;
    }

    .price-save {
      font-size: 12px;
      color: #22c55e;
    }

    .plan-dialog-footer {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    /* ANIMATIONS & RESPONSIVE */

    @keyframes spinGlow {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @keyframes glowPulse {
      0%, 100% { opacity: 0.7; text-shadow: 0 0 6px rgba(244, 114, 182, 0.3); }
      50% { opacity: 1; text-shadow: 0 0 16px rgba(244, 114, 182, 0.7); }
    }

    @keyframes shimmer {
      0% { background-position: 0% 50%; }
      100% { background-position: 200% 50%; }
    }

    @media (max-width: 960px) {
      .lab-layout {
        grid-template-columns: minmax(0, 1fr);
      }
      .lab-main-columns {
        grid-template-columns: minmax(0, 1fr);
      }
      .profile-body {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    @media (max-width: 640px) {
      .header-inner {
        flex-direction: column;
        align-items: flex-start;
      }
      .lab-title {
        font-size: 20px;
      }
    }
  </style>
</head>

<body>
<header>
  <div class="header-inner">
    <div class="logo">
      <div class="logo-circle"></div>
      <div>
        <div class="logo-text-main">Sulandra AI Studio</div>
        <div class="logo-text-sub">Images · Music · Video · Films</div>
      </div>
    </div>

    <div class="nav-group">
      <nav>
        <a href="index.html">Home</a>
        <a href="image.html" class="active">Image</a>
        <a href="video.html">Video</a>
        <a href="music.html">Music</a>
        <a href="film.html">Short Films</a>
        <a href="studio.html">Studio</a>
        <a href="education.html">Explore</a>
      </nav>

      <button type="button" class="profile-badge" onclick="toggleProfile()">
        <div class="profile-avatar" id="profile-avatar">G</div>
        <div>
          <div id="profile-label">Sign in</div>
          <div class="profile-credits" id="profile-credits">0 credits</div>
        </div>
      </button>
    </div>
  </div>
</header>

<main>
  <section class="lab-hero">
    <div class="lab-kicker">Image lab</div>
    <h1 class="lab-title">
      Generate <span>images, outfits and edits</span> from one place.
    </h1>
    <p class="lab-sub">
      Text-to-image, image-to-image, outfit changes and pose edits – all wired to your Sulandra credit system.
      Use the same image in Music Lab covers, Video Lab shots or Short Films without downloading anything.
    </p>
    <div class="lab-status-row">
      <div class="lab-pill">
        <div class="lab-dot"></div>
        Active Session
      </div>
      <div class="lab-pill" id="lab-plan-pill">
        Plan: Basic · 0 / 0 credits
      </div>
    </div>
  </section>

  <section class="lab-layout">
    <aside class="lab-sidebar">
      <div class="sidebar-header">
        <div class="menu-icon">≡</div>
        <div class="sidebar-title">Image tools</div>
      </div>

      <div class="sidebar-section-label">Create</div>
      <button class="sidebar-btn active" id="btn-create" onclick="setView('create')">
        <span>Text → Image</span>
        <span class="sidebar-badge">5 credits</span>
      </button>
      <button class="sidebar-btn" onclick="setView('create-img2img')">
        <span>Image → Image</span>
        <span class="sidebar-badge">5–15 credits</span>
      </button>
      <button class="sidebar-btn" onclick="setView('create-outfit')">
        <span>Outfit & Pose</span>
        <span class="sidebar-badge">Pro+</span>
      </button>
      <button class="sidebar-btn" onclick="setView('create-pdf')">
        <span>PDF → Storyboard / Moodboard</span>
        <span class="sidebar-badge">Creator+</span>
      </button>

      <div class="sidebar-section-label">Work</div>
      <button class="sidebar-btn" onclick="setView('generations')">
        <span>My generations</span>
        <span class="sidebar-badge">History</span>
      </button>
      <button class="sidebar-btn" onclick="setView('prompt')">
        <span>AI prompt assistant</span>
      </button>
      <button class="sidebar-btn" onclick="setView('media')">
        <span>Media · Community Image Feed</span>
      </button>

      <div class="sidebar-section-label">Plan quick switch</div>
      <div style="margin-bottom:4px;">
        <span class="chip" onclick="simulatePlan('basic')">Basic</span>
        <span class="chip" onclick="simulatePlan('pro')">Pro</span>
        <span class="chip" onclick="simulatePlan('creator')">Creator</span>
        <span class="chip" onclick="simulatePlan('creatorUltimate')">Creator Ultimate</span>
      </div>

      <div class="sidebar-plan-dots">
        • Basic: free, 50 credits, UHD previews with watermark.<br/>
        • Pro & up: clean exports, higher resolutions and more tools unlocked.
      </div>
    </aside>

    <section class="lab-main">
      <div class="lab-main-header">
        <div>
          <div class="lab-main-title" id="lab-main-title">Create · Text → Image</div>
          <div class="lab-main-sub" id="lab-main-sub">
            Describe what you want. We’ll generate 4 options and charge 5 credits per image.
          </div>
        </div>
        <div class="lab-main-plan-pill" id="lab-main-plan-pill">
          Plan: Basic · 0 / 0 credits
        </div>
      </div>

      <div id="view-create" class="lab-main-columns">
        <div>
          <div class="input-card">
            <div class="input-label-row">
              <div class="input-label">Model versions</div>
              <div class="input-help">Higher versions may use slightly more GPU time.</div>
            </div>
            <div class="version-row">
              <button class="version-chip active" onclick="setVersion('v1')">
                v1 · Fast
              </button>
              <button class="version-chip" data-feature="v2" onclick="handleVersionClick('v2')">
                v2 · Balanced <span class="version-lock">●</span>
              </button>
              <button class="version-chip" data-feature="v3" onclick="handleVersionClick('v3')">
                v3 · High detail <span class="version-lock">●</span>
              </button>
              <button class="version-chip" data-feature="xl" onclick="handleVersionClick('xl')">
                Experimental XL <span class="version-lock">●</span>
              </button>
            </div>
          </div>

          <div class="input-card" style="margin-top:6px;">
            <div class="input-label-row">
              <div class="input-label">Inputs</div>
              <div class="input-help" id="input-help-text">
                Optional reference image + your text prompt.
              </div>
            </div>

            <div class="upload-grid" id="upload-grid">
              <div class="upload-box" onclick="handleUpload('imageReference')">
                <div class="plus-circle">+</div>
                <strong>Reference image (optional)</strong>
                <div class="upload-note">
                  Upload a face, outfit or pose to guide the style. JPG / PNG / WEBP.
                </div>
              </div>
              <div class="upload-box" onclick="handleUpload('mask')">
                <div class="plus-circle">+</div>
                <strong>Mask / area to edit (optional)</strong>
                <div class="upload-note">
                  For inpainting – areas you want to change only.
                </div>
              </div>
            </div>

            <div style="margin-top:6px;">
              <textarea id="prompt-text"
                placeholder="Example: A cinematic portrait of a Black woman with huge hips, soft studio lighting, white outfit, clean background, fashion photography style."></textarea>
            </div>

            <div class="input-footer-row">
              <div>
                <span id="credit-note">This run: 1 high-res image = 5 credits.</span><br/>
                <span>Basic will export with watermark. Pro and above export clean.</span>
              </div>
              <div style="display:flex; gap:6px; flex-wrap:wrap;">
                <button class="btn-ghost" type="button" onclick="openPlanDetails(user.plan)">
                  Change plan
                </button>
                <button class="btn-primary" type="button" onclick="runGeneration()">
                  <span class="plus">+</span>
                  Generate image
                </button>
              </div>
            </div>
          </div>
        </div>

        <div>
          <div class="output-card">
            <div class="output-header-row">
              <div class="input-label">Output</div>
              <div class="input-help" id="output-help">
                When you generate, your best results can be sent directly to Video Lab or Short Films.
              </div>
            </div>
            <div class="output-grid" id="output-grid">
              <div class="gen-card">
                <div class="gen-thumbnail"></div>
                <div class="gen-label">Fashion portrait · v1</div>
                <div class="gen-meta">From text + reference · 5 credits</div>
                <div class="gen-actions">
                  <button class="gen-btn primary" type="button">Use in Video Lab</button>
                  <button class="gen-btn" type="button">Use in Short Films</button>
                  <button class="gen-btn" type="button" onclick="downloadImage()">Download</button>
                </div>
              </div>
              <div class="gen-card">
                <div class="gen-thumbnail"></div>
                <div class="gen-label">Outfit variation</div>
                <div class="gen-meta">Image → image · 15 credits</div>
                <div class="gen-actions">
                  <button class="gen-btn primary" type="button">Send to Studio</button>
                  <button class="gen-btn" type="button" onclick="downloadImage()">Download</button>
                </div>
              </div>
            </div>
            <div class="input-footer-row" style="margin-top:7px;">
              <div>All generations will appear in <strong>My generations</strong> for reuse in other labs.</div>
              <button class="btn-ghost" type="button" onclick="setView('generations')">
                View my generations
              </button>
            </div>
          </div>
        </div>
      </div>

      <div id="view-generations" class="lab-secondary">
        <div class="lab-main-header">
          <div>
            <div class="lab-main-title">My generations</div>
            <div class="lab-main-sub">
              Your session history. Newly generated images will appear here.
            </div>
          </div>
        </div>
        <div class="media-grid" id="history-grid">
          <div class="media-card">
            <div class="media-thumb"></div>
            <div>“Afrobeat cover art”</div>
            <div class="media-meta-row">
              <span>v2 · 4K</span>
              <span>Used in 1 video</span>
            </div>
          </div>
        </div>
      </div>

      <div id="view-prompt" class="lab-secondary">
        <div class="lab-main-header">
          <div>
            <div class="lab-main-title">AI prompt assistant</div>
            <div class="lab-main-sub">
              Describe your idea in simple language and we’ll suggest strong image prompts you can paste into the generator.
            </div>
          </div>
        </div>
        <div class="input-card">
          <div class="input-label-row">
            <div class="input-label">Your idea</div>
          </div>
          <textarea id="prompt-assistant-input"
            placeholder="Example: I want a dance challenge cover with a Black woman, big hips, colorful lights, and a club feel, vertical 9:16."></textarea>
          <div class="input-footer-row">
            <div>Prompt suggestions are free. Generation still uses credits.</div>
            <button class="btn-primary" type="button" onclick="suggestPrompt()">
              <span class="plus">+</span>
              Suggest prompts
            </button>
          </div>
        </div>
        <div class="input-card" style="margin-top:6px;">
          <div class="input-label-row">
            <div class="input-label">Suggested prompts</div>
          </div>
          <div class="profile-small" id="prompt-assistant-output">
            Suggestions will appear here. You can click one to copy it into the main generator.
          </div>
        </div>
      </div>

      <div id="view-media" class="lab-secondary">
        <div class="lab-main-header">
          <div>
            <div class="lab-main-title">Media · Community Image Feed</div>
            <div class="lab-main-sub">
              Discover creations from other Sulandra users.
            </div>
          </div>
        </div>
        <div class="media-grid">
          <div class="media-card">
            <div class="media-thumb"></div>
            <div>Dance challenge cover art</div>
            <div class="media-meta-row">
              <span>1.2k likes · 45 comments</span>
              <span>Use style →</span>
            </div>
          </div>
          <div class="media-card">
            <div class="media-thumb"></div>
            <div>Short film key art</div>
            <div class="media-meta-row">
              <span>890 likes</span>
              <span>Remix →</span>
            </div>
          </div>
          <div class="media-card">
            <div class="media-thumb"></div>
            <div>Album cover concept</div>
            <div class="media-meta-row">
              <span>2.4k likes</span>
              <span>Use style →</span>
            </div>
          </div>
        </div>
        <div class="profile-small">
          Later, clicking “Use style” will build a prompt and settings based on that image, just like a style reference.
        </div>
      </div>

      <div id="view-create-img2img" class="lab-secondary">
        <div class="lab-main-header">
          <div>
            <div class="lab-main-title">Create · Image → Image</div>
            <div class="lab-main-sub">
              Upload one or more images and describe how you want them changed – outfits, background, lighting or style.
            </div>
          </div>
        </div>
        <div class="profile-small">
          Use the same controls on the main Create view. This option favors strong reference images and higher credit tiers for complex edits.
        </div>
      </div>

      <div id="view-create-outfit" class="lab-secondary">
        <div class="lab-main-header">
          <div>
            <div class="lab-main-title">Create · Outfit & Pose</div>
            <div class="lab-main-sub">
              Change clothes, poses and camera angles while keeping the same person look. Best with Pro and above.
            </div>
          </div>
        </div>
        <div class="profile-small">
          Outfit & pose tools are available for Pro, Creator and Creator Ultimate. Basic users can still try simple image-to-image in the main Create view.
        </div>
      </div>

      <div id="view-create-pdf" class="lab-secondary">
        <div class="lab-main-header">
          <div>
            <div class="lab-main-title">Create · PDF → Storyboard / Moodboard</div>
            <div class="lab-main-sub">
              Upload a script or visual reference PDF. We’ll extract scenes and design suggested frames, then you can generate images for each key moment.
            </div>
          </div>
        </div>
        <div class="input-card">
          <div class="input-label-row">
            <div class="input-label">Upload script / reference PDF</div>
          </div>
          <div class="upload-box" onclick="handleUpload('pdfStoryboard')">
            <div class="plus-circle">+</div>
            <strong>Upload PDF</strong>
            <div class="upload-note">
              Creator & Creator Ultimate only. In production, this will parse your script and list scenes for image generation.
            </div>
          </div>
        </div>
      </div>
    </section>
  </section>
</main>

<footer>
  Sulandra AI Studio – Image Lab · Use one credit system for images, music, video and short films.
</footer>

<div class="profile-overlay" id="profile-overlay">
  <div class="profile-panel">
    <div class="profile-header">
      <div class="profile-header-main">
        <div class="profile-avatar-lg" id="profile-avatar-lg">G</div>
        <div>
          <div class="profile-header-text-main" id="profile-name">Guest</div>
          <div class="profile-header-text-sub" id="profile-plan-label">
            Not signed in
          </div>
        </div>
      </div>
      <button class="close-btn" type="button" onclick="toggleProfile()">Close</button>
    </div>

    <div class="profile-body">
      <div class="profile-menu">
        <button id="menu-overview" class="active" onclick="setProfileSection('overview')">View profile</button>
        <button onclick="setProfileSection('edit')">Edit profile</button>
        <button onclick="setProfileSection('invite')">Invite friends</button>
        <button onclick="setProfileSection('subscription')">Subscription</button>
        <button onclick="setProfileSection('account')">Manage account</button>
        <button onclick="setProfileSection('theme')">Theme</button>
      </div>

      <div class="profile-content" id="profile-content">
        </div>
    </div>

    <div class="profile-footer">
      <div>Signed in state is simulated here. Real auth & billing will connect later.</div>
      <button type="button" id="sign-toggle" onclick="toggleSignIn()">Sign in</button>
    </div>
  </div>
</div>

<div class="plan-overlay" id="plan-overlay">
  <div class="plan-dialog">
    <div class="plan-dialog-header">
      <div>
        <div class="plan-dialog-title" id="plan-dialog-title">Pro plan</div>
        <div class="plan-dialog-sub" id="plan-dialog-sub">
          Full access to WAV export, HD/UHD quality and credit packs.
        </div>
      </div>
      <div class="toggle-pill">
        <button type="button" id="toggle-monthly" class="active" onclick="setPlanBilling('monthly')">
          Monthly
        </button>
        <button type="button" id="toggle-yearly" onclick="setPlanBilling('yearly')">
          Yearly
        </button>
      </div>
    </div>

    <div class="plan-dialog-body">
      <div class="price-row">
        <div class="price-main" id="plan-price-main">$20</div>
        <div class="price-note" id="plan-price-note">per month · 2500 credits</div>
      </div>
      <div class="price-row" id="price-row-yearly" style="display:none;">
        <div class="price-strike" id="plan-price-strike">$240 / year</div>
        <div class="price-save" id="plan-price-save">You save $12 (5%)</div>
      </div>
      <div class="profile-small" id="plan-dialog-extra">
        Choose monthly for flexibility, or yearly for the best price. A 7-day free trial is available for new users (no exports until trial converts).
      </div>
    </div>

    <div class="plan-dialog-footer">
      <button class="btn-primary" type="button" onclick="startSignup()">
        <span class="plus">+</span>
        Continue – signup & payment
      </button>
      <button class="btn-ghost" type="button" onclick="closePlanDetails()">
        Cancel
      </button>
    </div>
  </div>
</div>

<script>
  // USER / PLAN STATE (same logic style as homepage)
  let isSignedIn = false;
  let user = {
    name: "Guest",
    initial: "G",
    plan: "basic",
    credits: 0,
    maxCredits: 0
  };

  const planConfig = {
    basic: {
      name: "Basic",
      monthly: 0,
      yearly: 0,
      discount: 0,
      credits: "50 credits / month",
      description:
        "Free plan. UHD-quality previews with watermark, MP3-only audio and 50 monthly credits.",
      yearlyNote: "Basic is always free. Yearly billing only applies to paid plans."
    },
    pro: {
      name: "Pro",
      monthly: 20,
      yearly: 228,
      discount: 5,
      credits: "2500 credits / month",
      description:
        "For serious creators who need clean exports, WAV audio and higher resolutions.",
      yearlyNote:
        "Normal yearly cost would be $240; you pay $228 (save $12, 5%)."
    },
    creator: {
      name: "Creator",
      monthly: 30,
      yearly: 331.2,
      discount: 8,
      credits: "5000 credits / month",
      description:
        "Power users who want 4K, Studio workflows and Ultimate add-ons, with enough credits for real monthly projects.",
      yearlyNote:
        "Normal yearly cost would be $360; you pay $331.20 (save $28.80, 8%)."
    },
    creatorUltimate: {
      name: "Creator Ultimate",
      monthly: 45,
      yearly: 486,
      discount: 10,
      credits: "10000 credits / month",
      description:
        "Everything unlocked: Short Films + Studio heavy use + Stems & MIDI.",
      yearlyNote:
        "Normal yearly cost would be $540; you pay $486 (save $54, 10%)."
    }
  };

  let currentPlanKey = "pro";
  let currentBilling = "monthly";
  let currentView = "create";
  let currentVersion = "v1";

  // --- SULANDRA DIRECT ENGINE LINK ---
  
  // 1. Go to RunPod > Connect > Port 9000
  // 2. Paste URL here (No trailing slash)
  const API_BASE_URL = "https://pm37tp93i3bbci-9000.proxy.runpod.net"; 

  async function runGeneration() {
    if (user.credits < 5) {
      alert("Not enough credits!");
      return;
    }

    const promptText = document.getElementById("prompt-text").value;
    if (!promptText) return alert("Enter a prompt.");

    const btn = document.querySelector(".btn-primary");
    const originalText = btn.innerHTML;
    btn.innerHTML = "⏳ Generating (30s)...";
    btn.disabled = true;

    try {
      // Direct Call to Python Engine
      const response = await fetch(`${API_BASE_URL}/api/image/txt2img`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          prompt: promptText,
          steps: 25,
          guidance: 3.5, // 3.5 is good for Flux Quantized
          width: 1024,
          height: 1024
        })
      });

      const data = await response.json();
      
      if (data.status === "queued") {
        alert(`✅ Image Generated!\n\nFilename: ${data.prompt_id}\n\nCheck your 'My Generations' tab to see confirmation.`);
        user.credits -= 5;
        updateProfileHeader();
        
        // Add to history
        addToHistory(promptText, data.prompt_id);
        // Switch view to history
        setView('generations');
      } else {
        alert("Server Error: " + data.message);
      }

    } catch (error) {
      console.error(error);
      alert("❌ Failed to connect. Is the python script running?");
    } finally {
      btn.innerHTML = originalText;
      btn.disabled = false;
    }
  }

  function addToHistory(prompt, filename) {
    const grid = document.getElementById('history-grid');
    const div = document.createElement('div');
    div.className = 'media-card';
    div.innerHTML = `
      <div class="media-thumb" style="background:linear-gradient(135deg, #a855f7, #22c55e);"></div>
      <div>"${prompt.substring(0,20)}..."</div>
      <div class="media-meta-row">
        <span>File: ${filename}</span>
        <span>Just now</span>
      </div>
    `;
    grid.prepend(div);
  }

  function updatePlanInUI() {
    const labPlan = document.getElementById("lab-plan-pill");
    const mainPlanPill = document.getElementById("lab-main-plan-pill");
    const planName = planConfig[user.plan].name;
    labPlan.textContent = `Plan: ${planName} · ${user.credits} / ${user.maxCredits} credits`;
    mainPlanPill.textContent = `Plan: ${planName} · ${user.credits} / ${user.maxCredits} credits`;
  }

  function setView(view) {
    currentView = view;
    document.querySelectorAll(".sidebar-btn").forEach(btn => btn.classList.remove("active"));
    // Map view → sidebar button
    if (view === "create") {
      document.getElementById("btn-create").classList.add("active");
    }

    // hide all view containers
    document.getElementById("view-create").style.display = "none";
    document.getElementById("view-generations").classList.remove("active");
    document.getElementById("view-prompt").classList.remove("active");
    document.getElementById("view-media").classList.remove("active");
    document.getElementById("view-create-img2img").classList.remove("active");
    document.getElementById("view-create-outfit").classList.remove("active");
    document.getElementById("view-create-pdf").classList.remove("active");

    const title = document.getElementById("lab-main-title");
    const sub = document.getElementById("lab-main-sub");

    if (view === "create") {
      document.getElementById("view-create").style.display = "grid";
      title.textContent = "Create · Text → Image / Image → Image";
      sub.textContent =
        "Combine text and optional reference images. Each basic generation uses 5 credits per image.";
    } else if (view === "generations") {
      document.getElementById("view-generations").classList.add("active");
      title.textContent = "My generations";
      sub.textContent =
        "All the images you generated here (simulated). Later this will sync with your real account.";
    } else if (view === "prompt") {
      document.getElementById("view-prompt").classList.add("active");
      title.textContent = "AI prompt assistant";
      sub.textContent =
        "Turn your simple description into strong prompts for the Image Lab.";
    } else if (view === "media") {
      document.getElementById("view-media").classList.add("active");
      title.textContent = "Media · Community Image Feed";
      sub.textContent =
        "Preview how a social feed of Sulandra-created images could look.";
    } else if (view === "create-img2img") {
      document.getElementById("view-create-img2img").classList.add("active");
      title.textContent = "Create · Image → Image";
      sub.textContent =
        "Use strong reference images and prompts to transform your shots.";
    } else if (view === "create-outfit") {
      document.getElementById("view-create-outfit").classList.add("active");
      title.textContent = "Create · Outfit & Pose";
      sub.textContent =
        "Advanced controls for clothes and poses. Best used on Pro and above.";
      if (!isFeatureAllowed("outfitPose")) {
        alertUpgrade("Outfit & Pose tools are available on Pro and above.");
      }
    } else if (view === "create-pdf") {
      document.getElementById("view-create-pdf").classList.add("active");
      title.textContent = "Create · PDF → Storyboard / Moodboard";
      sub.textContent =
        "Upload scripts or visual PDFs to build storyboards and moodboards.";
      if (!isFeatureAllowed("pdfStoryboard")) {
        alertUpgrade("PDF storyboard tools are available on Creator and Creator Ultimate.");
      }
    }
  }

  function setVersion(version) {
    currentVersion = version;
    document.querySelectorAll(".version-chip").forEach(ch => ch.classList.remove("active"));
    const map = { v1: 0, v2: 1, v3: 2, xl: 3 };
    const chips = document.querySelectorAll(".version-chip");
    if (map[version] !== undefined) {
      chips[map[version]].classList.add("active");
    }
  }

  function handleVersionClick(version) {
    if (version === "v2" && !isFeatureAllowed("v2")) {
      alertUpgrade("v2 is available starting from Pro plan.");
      return;
    }
    if (version === "v3" && !isFeatureAllowed("v3")) {
      alertUpgrade("v3 is available starting from Creator plan.");
      return;
    }
    if (version === "xl" && !isFeatureAllowed("xl")) {
      alertUpgrade("Experimental XL is available only on Creator Ultimate.");
      return;
    }
    setVersion(version);
  }

  function isFeatureAllowed(feature) {
    // Basic rules for this Image Lab
    if (feature === "outfitPose") {
      return user.plan === "pro" || user.plan === "creator" || user.plan === "creatorUltimate";
    }
    if (feature === "pdfStoryboard") {
      return user.plan === "creator" || user.plan === "creatorUltimate";
    }
    if (feature === "v2") {
      return user.plan !== "basic";
    }
    if (feature === "v3") {
      return user.plan === "creator" || user.plan === "creatorUltimate";
    }
    if (feature === "xl") {
      return user.plan === "creatorUltimate";
    }
    // default allowed
    return true;
  }

  function alertUpgrade(message) {
    alert(
      message +
        "\n\nIn the real app this would open a dialog to help the user upgrade their plan while keeping their credits."
    );
  }

  function handleUpload(type) {
    if (type === "pdfStoryboard" && !isFeatureAllowed("pdfStoryboard")) {
      alertUpgrade("PDF storyboard uploads require Creator or Creator Ultimate.");
      return;
    }
    if ((type === "imageReference" || type === "mask") && user.plan === "basic") {
      // still allowed, just remind about watermark
      alert("Reference uploads are allowed on Basic, but exports will carry a Sulandra watermark.");
      return;
    }
    alert(
      "Upload placeholder.\n\nHere you'd open a file picker for: " +
        type +
        ". In production this would send the file to your backend."
    );
  }

  function downloadImage() {
    if (user.plan === "basic") {
      alert(
        "On Basic, downloads include a Sulandra AI Studio watermark.\n\nPaid plans export clean images without watermark."
      );
    } else {
      alert("Download placeholder. In production, this triggers a download of the selected image.");
    }
  }

  function suggestPrompt() {
    const input = document.getElementById("prompt-assistant-input").value.trim();
    const out = document.getElementById("prompt-assistant-output");
    if (!input) {
      out.textContent = "Describe your idea first, then we’ll suggest prompts.";
      return;
    }
    out.innerHTML = `
      <div class="profile-small">Here are some example prompts based on your idea:</div>
      <div class="chip" onclick="copyPrompt(this)">Cinematic, high-resolution portrait, ${input}, studio lighting, 85mm lens, detailed skin texture, soft background bokeh.</div>
      <div class="chip" onclick="copyPrompt(this)">Vertical 9:16 dance cover, ${input}, colorful club lighting, sharp focus on subject, blurred crowd behind.</div>
      <div class="chip" onclick="copyPrompt(this)">Album cover style, ${input}, bold typography space at top, gradient background, vibrant color palette.</div>
      <div class="profile-small">Click any chip to copy it into the main generator prompt.</div>
    `;
  }

  function copyPrompt(chipEl) {
    const text = chipEl.textContent;
    const promptBox = document.getElementById("prompt-text");
    promptBox.value = text;
    alert("Prompt copied into the main generator area.");
  }

  /* PROFILE PANEL */

  function toggleProfile() {
    const overlay = document.getElementById("profile-overlay");
    overlay.classList.toggle("show");
    if (overlay.classList.contains("show")) {
      renderProfileSection("overview");
    }
  }

  function setProfileSection(section) {
    document
      .querySelectorAll(".profile-menu button")
      .forEach(btn => btn.classList.remove("active"));

    if (section === "overview") document.getElementById("menu-overview").classList.add("active");
    else document
      .querySelector(`.profile-menu button[onclick*="${section}"]`)
      .classList.add("active");

    renderProfileSection(section);
  }

  function renderProfileSection(section) {
    const content = document.getElementById("profile-content");

    if (section === "overview") {
      content.innerHTML = `
        <div class="profile-section-title">Profile overview</div>
        <div class="profile-section-sub">
          Signed in state is simulated. Later this will sync with your real Sulandra account.
        </div>
        <div class="profile-line"><strong>Name:</strong> ${user.name}</div>
        <div class="profile-line"><strong>Current plan:</strong> ${planConfig[user.plan].name}</div>
        <div class="profile-line"><strong>Credits:</strong> ${user.credits} / ${user.maxCredits}</div>
        <div class="profile-small">
          In production this panel will also show your invoices, usage and security settings.
        </div>
      `;
    } else if (section === "edit") {
      content.innerHTML = `
        <div class="profile-section-title">Edit profile</div>
        <div class="profile-section-sub">Change your display name (local demo only).</div>
        <label for="edit-name">Display name</label>
        <input id="edit-name" type="text" value="${user.name}" />
        <button class="btn-primary" style="margin-top:8px;" type="button" onclick="saveProfileName()">
          <span class="plus">+</span> Save name
        </button>
        <div class="profile-small">In production this would update your account in your backend.</div>
      `;
    } else if (section === "invite") {
      content.innerHTML = `
        <div class="profile-section-title">Invite friends</div>
        <div class="profile-section-sub">
          Later this will generate real invite links that can reward you with credits.
        </div>
        <div class="profile-small">Sample invite link (mock):</div>
        <div class="chip">https://sulandra.ai/invite/YOURCODE</div>
      `;
    } else if (section === "subscription") {
      const planName = planConfig[user.plan].name;
      content.innerHTML = `
        <div class="profile-section-title">Subscription & credits</div>
        <div class="profile-section-sub">
          Choose or change your plan. This is only simulated here, but the UX matches what you’ll build later.
        </div>
        <div class="profile-line"><strong>Current plan:</strong> ${planName}</div>
        <div class="profile-line"><strong>Credits:</strong> ${user.credits} / ${user.maxCredits}</div>
        <div class="profile-small">Click a chip to simulate switching plans:</div>
        <div style="margin-bottom:6px;">
          <span class="chip" onclick="simulatePlan('basic')">Basic</span>
          <span class="chip" onclick="simulatePlan('pro')">Pro</span>
          <span class="chip" onclick="simulatePlan('creator')">Creator</span>
          <span class="chip" onclick="simulatePlan('creatorUltimate')">Creator Ultimate</span>
        </div>
        <div class="profile-small">
          In production, plan changes here will open payment and keep your remaining credits when upgrading.
        </div>
      `;
    } else if (section === "account") {
      content.innerHTML = `
        <div class="profile-section-title">Manage account</div>
        <div class="profile-section-sub">
          This is where billing history, invoices and payment methods will live.
        </div>
        <ul class="plan-list">
          <li>• View invoices and payment history</li>
          <li>• Update payment methods (PayPal, cards, Apple Pay)</li>
          <li>• Turn auto-renew on or off</li>
          <li>• Download receipts for taxes</li>
        </ul>
      `;
    } else if (section === "theme") {
      content.innerHTML = `
        <div class="profile-section-title">Theme</div>
        <div class="profile-section-sub">
          Theme switching is not wired yet, but here is where light / dark / high-contrast options will live.
        </div>
        <div class="chip disabled">Dark (current)</div>
        <div class="chip disabled">Light</div>
        <div class="chip disabled">High contrast</div>
      `;
    }

    updateProfileHeader();
  }

  function updateProfileHeader() {
    document.getElementById("profile-avatar").textContent = user.initial;
    document.getElementById("profile-avatar-lg").textContent = user.initial;
    document.getElementById("profile-name").textContent = user.name;
    document.getElementById("profile-label").textContent = isSignedIn ? "Profile" : "Sign in";
    document.getElementById("profile-credits").textContent =
      `${user.credits} / ${user.maxCredits} credits`;
    const planLabel = isSignedIn
      ? `Plan: ${planConfig[user.plan].name}`
      : "Not signed in";
    document.getElementById("profile-plan-label").textContent = planLabel;
    document.getElementById("sign-toggle").textContent =
      isSignedIn ? "Sign out" : "Sign in";
    updatePlanInUI();
  }

  function saveProfileName() {
    const input = document.getElementById("edit-name");
    const name = input.value.trim() || "Guest";
    user.name = name;
    user.initial = name.charAt(0).toUpperCase();
    renderProfileSection("overview");
    alert("Name updated in local state. In production this would save to your account.");
  }

  function toggleSignIn() {
    isSignedIn = !isSignedIn;
    if (isSignedIn && user.maxCredits === 0) {
      // default plan for demo
      simulatePlan("pro", true);
    } else {
      updateProfileHeader();
      renderProfileSection("overview");
    }
  }

  function simulatePlan(key, silent) {
    user.plan = key;
    if (key === "basic") {
      user.maxCredits = 50;
    } else if (key === "pro") {
      user.maxCredits = 2500;
    } else if (key === "creator") {
      user.maxCredits = 5000;
    } else if (key === "creatorUltimate") {
      user.maxCredits = 10000;
    }
    user.credits = user.maxCredits;
    updateProfileHeader();
    if (!silent) {
      alert("Plan switched in local demo to: " + planConfig[key].name);
    }
  }

  /* PLAN MODAL */

  function openPlanDetails(key) {
    currentPlanKey = key;
    currentBilling = "monthly";
    updatePlanDialog();
    document.getElementById("plan-overlay").classList.add("show");
  }

  function closePlanDetails() {
    document.getElementById("plan-overlay").classList.remove("show");
  }

  function setPlanBilling(mode) {
    currentBilling = mode;
    updatePlanDialog();
  }

  function updatePlanDialog() {
    const config = planConfig[currentPlanKey];

    document.getElementById("plan-dialog-title").textContent =
      config.name + " plan";
    document.getElementById("plan-dialog-sub").textContent =
      config.description;

    const monthlyBtn = document.getElementById("toggle-monthly");
    const yearlyBtn = document.getElementById("toggle-yearly");
    monthlyBtn.classList.toggle("active", currentBilling === "monthly");
    yearlyBtn.classList.toggle("active", currentBilling === "yearly");

    const priceMain = document.getElementById("plan-price-main");
    const priceNote = document.getElementById("plan-price-note");
    const rowYearly = document.getElementById("price-row-yearly");
    const strike = document.getElementById("plan-price-strike");
    const save = document.getElementById("plan-price-save");
    const extra = document.getElementById("plan-dialog-extra");

    if (currentBilling === "monthly") {
      priceMain.textContent =
        config.monthly === 0 ? "$0" : "$" + config.monthly;
      priceNote.textContent = "per month · " + config.credits;
      rowYearly.style.display = "none";
      if (config.monthly === 0) {
        extra.textContent =
          "Basic stays free with 50 credits and watermark. Upgrade anytime to unlock clean exports.";
      } else {
        extra.textContent =
          "Pay monthly for flexibility, or switch to yearly later to save more.";
      }
    } else {
      if (config.monthly === 0) {
        priceMain.textContent = "$0";
        priceNote.textContent =
          "Always free · 50 credits / month · watermark";
        rowYearly.style.display = "none";
        extra.textContent =
          "Basic is always free. Yearly discounts apply only to paid plans.";
      } else {
        priceMain.textContent = "$" + config.yearly.toFixed(2);
        priceNote.textContent = "per year · " + config.credits;
        const normalYearPrice = config.monthly * 12;
        strike.textContent = "$" + normalYearPrice.toFixed(2) + " / year";
        const savings = normalYearPrice - config.yearly;
        save.textContent =
          "You save $" +
          savings.toFixed(2) +
          " (" +
          config.discount +
          "%)";
        rowYearly.style.display = "flex";
        extra.textContent =
          config.yearlyNote +
          " Billing renews yearly; you can downgrade or upgrade at any time.";
      }
    }
  }

  function startSignup() {
    alert(
      "Signup flow placeholder.\n\nIn the real app, this button would open your authentication + payment flow for the selected plan and billing period."
    );
    simulatePlan(currentPlanKey, true);
    isSignedIn = true;
    updateProfileHeader();
    toggleProfile();
    closePlanDetails();
  }

  // INITIALIZE
  simulatePlan("basic", true);
  updateProfileHeader();
  setView("create");
</script>
</body>
</html>
